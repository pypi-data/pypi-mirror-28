Metadata-Version: 2.0
Name: docker-bash-volume-watcher
Version: 1.0.7
Summary: A tool to notify Docker contianers about changes in mounts on Bash for Windows.
Home-page: https://github.com/Kaptard/docker-bash-volume-watcher
Author: Kilian Volb, Mikhail Erofeev
Author-email: kilian@nexus-stats.com
License: MIT
Keywords: Docker volume Windows watch inotify
Platform: UNKNOWN
Classifier: Intended Audience :: Developers
Classifier: Operating System :: Microsoft :: Windows
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 2.7
Classifier: Programming Language :: Python :: 3
Classifier: Topic :: Software Development
Classifier: Topic :: System :: Monitoring
Requires-Dist: docker (==2.7.0)
Requires-Dist: watchdog (>=0.8.3)

Docker Bash Volume Watcher
==============================
This fork takes merofeev's `docker-windows-volume-watcher<https://github.com/merofeev/docker-windows-volume-watcher>`_ and makes it work with Bash for Windows (aka Ubuntu on Windows)
The script monitors directory bindings of Docker containers on Windows hosts and notifies containers about file changes.

The script aims to be workaround for the problem of file change events propagation on Windows hosts. Due to limitations of CIFS implementation in Linux kernel, file change events in mounted folders of host are not propagated to container by Docker for Windows. This problem renders watch mode of modern frameworks (e.g. Jekyll, ng-cli, etc.) development servers useless, since containers are not notified about file changes. This problem is described on `Docker Community Forums <https://forums.docker.com/t/file-system-watch-does-not-work-with-mounted-volumes/12038>`_.

Installation
------------
This script can be installed with pip (both Python 2 & 3 are supported).

.. code:: bat

    pip install docker-bash-volume-watcher


Usage
-----
Monitor all directory bindings of all containers. The script will listen for container start/stop events and notify all running containers about file changes.

.. code:: bat

    docker-volume-watcher


Monitor only bindings of container ``container_name``.

.. code:: bat

    docker-volume-watcher container_name


Monitor only binding of ``container_name`` in sub directory ``/not_node_modules``.


.. code:: bat

    docker-volume-watcher container_name /not_node_modules


You can also specify wildcards with ``*`` and ``?`` characters. For example: monitor only bindings of containers with names containing `myproject`.

.. code:: bat

    docker-volume-watcher *myproject*


Use flag ``-v`` to enable verbose output: the script will report start/stop events of eligible containers and print all detected file changes.

Limitations
------------
* The script doesn't propagate to container file deletion events.
* The script requires ``stat`` and ``chmod`` utils to be installed in container (this should be true by default for the most of containers).

Implementation details
-----------------------
The script uses ``watchdog`` package to observe file change events of the host directory. Once file change event is fired the script reads file permissions of changed file (using `stat` util) and rewrites file permissions with the same value (using ``chmod`` util) thus triggering inotify event inside container.

"Rewrite file permissions approach" was used instead of updating file last modified time with ``touch`` util. Since touching will cause event loop: touch will trigger file change event in Windows, script will handle this event and touch file again, etc.


