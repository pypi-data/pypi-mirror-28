#!/usr/bin/env python

import os
import sys

from optparse import OptionParser

from autovalidate import autovalidate
from autovalidate.reporters import get_reporter

opt_parser = OptionParser()
opt_parser.add_option('-r', '--reporter', dest='reporter',
                      help='reporter (dot)', default='dot')
opts, args = opt_parser.parse_args()

reporter = get_reporter(name=opts.reporter, out=sys.stdout)

for result in autovalidate(os.getcwd()):
    reporter.record(result)

reporter.summarize()

sys.exit(reporter.exit_code)
