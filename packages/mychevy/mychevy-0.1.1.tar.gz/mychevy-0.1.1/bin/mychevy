#!/usr/bin/env python

import argparse
import configparser
import os
import sys

from mychevy.mychevy import MyChevy

def parse_args():
    parser = argparse.ArgumentParser('mychevy')
    parser.add_argument('-c', '--config',
                        required=True,
                        help="Config file with credentials")
    parser.add_argument('-S', '--show-browser',
                        dest='showbrowser',
                        action='store_true',
                        default=False,
                        help='Show browser window when running')
    return parser.parse_args()


def main():
    args = parse_args()
    config = configparser.ConfigParser()
    config.read(args.config)

    page = MyChevy(config["default"]["user"], config["default"]["passwd"],
                   headless=(not args.showbrowser))
    print("Loading data, this takes up to 2 minutes...")
    data = page.data()
    print(data)

if __name__ == "__main__":
    sys.exit(main())
