define("mockup-patterns-contentloader",["jquery","pat-base","pat-logger","pat-registry","mockup-utils","underscore"],function(a,b,c,d,e,f){"use strict";var g=c.getLogger("pat-contentloader"),h=b.extend({name:"contentloader",trigger:".pat-contentloader",parser:"mockup",defaults:{url:null,content:null,trigger:"click",target:null,template:null,dataType:"html"},init:function(){var a=this;"el"===a.options.url&&"A"===a.$el[0].tagName&&(a.options.url=a.$el.attr("href")),"immediate"===a.options.trigger?a._load():a.$el.on(a.options.trigger,function(b){b.preventDefault(),a._load()})},_load:function(){var a=this;a.$el.addClass("loading-content"),a.options.url?a.loadRemote():a.loadLocal()},loadRemote:function(){var b=this;a.ajax({url:b.options.url,dataType:b.options.dataType,success:function(c){var d;if("html"===b.options.dataType)c.indexOf("<html")!==-1&&(c=e.parseBodyTag(c)),d=a("<div>"+c+"</div>");else if(b.options.dataType.indexOf("json")!==-1){c.constructor===Array&&1===c.length&&(c=c[0]);try{d=a(f.template(b.options.template)(c))}catch(h){return void g.warn("error rendering template. pat-contentloader will not work")}}null!==b.options.content&&(d=d.find(b.options.content)),b.loadLocal(d),b.$el.removeClass("loading-content")},error:function(){b.$el.addClass("content-load-error")}})},loadLocal:function(b){var c=this;if(!b&&null===c.options.content)return void g.warn("No selector configured");var e=c.$el;return null!==c.options.target&&(e=a(c.options.target),0===e.size())?void g.warn("No target nodes found"):(b||(b=a(c.options.content).clone()),b.show(),e.replaceWith(b),d.scan(b),void c.$el.removeClass("loading-content"))}});return h}),define("collectionfilter",["jquery","pat-base","mockup-patterns-contentloader"],function(a,b,c){var d=b.extend({name:"collectionfilter",trigger:".pat-collectionfilter",parser:"mockup",contentloader:c,defaults:{collectionUUID:"",collectionURL:"",reloadURL:""},init:function(){if(this.$el.unbind("collectionfilter:reload"),this.$el.on("collectionfilter:reload",function(a,b){b.noReloadSearch&&this.$el.hasClass("portletCollectionSearch")||b.collectionUUID===this.options.collectionUUID&&this.reload(b.targetFilterURL)}.bind(this)),this.$el.hasClass("portletCollectionSearch")){a('button[type="submit"]',this.$el).hide(),a("form",this.$el).on("submit",function(a){a.preventDefault()});var b;a('input[name="SearchableText"]',this.$el).on("keyup",function(c){clearTimeout(b),b=setTimeout(function(){var b=a(c.target).data("url"),d=encodeURIComponent(a(c.target).val());b+="&"+a(c.target).attr("name")+"="+d,a(this.trigger).trigger("collectionfilter:reload",{collectionUUID:this.options.collectionUUID,targetFilterURL:b,noReloadSearch:!0}),this.reloadCollection(b)}.bind(this),500)}.bind(this))}a("a.filteritem",this.$el).on("click",function(b){b.stopPropagation(),b.preventDefault();var c=a(b.target).closest("a").attr("href");a(this.trigger).trigger("collectionfilter:reload",{collectionUUID:this.options.collectionUUID,targetFilterURL:c}),this.reloadCollection(c)}.bind(this)),a("input.filteritem",this.$el).on("change",function(b){var c=a(b.target).data("url");a(this.trigger).trigger("collectionfilter:reload",{collectionUUID:this.options.collectionUUID,targetFilterURL:c}),this.reloadCollection(c)}.bind(this)),a("select.filteritem",this.$el).on("change",function(b){var c=a("option:selected",b.target),d=a(c).data("url");a(this.trigger).trigger("collectionfilter:reload",{collectionUUID:this.options.collectionUUID,targetFilterURL:d}),this.reloadCollection(d)}.bind(this))},reload:function(a){var b=this.options.reloadURL,c=b.split("?"),d=c[1]||[],e=a.split("?")[1]||[],f=[].concat(d,e).join("&");b=[].concat(c[0],f).join("?");new this.contentloader(this.$el,{url:b,target:this.$el,content:"aside",trigger:"immediate"})},reloadCollection:function(a){new this.contentloader(this.$el,{url:a+"&ajax_load=1",target:"#content-core",content:"#content-core",trigger:"immediate"});window.history.replaceState({path:a},"",a)}});return d}),require(["jquery","pat-registry","collectionfilter"],function(a,b){"use strict";window.parent===window&&a(document).ready(function(){b.initialized||b.init()})}),define("/home/_thet/data/dev/agitator/collectionfilter/plone/src/collective.collectionfilter/src/collective/collectionfilter/resources/collectionfilter-bundle.js",function(){});
//# sourceMappingURL=collectionfilter-compiled.js.map