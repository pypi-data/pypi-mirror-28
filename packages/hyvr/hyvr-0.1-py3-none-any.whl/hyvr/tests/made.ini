## Example HyVR model parameter input file
# HyVR 0.1 simulation package
# https://github.com/driftingtides/hyvr/
# Jeremy P. Bennett, University of Tuebingen, 2017-2018 

# Notes:
#	- String values do not require quotation marks
# 	- All section and variable names should be lower case

# Suffixes
# r_: 		range of float values
# l_: 		list of string values
# ll_:		list of tuples
# flag_: 	flag value (boolean)

[run]
# ------------------
# Run parameters
# ------------------

# Name of model simulation run
runname = small

# Number of realisations
numsim = 1

## Outputs
# Required outputs 
# vtk: *.vtk
# py: python pickle
# mat *.mat
l_dataoutputs = [vtk,mat,py]
#l_modeloutputs = [mf,hgs,mf6]

# Full Filepath/directory for outputs
# Default is the directory of the parameter initialization file
# if modeldir == 'select'
#modeldir = select

# Overwrite parameter files
flag_ow = true

# Will anisotropy be assigned?
flag_anisotropy = true
flag_het = true


[model]
# ------------------
# Model parameters
# ------------------

# Grid cell dimensions [m]
dx = 0.5
dy = 0.5
dz = 0.1

# Model dimensions [m]
#lx = 200
lx = 40
#ly = 70
ly = 20
lz = 11

# Is domain periodic?
flag_periodic = false
flag_display =  false

# Lowest hierarchical level of heterogeneity to assign
#	-ae
#	-facies
# 	-internal
hetlev = internal

[strata]
# ------------------
# Strata parameters
# ------------------

## List of sequences
l_ssm = [clay, transition, glaflu, meander]

## List of sequence top contact depths
r_ssm_top = [1.5, 3, 8, 11]

#  [variance, correlation length x, corr. length. y]
ll_ssm_contact_model = [[0.05,6,6],[0.05,6,6],[0.05,6,6],[0.05,6,6]]

## Architectural element lookup table
#ae_table = ae_lu_19-09-2017_10.39.18.txt

## Contact surfaces
# flat:		horizontal contacts <default>
# random: random surfaces
# 				- requires geostatistical model "l_contact_model" 
# user: 	Use-defined contact surfaces
# 				- requires input path "contact_file"
ssm_contact = random

# List of architectural elements in model
l_ae = [clay_sheet, sand_sheet, clay_lens, crossbedded_scour, sandy_gravel, mc_sheet, meander_channel]

# Which architectural elements are included in each sequence
# - Must have same length as l_seq, 
# - Architectural elements must be identical to section names (except [model],[hydraulics])
ll_ssm_ae = [[clay_sheet],[sand_sheet,clay_lens],[crossbedded_scour, sandy_gravel],[mc_sheet, meander_channel]]

# The probability of an architecutral element occuring 
ll_ae_prob = [[1.0],[0.4,0.6],[0.8,0.2],[0.3, 0.7]]

# Mean thickness of architectural element
ll_ae_z_mean = [[3.0],[0.3,0.3],[1.7, 0.2],[1.0, 2.0]]

## Erosion / deposition rules
# Avulsion probability
ll_avul_prob = [[0],[0],[0.7],[0]]

# Avulsion depth range [m]
ll_avul = [[0.0,0.0],[0.0,0.0],[0.2, 0.4],[0.0,0.0]]

# Background parameters for unassigned cells
# [fac, azim, dip]
r_bg = [5, 4, 0, 6] 


[crossbedded_scour]
# ------------------
# Scour pool element
# ------------------
geometry = trunc_ellip

# Internal structure 
structure = random
agg = 0.2

# Contact type
contact = random
#  [variance, correlation length x, corr. length. y]
r_contact_model = [0.01,6,6]

# Number of elements per simulation elevation
el_z = 3e-3

# Migration of troughs [mean & var migration in x, y]
r_migrate = [10, 0.5, 10, 0.5]

# Do not generate troughs close to bottom contact
# Value is proportion of trough depth
buffer = 0.8

# Mean trough geometry [m]
length = 22
width = 10.4
depth = 1.2

# Mean angles [deg]
r_paleoflow = [-45, 45]
r_dip = [10, 25]
r_azimuth = [-45, 45]

# Hydrofacies (refer to [hydraulics]l_hydro; 0-indexed)
l_facies = [1,2,3]

# Alternating facies
# List of what hydrofacies can follow those listed in l_facies
# To generate cyclical facies each list entry should have only one facies value
ll_altfacies = [[1,2],[1,2],[3]]

# Thickness of lenses (or) spatial period (lambda) of inclined set [m]
bulbset_d = 0.1
dipset_d = 0.7

# Background parameters for unassigned cells
# [fac, azim, dip]
r_bg = [0, 0, 0] 

# Geometry trend with elevation
# Trends are linear, moving from bottom to top of domain
# Percentage change of mean value with dx = 1m
r_geo_ztrend = [2, 0.5]

[meander_channel]
# ------------------
# Meander channel element
# ------------------
geometry = ext_par
agg = 1
width = 10
depth = 1.5

# Internal structure 
structure = massive

# Contact type
contact = random
#  [variance, correlation length x, corr. length. y]
r_contact_model = [0.001,12,6]

# Migration of channels [mean & var migration in x, y]
r_migrate = [10, 0.5, 10, 0.5]

# Channel shape parameters
h = 0.4
# Wavenumber
k = 0.3	
# Channel distance for calculations		
ds = 1
eps_factor = 0.1

# Channels per iteration
channel_no = 1

# Dip range ([0,0] = massive bedding without any dip)
r_dip = [0, 0]

# Do not generate troughs close to bottom contact
# Value is proportion of trough depth
buffer = 0.4

# Hydrofacies (refer to [hydraulics]l_hydro; 0-indexed)
l_facies = [5]

# Lag surface at bottom of feature
# [lag depth, hydrofacies]
l_lag = [0.3, 0]

# Background parameters for unassigned cells
# [fac, azim, dip]
r_bg = [6, 0, 0] 

[sandy_gravel]
# ------------------
# Sandy gravel sheet element
# ------------------
# Geometry
geometry = sheet
lens_thickness = -1
structure = massive

# Contact type
contact = random
#  [variance, correlation length x, corr. length. y]
r_contact_model = [0.05,6,6]

# Hydrofacies (refer to [hydraulics]l_hydro)
l_facies = [0]

[sand_sheet]
# ------------------
# Sand sheet element
# ------------------
# Geometry
geometry = sheet
lens_thickness = 0.3
structure = massive

# Contact type
contact = flat

#  [variance, correlation length x, corr. length. y]
r_contact_model = [0.01,6,6]

# Dip range ([0,0] = massive bedding without any dip)
r_dip = [0, 0]

# Spatial period (lambda) of inclined set [m]
setlamb = 0.3

# Hydrofacies (refer to [hydraulics]l_hydro)
l_facies = [4]

# Global hydraulics trend with elevation
# Trends are linear, moving from bottom to top of domain
r_k_ztrend = [0.5, 5]

[clay_sheet]
# ------------------
# Clay sheet element
# ------------------
# Geometry
geometry = sheet
lens_thickness = 0.2
structure = massive

# Contact type
contact = flat
#  [variance, correlation length x, corr. length. y]
r_contact_model = [0.01,6,6]

# Dip range ([0,0] = massive bedding without any dip)
r_dip = [0, 0]

# Spatial period (lambda) of inclined set [m]
setlamb = 3

# Hydrofacies (refer to [hydraulics]l_hydro)
l_facies = [5]

# Global hydraulics trend with elevation
# Trends are linear, moving from bottom to top of domain
r_k_ztrend = [0.5, 2]

[mc_sheet]
# ------------------
# silt/clay sheet element
# ------------------
# Geometry
geometry = sheet
lens_thickness = 0.1
structure = massive

# Contact type
contact = flat
r_contact_model = [0.01,6,6]

# Spatial period (lambda) of inclined set [m]
setlamb = 3

# Dip range ([0,0] = massive bedding without any dip)
r_dip = [0, 0]

# Hydrofacies (refer to [hydraulics]l_hydro)
l_facies = [6]

[clay_lens]
# ------------------
# Clay/silt lens
# ------------------
geometry = trunc_ellip

# Internal structure 
structure = flat
agg = 0.2

# Contact type
contact = flat
#  [variance, correlation length x, corr. length. y]
r_contact_model = [0.01,6,6]

# Number of elements per simulation elevation
el_z = 1e-3

# Migration of troughs [mean & var migration in x, y]
#r_migrate = [20, 1, 10, 1]

# Do not generate troughs close to bottom contact
# Value is proportion of trough depth
# buffer = 0.2

# Mean trough geometry [m]
length = 10
width = 8
depth = 0.3

# Mean angles [degrees]
r_paleoflow = [-90, 90]
r_dip = [0, 0]
r_azimuth = [0, 0]

# Hydrofacies (refer to [hydraulics]l_hydro; 0-indexed)
l_facies = [6]

# Alternating facies
# List of what hydrofacies can follow those listed in l_facies
# To generate cyclical facies each list entry should have only one facies value
ll_altfacies = [[6],[6]]

# Thickness of lenses (or) spatial period (lambda) of inclined set [m]
setlamb = 0.2

# Background parameters for unassigned cells
# [mat, fac, azim, dip]
r_bg = [4, 0, 0] 

# Geometry trend with elevation
# Trends are linear, moving from bottom to top of domain
# Percentage change of mean value with dx = 1m
r_geo_ztrend = [1, 1]

[hydraulics]
# ------------------
# Hydraulic parameters
# ------------------
# Simulation of hydraulic parameters?
flag_gen = true

# List of hydrofacies codes
l_hydro = [sG, scG, oG, S, fS, C, mS]

# mean horizontal hydraulic conductivity [m/s]
r_k_h = [1e-5, 1e-7, 1e-1, 1e-4, 1e-5, 2e-9, 3e-9]

# variance of log hydraulic conductivity [-]
r_sig_y = [1, 1, 1, 1, 1, 1, 1]

# default correlation lengths for log(K) in each hydrofacies in x,y,z-directions
ll_ycorlengths = [[13,13,1.6],[13,13,1.6],[13,13,1.6], [13,13,1.6],[13,13,1.6],[13,13,1.6],[13,13,1.6]]

# List of perpendicular anisotropy ratios (i.e K_h/K_v) [-]
r_k_ratio =  [1, 0.25, 0.025, 1, 2.3, 2.3, 2.3, 1.7]

# list of mean porosity values [-]
r_n = [0.2, 0.17, 0.35, 0.43, 0.43, 0.52, 0.45]

# variance of porosity values [-]
r_sig_n = [0.0005, 0.0005, 0.0005, 0.0005, 0.0005, 0.0005,0.0005]

# default correlation lengths for n in each hydrofacies in x,y,z-directions
ll_ncorlengths = [[3,3,0.3],[3,3,0.3],[3,3,0.3],[3,3,0.3],[3,3,0.3],[3,3,0.3],[3,3,0.3]]

# Global hydraulics trend with elevation
# Trends are linear, moving from bottom to top of domain
#r_k_ztrend = [1.5, 0.9]
#r_k_xtrend = [1.5, 0.9]


[flowtrans]
# ------------------
# Flow and transport modelling parameters
# ------------------

# Boundary conditions (head in/out [m])
hin = [1, 0, 0]
hout = [0, 0, 0]


