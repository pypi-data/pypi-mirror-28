
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>5. Small angle scattering (sas) &#8212; jscatter 0.6.7 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.6.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. formfactor (ff)" href="formfactor.html" />
    <link rel="prev" title="4. formel" href="formel.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="formfactor.html" title="6. formfactor (ff)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="formel.html" title="4. formel"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">jscatter 0.6.7 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="small-angle-scattering-sas">
<h1>5. Small angle scattering (sas)<a class="headerlink" href="#small-angle-scattering-sas" title="Permalink to this headline">¶</a></h1>
<p>This module allows smearing/desmearing of SAXS/SANS data.</p>
<p>Smearing is for line collimation as in Kratky SAXS cameras and for point collimation for SANS.
For SANS the resolution smearing a la Pedersen is realised (resFunct).</p>
<p>For desmearing the Lake algorithm is an iterative procedure to desmear smeared data.
We follow here the improvements according to Vad using a convergence criterion and smoothing.</p>
<p>As references the waterXray scattering and a AgBe reference spectrum are available.</p>
<p>For form factors and structure factors see the respective modules.</p>
<div class="section" id="smear-desmear">
<h2>5.1. Smear/desmear<a class="headerlink" href="#smear-desmear" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.sas.smear" title="jscatter.sas.smear"><code class="xref py py-obj docutils literal"><span class="pre">smear</span></code></a>(data,&nbsp;beamProfile,&nbsp;**kwargs)</td>
<td>Smearing data for line-collimated SAXS (Kratky camera) or as point collimation SANS/SAXS.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.sas.desmear" title="jscatter.sas.desmear"><code class="xref py py-obj docutils literal"><span class="pre">desmear</span></code></a>(Ios,&nbsp;beamProfile[,&nbsp;maxIterations,&nbsp;…])</td>
<td>Desmearing according to Lake algorithm with a convergence criterion to stop recursion at best desmearing.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.sas.resFunct" title="jscatter.sas.resFunct"><code class="xref py py-obj docutils literal"><span class="pre">resFunct</span></code></a>(S[,&nbsp;collDist,&nbsp;collAperture,&nbsp;…])</td>
<td>Resolution smearing of small angle scattering for SANS or SAXS according to Pedersen for radial averaged data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.sas.prepareBeamProfile" title="jscatter.sas.prepareBeamProfile"><code class="xref py py-obj docutils literal"><span class="pre">prepareBeamProfile</span></code></a>([data])</td>
<td>Prepare beam profile parameter from Beam Profile measurement or according to given parameters.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.sas.getBeamWidth" title="jscatter.sas.getBeamWidth"><code class="xref py py-obj docutils literal"><span class="pre">getBeamWidth</span></code></a>(empty[,&nbsp;minmax,&nbsp;showfit])</td>
<td>Fit Gaussian to beam width of measurement.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.sas.plotBeamProfile" title="jscatter.sas.plotBeamProfile"><code class="xref py py-obj docutils literal"><span class="pre">plotBeamProfile</span></code></a>(beam[,&nbsp;p])</td>
<td>Plots beam profile and weight function according to parameters in beam.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.sas.waterXrayScattering" title="jscatter.sas.waterXrayScattering"><code class="xref py py-obj docutils literal"><span class="pre">waterXrayScattering</span></code></a>([composition,&nbsp;T,&nbsp;units])</td>
<td>Absolute scattering of water with components (salt, buffer) at Q=0 as reference for X-ray.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.sas.AgBeReference" title="jscatter.sas.AgBeReference"><code class="xref py py-obj docutils literal"><span class="pre">AgBeReference</span></code></a>(q,&nbsp;wavelength[,&nbsp;n,&nbsp;ampn,&nbsp;…])</td>
<td>The scattering intensity expected from AgBe as a reference for wavelength calibration.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="housekeeping">
<h2>5.2. Housekeeping<a class="headerlink" href="#housekeeping" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.sas.readpdh" title="jscatter.sas.readpdh"><code class="xref py py-obj docutils literal"><span class="pre">readpdh</span></code></a>(pdhFileName)</td>
<td>Opens and reads a SAXS data file in the .pdh (Primary Data Handling) format.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.sas.autoscaleYinoverlapX" title="jscatter.sas.autoscaleYinoverlapX"><code class="xref py py-obj docutils literal"><span class="pre">autoscaleYinoverlapX</span></code></a>(dataa[,&nbsp;key,&nbsp;keep])</td>
<td>Scales elements of data to have same mean .Y value in the overlap region of .X .</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.sas.removespikesminmaxmethod" title="jscatter.sas.removespikesminmaxmethod"><code class="xref py py-obj docutils literal"><span class="pre">removespikesminmaxmethod</span></code></a>(dataa[,&nbsp;order,&nbsp;…])</td>
<td>Takes a dataset and removes single spikes from data by substitution with spline.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.sas.removespikes" title="jscatter.sas.removespikes"><code class="xref py py-obj docutils literal"><span class="pre">removespikes</span></code></a>(dataa[,&nbsp;xmin,&nbsp;xmax,&nbsp;medwindow,&nbsp;…])</td>
<td>Takes a dataset and removes single spikes.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.sas.locatefiles" title="jscatter.sas.locatefiles"><code class="xref py py-obj docutils literal"><span class="pre">locatefiles</span></code></a>(pattern[,&nbsp;root])</td>
<td>Locate all files matching supplied filename pattern in and below supplied root directory.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.sas.copyfiles" title="jscatter.sas.copyfiles"><code class="xref py py-obj docutils literal"><span class="pre">copyfiles</span></code></a>(pattern[,&nbsp;root,&nbsp;destination,&nbsp;link])</td>
<td>Copies all files matching pattern in tree below root to destination directory</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.sas.addXMLParameter" title="jscatter.sas.addXMLParameter"><code class="xref py py-obj docutils literal"><span class="pre">addXMLParameter</span></code></a>(dataa)</td>
<td>Adds the parameters stored in xml part of a .pdh file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.sas.moveSAXSPACE" title="jscatter.sas.moveSAXSPACE"><code class="xref py py-obj docutils literal"><span class="pre">moveSAXSPACE</span></code></a>(pattern[,&nbsp;root,&nbsp;destination,&nbsp;…])</td>
<td>Read SAXSPACE .pdh files and removes spikes by removespikes.</td>
</tr>
</tbody>
</table>
<hr class="docutils" />
<span class="target" id="module-jscatter.sas"></span><p>This module allows smearing/desmearing of SAXS/SANS data.</p>
<p>Smearing is for line collimation as in Kratky SAXS cameras and for point collimation for SANS.
For SANS the resolution smearing a la Pedersen is realised (resFunct).</p>
<p>For desmearing the Lake algorithm is an iterative procedure to desmear smeared data.
We follow here the improvements according to Vad using a convergence criterion and smoothing.</p>
<p>As references the waterXray scattering and a AgBe reference spectrum are available.</p>
<p>For form factors and structure factors see the respective modules.</p>
<dl class="function">
<dt id="jscatter.sas.AgBeReference">
<code class="descclassname">jscatter.sas.</code><code class="descname">AgBeReference</code><span class="sig-paren">(</span><em>q, wavelength, n=array([1, 2, 3, 4, 5, 6, 7, 8, 9]), ampn=[1, 1, 1, 1, 1, 1, 1, 1, 1, 1], domainsize=100, udw=0.1, asym=0, lg=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#AgBeReference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.AgBeReference" title="Permalink to this definition">¶</a></dt>
<dd><p>The scattering intensity expected from AgBe as a reference for wavelength calibration.</p>
<p>The intensities assume a d-spacing of 5.8378 nm and a reduction of the intensity as q**-2.
The domain size determines the width according to Scherrer equation <a class="reference internal" href="#r188" id="id1">[R188]</a>. The first peak is at 1.076 1/nm.
The result needs to be convoluted with the instrument resolution by resFunct or smear.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>q</strong> : array</p>
<blockquote>
<div><p>wavevector</p>
</div></blockquote>
<p><strong>wavelength</strong> : float</p>
<blockquote>
<div><p>wavelength</p>
</div></blockquote>
<p><strong>n</strong> : array of int</p>
<blockquote>
<div><p>order of the peaks</p>
</div></blockquote>
<p><strong>ampn</strong> : list of float</p>
<blockquote>
<div><p>amplitudes of the peaks</p>
</div></blockquote>
<p><strong>domainsize</strong> : float</p>
<blockquote>
<div><p>Domainsize of AgBe crystals in nm.
default 100 nm as is given in <a class="reference internal" href="#r187" id="id2">[R187]</a>.</p>
</div></blockquote>
<p><strong>udw</strong> : float</p>
<blockquote>
<div><p>displacement u in Debye Waller factor exp(-u**2*q**2/3)</p>
</div></blockquote>
<p><strong>asym</strong> : float</p>
<blockquote>
<div><p>factor asymmetry in Voigt function describing the peaks</p>
</div></blockquote>
<p><strong>lg</strong> : float</p>
<blockquote>
<div><p>Lorenzian/gaussian fraction of both FWHM, describes the contributions of gaussian and lorenzian shape.
See Voigt for details.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r187" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R187]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id3">2</a>)</em> T. C. Huang, H. Toraya, T. N. Blanton and Y. Wu
X-ray Powder Diffraction Analysis of Silver Behenate, a Possible Low-Angle Diffraction Standard
J. Appl.Cryst.(1993).26,180-184</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r188" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R188]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> Patterson, A.
The Scherrer Formula for X-Ray Particle Size Determination
Phys. Rev. 56 (10): 978–982 (1939)
doi:10.1103/PhysRev.56.978.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.addXMLParameter">
<code class="descclassname">jscatter.sas.</code><code class="descname">addXMLParameter</code><span class="sig-paren">(</span><em>dataa</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#addXMLParameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.addXMLParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the parameters stored in xml part of a .pdh file</p>
<p>eg. in SAXSPACE .pdh files</p>
<p>Takes all lines with a first non whithespace ‘&lt;’ as input from the original file</p>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.autoscaleYinoverlapX">
<code class="descclassname">jscatter.sas.</code><code class="descname">autoscaleYinoverlapX</code><span class="sig-paren">(</span><em>dataa</em>, <em>key=None</em>, <em>keep='lowest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#autoscaleYinoverlapX"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.autoscaleYinoverlapX" title="Permalink to this definition">¶</a></dt>
<dd><p>Scales elements of data to have same mean .Y value in the overlap region of .X .</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dataa</strong> : dataList</p>
<blockquote>
<div><p>data to scale</p>
</div></blockquote>
<p><strong>key</strong> : string</p>
<blockquote>
<div><p>Data are grouped into unique values of attribute key before scaling.
E.g. to do it for a series of concentrations for each concentration individually.</p>
</div></blockquote>
<p><strong>keep</strong> : default ‘l’</p>
<blockquote>
<div><p>If ‘l’ the lowest X are kept and higher X are scaled successively to next lower X.
Anything else highest X are kept and other are scaled to next higher.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dataList</p>
<blockquote class="last">
<div><p>new scaled dataList</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>First data are sorted along .X.mean()
scaling value is stored in .autoscalefactor</p>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.copyfiles">
<code class="descclassname">jscatter.sas.</code><code class="descname">copyfiles</code><span class="sig-paren">(</span><em>pattern</em>, <em>root='.'</em>, <em>destination='copy'</em>, <em>link=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#copyfiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.copyfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies all files matching pattern in tree below root to destination directory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pattern</strong> : file pattern</p>
<blockquote>
<div><p>Pattern used in fnmatch.filter</p>
</div></blockquote>
<p><strong>root</strong> : directory, default is os.curdir</p>
<blockquote>
<div><p>Directory where to start</p>
</div></blockquote>
<p><strong>destination</strong> : dirname</p>
<blockquote>
<div><p>Destination</p>
</div></blockquote>
<p><strong>link</strong> : bool</p>
<blockquote class="last">
<div><p>If True links are created.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.desmear">
<code class="descclassname">jscatter.sas.</code><code class="descname">desmear</code><span class="sig-paren">(</span><em>Ios</em>, <em>beamProfile</em>, <em>maxIterations=15</em>, <em>windowsize=3</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#desmear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.desmear" title="Permalink to this definition">¶</a></dt>
<dd><p>Desmearing according to Lake algorithm with a convergence criterion to stop recursion at best desmearing.</p>
<p>The convergence criterion reaches a minimum and the Lake algorithm <a class="reference internal" href="#r189" id="id5">[R189]</a> is stopped as described in <a class="reference internal" href="#r190" id="id6">[R190]</a>.
In each step a smoothing based on the ratio desmeared/observed as described in <a class="reference internal" href="#r190" id="id7">[R190]</a> is used (point average with windowsize 3).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Ios</strong> : dataArray</p>
<blockquote>
<div><p>Original smeared data</p>
</div></blockquote>
<p><strong>beamProfile</strong> : dataArray</p>
<blockquote>
<div><p>Beam profile as prepeared with prepareBeamProfile</p>
</div></blockquote>
<p><strong>maxIterations</strong> : int, default=15</p>
<blockquote>
<div><p>maximum iterations to stop</p>
</div></blockquote>
<p><strong>windowsize</strong> : int , default=3</p>
<blockquote>
<div><p>Window size for smoothing in each step of desmearing (running average).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r189" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R189]</td><td><em>(<a class="fn-backref" href="#id5">1</a>, <a class="fn-backref" href="#id8">2</a>)</em> Lake, J. A. (1967). Acta Cryst. 23, 191–194.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r190" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R190]</td><td><em>(<a class="fn-backref" href="#id6">1</a>, <a class="fn-backref" href="#id7">2</a>, <a class="fn-backref" href="#id9">3</a>)</em> Comparison of iterative desmearing procedures for one-dimensional small-angle scattering data
Vad and Sager, J. Appl. Cryst. (2011) 44,32-42</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.fitdarkcurrent">
<code class="descclassname">jscatter.sas.</code><code class="descname">fitdarkcurrent</code><span class="sig-paren">(</span><em>darkfile</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#fitdarkcurrent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.fitdarkcurrent" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits dark current with 5th order polynom + cosine.</p>
<p>This is dangerous as the darkcurrent has a noise that is not random but depends on count time.</p>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.getBeamWidth">
<code class="descclassname">jscatter.sas.</code><code class="descname">getBeamWidth</code><span class="sig-paren">(</span><em>empty, minmax=[-0.03, 0.03], showfit=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#getBeamWidth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.getBeamWidth" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit Gaussian to beam width of measurement.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>empty</strong> : dataArray</p>
<blockquote>
<div><p>Measurement with the transmitted beam included.
This is used within min max to fit a Gaussian.</p>
</div></blockquote>
<p><strong>minmax</strong> : [float,float]</p>
<blockquote>
<div><p>Minimum and maximum for fitting</p>
</div></blockquote>
<p><strong>showfit</strong> : bool</p>
<blockquote>
<div><p>Show the fit result</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">float as the beam width</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.locatefiles">
<code class="descclassname">jscatter.sas.</code><code class="descname">locatefiles</code><span class="sig-paren">(</span><em>pattern</em>, <em>root='.'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#locatefiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.locatefiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Locate all files matching supplied filename pattern in and below supplied root directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pattern</strong> : file pattern</p>
<blockquote>
<div><p>Pattern used in fnmatch.filter</p>
</div></blockquote>
<p><strong>root</strong> : directory, default is os.curdir</p>
<blockquote>
<div><p>Directory where to start</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">file list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.moveSAXSPACE">
<code class="descclassname">jscatter.sas.</code><code class="descname">moveSAXSPACE</code><span class="sig-paren">(</span><em>pattern</em>, <em>root='./'</em>, <em>destination='./despiked'</em>, <em>skip='BeamProfile'</em>, <em>medwindow=5</em>, <em>SGwindow=5</em>, <em>sigma=0.2</em>, <em>order=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#moveSAXSPACE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.moveSAXSPACE" title="Permalink to this definition">¶</a></dt>
<dd><p>Read SAXSPACE .pdh files and removes spikes by removespikes.</p>
<p>This is mainly for use at JCNS SAXSPACE with CCD camera as detector :-))))</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pattern</strong> : string</p>
<blockquote>
<div><p>Search pattern for filenames</p>
</div></blockquote>
<p><strong>destination</strong> : string</p>
<blockquote>
<div><p>Where to save the files</p>
</div></blockquote>
<p><strong>skip</strong> : string</p>
<blockquote>
<div><p>Words in filename to skip the file</p>
</div></blockquote>
<p><strong>medwindow</strong> : odd integer</p>
<blockquote>
<div><p>Window size of scipy.signal.medfilt</p>
</div></blockquote>
<p><strong>SGwindow</strong> : odd int, None</p>
<blockquote>
<div><p>Savitzky-Golay filter see scipy.signal.savgol_filter</p>
</div></blockquote>
<p><strong>order</strong> : int</p>
<blockquote>
<div><p>Polynominal order of scipy.signal.savgol_filter</p>
</div></blockquote>
<p><strong>sigma</strong> : float</p>
<blockquote class="last">
<div><p>Deviation factor of eY
If datapoint-median&gt; sigma*std its a spike</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Default values are adjusted to typical SAXSPACE measurement SAXS
not to reduce peaks and transmission peak and overshot region excluded
sigma =0.2 because the measurement error seems to be to big</p>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.plotBeamProfile">
<code class="descclassname">jscatter.sas.</code><code class="descname">plotBeamProfile</code><span class="sig-paren">(</span><em>beam</em>, <em>p=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#plotBeamProfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.plotBeamProfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots beam profile and weight function according to parameters in beam.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>beam</strong></p>
<blockquote class="last">
<div><p>beam with parameters</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.prepareBeamProfile">
<code class="descclassname">jscatter.sas.</code><code class="descname">prepareBeamProfile</code><span class="sig-paren">(</span><em>data=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#prepareBeamProfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.prepareBeamProfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare beam profile parameter from Beam Profile measurement or according to given parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : dataArray,’trapez’,’SANS’</p>
<blockquote>
<div><dl class="docutils">
<dt>Contains measured beam profile, explicit Gaussian width list or type ‘SANS’, ‘trapz’.</dt>
<dd><ul class="first last simple">
<li>dataArray Line collimation as measured can be given and will be smoothed and made symmetric.</li>
<li>dataArray with explicit given Gaussian width missing .X values will be interpolated.</li>
<li>‘trapez’ : Line collimation  with trapezoidal parameters a, b, bxw, dIW.</li>
<li>‘SANS’ : Smearing a la Pedersen; see resFunct for parameters</li>
</ul>
</dd>
</dl>
</div></blockquote>
<p><strong>collDist,collAperture,detDist,sampleAperture,wavelength,wavespread,dpixelWidth,dringwidth,zeroextrapolfunc :</strong></p>
<blockquote>
<div><p>Parameters as described in resFunct for SANS
These are determined from the experimental setup.</p>
</div></blockquote>
<p><strong>a</strong> : float</p>
<blockquote>
<div><p>Larger full length of trapezoidal profile in detector q units</p>
</div></blockquote>
<p><strong>b</strong> : float</p>
<blockquote>
<div><p>Shorter full length of trapezoidal profile in detector q units
If a=b ==&gt; a=a*(1+1e-7), b=b*(1-1e-7)</p>
</div></blockquote>
<p><strong>bxw</strong> : float</p>
<blockquote>
<div><p>Beam half-width (at half-height) that defines the Gaussian to describe the width profile in detector q units.
See getBeamWidth to fit to a measurement.</p>
</div></blockquote>
<p><strong>dIW</strong> : float</p>
<blockquote>
<div><p>Detector slit width in detector q units.
Length on detector to integrate parallel to beam length for line collimation.</p>
</div></blockquote>
<p><strong>wavelength</strong> : float,</p>
<blockquote>
<div><p>Wavelength in nm
default 0.155418 nm for SAXS 0.5 for SANS</p>
</div></blockquote>
<p><strong>detDist</strong> : float, default 305.3558</p>
<blockquote>
<div><p>Detectordistance in units mm
Default is SAXS detector distance of SAXSpace</p>
</div></blockquote>
<p><strong>explicit</strong> : int</p>
<blockquote>
<div><p>For explicit given Gaussian width the index of the column with the width.
For merged dataFiles of <a class="reference external" href="mailto:KWS2&#37;&#52;&#48;MLZ">KWS2<span>&#64;</span>MLZ</a> this is the forth column with index 3.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">beam profile as dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ul class="simple">
<li>For measured beam profiles parameters a,b are determined from the flanks for trapezoidal profile.</li>
<li>Detector q units are equivalent to the pixel distance as expressed in a corrected measurement.</li>
<li>For ‘explicit’ Gaussian width a SANS measurement as on KWS2 can be used which has sigma as 4th column.
Missing values are interpolated.</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># use as</span>
<span class="c1"># prepare measured beamprofile</span>
<span class="n">mbeam</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">prepareBeamProfile</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">bxw</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dIW</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="c1"># prepare profile with trapezoidal shape (a,b are fitted above)</span>
<span class="n">tbeam</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">prepareBeamProfile</span><span class="p">(</span><span class="s1">&#39;trapz&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">mbeam</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">mbeam</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">bxw</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dIW</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># prepare profile SANS (missing parameters get defaults)</span>
<span class="n">Sbeam</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">prepareBeamProfile</span><span class="p">(</span><span class="s1">&#39;SANS&#39;</span><span class="p">,</span> <span class="n">detDist</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="n">wavelength</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">wavespread</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="c1"># prepare profile with explicit given Gaussian width in column 3 as e.g. KWS2@MLZ</span>
<span class="n">Gbeam</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">prepareBeamProfile</span><span class="p">(</span><span class="n">measurement</span><span class="p">,</span><span class="n">explicit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.readpdh">
<code class="descclassname">jscatter.sas.</code><code class="descname">readpdh</code><span class="sig-paren">(</span><em>pdhFileName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#readpdh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.readpdh" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens and reads a SAXS data file in the .pdh (Primary Data Handling) format.</p>
<p>If data contain X values &lt;0 it is assumed that the primary beam is included as for SAXSpace instruments.
In this case the primary beam with max value as .transmission and the peak center as centerTransmissionPeak
are extracted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdhFileName</strong> : string</p>
<blockquote>
<div><p>file name</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>PDH format used in the  PCG SAXS software suite developed by the Glatter group at the University of Graz, Austria.
This format is described in the appendix of the PCG manual (page 123 of the 2005 version).
In the PDH format, lines 1-5 contain header information, followed by the SAXS data.
A header looks like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">saxs082511water</span>
<span class="n">SAXS</span> 
<span class="mi">470</span>         <span class="mi">1</span>         <span class="mi">0</span>         <span class="mi">0</span>         <span class="mi">0</span>         <span class="mi">0</span>         <span class="mi">0</span>         <span class="mi">0</span> 
<span class="mf">0.000000E+00</span>   <span class="mf">0.264500E+03</span>   <span class="mf">0.000000E+00</span>   <span class="mf">0.100000E+01</span>   <span class="mf">0.154200E+00</span> 
<span class="mf">0.818682E+02</span>   <span class="mf">0.306286E-01</span>   <span class="mf">0.181261E-02</span>   <span class="mf">0.154053E+00</span>   <span class="mf">0.100000E+01</span> 
<span class="o">.....</span>
</pre></div>
</div>
<dl class="docutils">
<dt>line 3:</dt>
<dd><ul class="first last simple">
<li>0: number of points</li>
</ul>
</dd>
<dt>line 4:</dt>
<dd><ul class="first last simple">
<li>0:</li>
<li>1: detector distance =&gt; SAXSpace</li>
<li>3: normalization factor; not used</li>
<li>4: wavelength =&gt; SAXSpace</li>
</ul>
</dd>
<dt>line 5:</dt>
<dd><ul class="first last simple">
<li>0:</li>
<li>1: beam-length profile parameter a</li>
<li>2: beam-length profile parameter b</li>
<li>3: half-width of the beam-width profile (at half-height)</li>
<li>4: detector slit length (equivalent to width of integration area)</li>
<li>5: q units scale: 1.0 for A-1, 10.0 for nm-1</li>
</ul>
</dd>
</dl>
<p>Additional xml parameter as in the SAXSPACE format can be extracted to attributes by addXMLParameter.</p>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.removespikes">
<code class="descclassname">jscatter.sas.</code><code class="descname">removespikes</code><span class="sig-paren">(</span><em>dataa</em>, <em>xmin=None</em>, <em>xmax=None</em>, <em>medwindow=5</em>, <em>SGwindow=None</em>, <em>sigma=0.2</em>, <em>SGorder=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#removespikes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.removespikes" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a dataset and removes single spikes.</p>
<p>A median filter is used to find single spikes.
If abs(data.Y-medianY)/data.eY&gt;sigma then the medianY value is used.
If SGwindow!=None  Savitzky-Golay filtered values are used.
If sigma is 0 then new values (median or Savitzky-Golay filtered) are used everywhere.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dataa</strong> : dataArray</p>
<blockquote>
<div><p>dataset with eY data</p>
</div></blockquote>
<p><strong>medwindow</strong> : odd integer</p>
<blockquote>
<div><p>window size of scipy.signal.medfilt</p>
</div></blockquote>
<p><strong>SGwindow</strong> : odd int, None</p>
<blockquote>
<div><p>Savitzky-Golay filter see scipy.signal.savgol_filter
without the spikes; window should be smaller than instrument resolution</p>
</div></blockquote>
<p><strong>order</strong> : int</p>
<blockquote>
<div><p>polynominal order of scipy.signal.savgol_filter
needs to be smaller than SGwindow</p>
</div></blockquote>
<p><strong>SGsigma</strong> : float</p>
<blockquote>
<div><p>relative deviation from eY
if datapoint-median&gt; sigma*eY its a spike</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Filtered and smoothed dataArray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.removespikesminmaxmethod">
<code class="descclassname">jscatter.sas.</code><code class="descname">removespikesminmaxmethod</code><span class="sig-paren">(</span><em>dataa</em>, <em>order=7</em>, <em>sigma=2</em>, <em>nrepeat=1</em>, <em>removePoints=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#removespikesminmaxmethod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.removespikesminmaxmethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a dataset and removes single spikes from data by substitution with spline.</p>
<p>Find minima and maxima of data including double point spikes; no 3 point spikes
scipy.signal.argrelextrema with np.greater and np.less are used to find extrema</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dataa</strong> : dataArray</p>
<blockquote>
<div><p>Dataset with eY data.</p>
</div></blockquote>
<p><strong>order</strong> : int</p>
<blockquote>
<div><p>Number of points see scipy.signal.argrelextrema.
Distance between extrema.</p>
</div></blockquote>
<p><strong>sigma</strong> : float</p>
<blockquote>
<div><p>Deviation factor from std dev; from eY.
If datapoint -spline&gt; sigma*std its a spike.</p>
</div></blockquote>
<p><strong>nrepeat</strong> : int</p>
<blockquote>
<div><p>Repeat the procedure nrepeat times.</p>
</div></blockquote>
<p><strong>removePoints</strong> : list of integer</p>
<blockquote>
<div><p>Instrument related points to remove because of dead pixels.
‘JCNS’ results in a list for SAXSPACE at JCNS Jülich.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">data with spikes removed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.resFunct">
<code class="descclassname">jscatter.sas.</code><code class="descname">resFunct</code><span class="sig-paren">(</span><em>S</em>, <em>collDist=8000.0</em>, <em>collAperture=10</em>, <em>detDist=8000.0</em>, <em>sampleAperture=10</em>, <em>wavelength=0.5</em>, <em>wavespread=0.2</em>, <em>dpixelWidth=10</em>, <em>dringwidth=1</em>, <em>zeroextrapolfunc=2</em>, <em>highQextrapolfunc=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#resFunct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.resFunct" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolution smearing of small angle scattering for SANS or SAXS according to Pedersen for radial averaged data.</p>
<p>I(q0)= Integral{(R(q,q0)*S(q)}dq  with  Kernel R(q,q0) of equ. 33 in <a class="reference internal" href="#r191" id="id10">[R191]</a> including wavelength spread, finite
collimation and detector resolution. Default parameters are typical for a SANS machine like <a class="reference external" href="mailto:KWS2&#37;&#52;&#48;JCNS">KWS2<span>&#64;</span>JCNS</a> with
rectangular apertures. Low Q can be extrapolated as power law or Guinier like or constant.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>S</strong> : array like</p>
<blockquote>
<div><p>dataArray with X. and .Y
theoretical Scattering function
q in nm^-1    .Y can be arbitrary unit</p>
</div></blockquote>
<p><strong>collDist</strong> : float, default 8000</p>
<blockquote>
<div><p>collimation distance in mm</p>
</div></blockquote>
<p><strong>collAperture</strong> : float, default 10</p>
<blockquote>
<div><p>collimation rectangular aperture size in mm</p>
</div></blockquote>
<p><strong>detDist</strong> : float, default 8000</p>
<blockquote>
<div><p>detector distance in mm</p>
</div></blockquote>
<p><strong>sampleAperture</strong> : float, default 10</p>
<blockquote>
<div><p>sample rectangular aperture size in mm</p>
</div></blockquote>
<p><strong>wavelength</strong> : float, default 0.5</p>
<blockquote>
<div><p>wavelength in nm</p>
</div></blockquote>
<p><strong>wavespread</strong> : float, default 0.1</p>
<blockquote>
<div><p>FWHM wavelengthspread dlambda/lambda</p>
</div></blockquote>
<p><strong>dpixelWidth</strong> : float, default 10</p>
<blockquote>
<div><p>Detector pixel width in mm</p>
</div></blockquote>
<p><strong>dringwidth</strong> : integer, default 1</p>
<blockquote>
<div><p>number of pixel for averaging</p>
</div></blockquote>
<p><strong>zeroextrapolfunc</strong> : , default 2</p>
<blockquote>
<div><dl class="docutils">
<dt>Type of extrapolation at low X edge for better handling of the border:</dt>
<dd><ul class="first last simple">
<li>guinier : Low X data are log scaled, then X**2 extrapolated as Guinier like extrapolation.</li>
<li>float :   Power law extrapolation of low X e.g. -4 for  X**-4 for Porod scaling.</li>
<li>None :    A constant value as Y(X.min()).</li>
</ul>
</dd>
</dl>
</div></blockquote>
<p><strong>highQextrapolfunc</strong> : float, default 2</p>
<blockquote>
<div><dl class="docutils">
<dt>Type of extrapolation at high X edge for better handling of the border:</dt>
<dd><ul class="first last simple">
<li>float :   Power law extrapolation of low X e.g. -4 for  X**-4 for Porod scaling.</li>
<li>None :    A constant value as Y(X.max()).</li>
</ul>
</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<p><strong>——-</strong></p>
<p><strong>dataArray</strong></p>
<blockquote class="last">
<div><p>columns [‘wavevector; smeared scattering; unsmeared scattering; half width smearing function’]</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ul class="simple">
<li>HalfWidthSmearingFunction is the FWHM the Gaussian used for smearing including all effects.</li>
<li>The resolution is assumed to be equal in direction parallel and perpendicular to q on a 2D detector as
described in chap. 2.5 in <a class="reference internal" href="#r191" id="id11">[R191]</a>.</li>
<li>We neglect additional smearing due to radial averaging (last paragraph in chap 2.5 of <a class="reference internal" href="#r191" id="id12">[R191]</a>).</li>
<li>Defaults correspond to a typical medium resolution measurement.</li>
<li>zeroextrapolfunc, highQextrapolfuncallow extrapolation at both edges to reduce edge effects.
The best values depends on the measured signal shape at the edge and may change.
The optimal way is to calculate the used model for the whole Q range, smear it and prune to the needed range.
This is demonstated in example 2.</li>
<li>An example for SANS fitting with resFunc is given in example_SANSsmearing.py.</li>
</ul>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r191" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R191]</td><td><em>(<a class="fn-backref" href="#id10">1</a>, <a class="fn-backref" href="#id11">2</a>, <a class="fn-backref" href="#id12">3</a>, <a class="fn-backref" href="#id13">4</a>, <a class="fn-backref" href="#id14">5</a>)</em> Analytical Treatment of the Resolution Function for Small-Angle Scattering
JAN SKOV PEDERSEN, DORTHE POSSELTAND KELL MORTENSEN J. Appl. Cryst. (1990). 23, 321-333</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Reproducing Table 1 of <a class="reference internal" href="#r191" id="id14">[R191]</a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="n">q</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
<span class="n">S</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">ff</span><span class="o">.</span><span class="n">sphere</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="c1"># this is the direct call of resFunc, use smear instead as shown in next example</span>
<span class="n">Sr</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">resFunct</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">collDist</span><span class="o">=</span><span class="mf">2000.0</span><span class="p">,</span> <span class="n">collAperture</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">detDist</span><span class="o">=</span><span class="mf">2000.0</span><span class="p">,</span> <span class="n">sampleAperture</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">wavespread</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">dpixelWidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dringwidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># plot it</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">S</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span><span class="n">li</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;sphere&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">Sr</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">li</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;smeared sphere&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Sr</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">Sr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">li</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;FWHM in nm\S-1 &#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="n">charsize</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;I(q) / a.u.&#39;</span><span class="p">,</span><span class="n">tick</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span><span class="n">tick</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="n">charsize</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;q / nm\S-1&#39;</span><span class="p">,</span><span class="n">tick</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">5e5</span><span class="p">)</span>
</pre></div>
</div>
<p>Example 2:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># smear model over full range and interpolate to needed data</span>
<span class="c1"># this is the best way to smear a model for fitting, but is not possible for desmearing</span>
<span class="n">meas</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dA</span><span class="p">(</span><span class="s1">&#39;measureddata.dat&#39;</span><span class="p">)</span>     <span class="c1"># load data</span>
<span class="c1"># define profile</span>
<span class="n">resol2m</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">prepareBeamProfile</span><span class="p">(</span><span class="s1">&#39;SANS&#39;</span><span class="p">,</span> <span class="n">detDist</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="n">collDist</span><span class="o">=</span><span class="mf">2000.</span><span class="p">,</span><span class="n">wavelength</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">wavespread</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">q</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.01</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span><span class="mf">0.01</span><span class="p">]</span> <span class="c1"># or np.r_[0:meas.X.min():0.01,meas.X,meas.X.max():meas.X.max()*2:0.1]</span>
<span class="c1"># calc model</span>
<span class="n">temp</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">ff</span><span class="o">.</span><span class="n">ellipsoid</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># smear it</span>
<span class="n">smearedmodel</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">smear</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="n">resol2m</span><span class="p">)</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">meas</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.resFunctExplicit">
<code class="descclassname">jscatter.sas.</code><code class="descname">resFunctExplicit</code><span class="sig-paren">(</span><em>S</em>, <em>beamprofile</em>, <em>zeroextrapolfunc=2</em>, <em>highQextrapolfunc=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#resFunctExplicit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.resFunctExplicit" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolution smearing of small angle scattering for SANS or SAXS according to explict given Gaussian width.</p>
<p>I(q0)= Integral{(R(q,q0)*S(q)}dq  with  Gaussian kernel R(q,q0).  Low Q can be extrapolated as power law or Guinier like or constant.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>S</strong> : array like</p>
<blockquote>
<div><p>dataArray with X. and .Y
theoretical Scattering function
q in nm^-1    .Y can be arbitrary unit</p>
</div></blockquote>
<p><strong>beamProfile</strong> : beamProfile ‘explicit’</p>
<blockquote>
<div><p>Beam profile as prepared from prepareBeamProfile ‘explicit’</p>
</div></blockquote>
<p><strong>zeroextrapolfunc</strong> : , default 2</p>
<blockquote>
<div><dl class="docutils">
<dt>Type of extrapolation at low X edge for better handling of the border:</dt>
<dd><ul class="first last simple">
<li>guinier : Low X data are log scaled, then X**2 extrapolated as Guinier like extrapolation.</li>
<li>float :   Power law extrapolation of low X e.g. -4 for  X**-4 for Porod scaling.</li>
<li>None :    A constant value as Y(X.min()).</li>
</ul>
</dd>
</dl>
</div></blockquote>
<p><strong>highQextrapolfunc</strong> : float, default 2</p>
<blockquote>
<div><dl class="docutils">
<dt>Type of extrapolation at high X edge for better handling of the border:</dt>
<dd><ul class="first last simple">
<li>float :   Power law extrapolation of low X e.g. -4 for  X**-4 for Porod scaling.</li>
<li>None :    A constant value as Y(X.max()).</li>
</ul>
</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<p><strong>——-</strong></p>
<p><strong>dataArray</strong></p>
<blockquote class="last">
<div><p>columns [‘wavevector; smeared scattering; unsmeared scattering; half width smearing function’]</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ul class="simple">
<li>HalfWidthSmearingFunction is the FWHM the Gaussian used for smearing including all effects.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.smear">
<code class="descclassname">jscatter.sas.</code><code class="descname">smear</code><span class="sig-paren">(</span><em>data</em>, <em>beamProfile</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#smear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.smear" title="Permalink to this definition">¶</a></dt>
<dd><p>Smearing data for line-collimated SAXS (Kratky camera) or as point collimation SANS/SAXS.</p>
<p>The full resolution for SANS is described in resFunct.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : dataArray</p>
<blockquote>
<div><p>Data to be smeared</p>
</div></blockquote>
<p><strong>beamProfile</strong> : beamProfile or ‘trap’, ‘SANS’, ‘explicit’, dataArray</p>
<blockquote>
<div><p>Beam profile as prepared from prepareBeamProfile
or type as ‘trapezoidal’, ‘SANS’,’explicit’ or a measured beam profile as dataArray for line collimation.
Measured Profile is treated by prepareBeamProfile.</p>
</div></blockquote>
<p><strong>kwargs :</strong></p>
<blockquote>
<div><p>See prepareBeamProfile for kwargs.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ul class="simple">
<li>If data has attributes a, b, dIW, bxw, detDist these are used, if not given in function call.</li>
<li>If wavelength is missing in data a default of 0.155418 nm for Xray K_alpha line is assumed. For SANS 0.6 A.</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># use as</span>
<span class="c1"># prepare measured line collimation beamprofile</span>
<span class="n">mbeam</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">prepareBeamProfile</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">bxw</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dIW</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="c1"># prepare profile with trapezoidal shape (a,b can be fitted above)</span>
<span class="n">tbeam</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">prepareBeamProfile</span><span class="p">(</span><span class="s1">&#39;trapz&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">mbeam</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">mbeam</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">bxw</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dIW</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># prepare profile SANS (missing parameters get defaults, see resFunct)</span>
<span class="n">Sbeam</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">prepareBeamProfile</span><span class="p">(</span><span class="s1">&#39;SANS&#39;</span><span class="p">,</span> <span class="n">detDist</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="n">wavelength</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">wavespread</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="c1"># prepare profile with explicit given Gaussian width in column 3 as e.g. KWS2@JCNS</span>
<span class="n">Gbeam</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">prepareBeamProfile</span><span class="p">(</span><span class="n">measurement</span><span class="p">,</span><span class="n">explicit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># smear</span>
<span class="n">datasm</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">smear</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">mbeam</span><span class="p">)</span>
<span class="n">datast</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">smear</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">tbeam</span><span class="p">)</span>
<span class="n">datasS</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">smear</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">Sbeam</span><span class="p">)</span>
<span class="n">datasG</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">sas</span><span class="o">.</span><span class="n">smear</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">Gbeam</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.sas.waterXrayScattering">
<code class="descclassname">jscatter.sas.</code><code class="descname">waterXrayScattering</code><span class="sig-paren">(</span><em>composition='h2o1'</em>, <em>T=293</em>, <em>units='mol'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/sas.html#waterXrayScattering"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.sas.waterXrayScattering" title="Permalink to this definition">¶</a></dt>
<dd><p>Absolute scattering of water with components (salt, buffer) at Q=0 as reference for X-ray.</p>
<p>According to <a class="reference internal" href="#r193" id="id15">[R193]</a> a buffer of water with components might be used.
Ions need to be given separatly as [‘55.51h2o1’,‘0.15Na’,‘0.15Cl’] for 0.15 M NaCl solution.
It is accounted for the temperature dependence of water density and compressibility.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>composition</strong> : string</p>
<blockquote>
<div><p>Buffer composition as in scatteringLengthDensityCalc
give dissosiated ions separatly as [‘1Na’,‘1Cl’] with concentration in mol prepended
the additional scattering as ionic liquid of the ions in water is taken into account see <a class="reference internal" href="#r193" id="id16">[R193]</a>
mass in g; 1000g water are 55.508 mol</p>
</div></blockquote>
<p><strong>T</strong> : float</p>
<blockquote>
<div><p>temperature in °K</p>
</div></blockquote>
<p><strong>units</strong> : ‘mol’</p>
<blockquote>
<div><p>anything except ‘mol’ prepended unit is mass fraction
‘mol’ prepended units is mol and mass fraction is calculated as <img class="math" src="_images/math/b68ea49674414425219b7e024f46a55cb395e7e6.png" alt="mass=[mol] mass_{molecule}"/>
e.g. 1l Water with 123mmol NaCl   [‘55.508H2O1’,‘0.123Na1Cl1’]</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">float absolute scattering length in Units 1/cm</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p><img class="math" src="_images/math/0b1b2c0a6429a66372044de632b9448643daa356.png" alt="I(0)=(\sigma_{water}^2f_e^2 n_{ew}^2 k_B T \chi + \sum_{ci} n_i N_A 1000 n_{ei}^2 f_e^2 )/100"/></p>
<p>with</p>
<blockquote>
<div><img class="math" src="_images/math/43977296d937b3c4f76fa077303e0edc3a765812.png" alt="\sigma_{water}"/> water density
<img class="math" src="_images/math/1bc8153a40ba7d2281c26bfe99604ad9e6f34749.png" alt="\chi"/>           compressibility
<img class="math" src="_images/math/9c8f64e7bb54a434a2098d2ab2987a4723692d9b.png" alt="n_{ew}"/>     number of electrons per water molecule
<img class="math" src="_images/math/7efcee34d4f564c6efe8aaf69982a2687234e1eb.png" alt="f_e"/>        cross section of electron in nm
<img class="math" src="_images/math/9b7b651ab6210b690c07d6a9ec9c1c39ec2953fd.png" alt="k_B"/>        Boltzman constant
<img class="math" src="_images/math/4fbb0705523f8fdd2c3c5f55e4f8c4a9a46f18a6.png" alt="n_i"/>        concentration component i
<img class="math" src="_images/math/89d196ec68c8b4f4f11946d8f5d4a033549f8264.png" alt="n_{ei}"/>     number of electrons per molecule component i in Mol
<img class="math" src="_images/math/44a38ec18fde838e5a481bdf30a29254143d1486.png" alt="\sum_{ci}"/>   is done for all ions separately if given</div></blockquote>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r192" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id17">[R192]</a></td><td>SAXS experiments on absolute scale with Kratky systems using water as a secondary standard
Doris Orthaber et al. J. Appl. Cryst. (2000). 33, 218±225</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r193" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R193]</td><td><em>(<a class="fn-backref" href="#id15">1</a>, <a class="fn-backref" href="#id16">2</a>, <a class="fn-backref" href="#id18">3</a>)</em> A high sensitivity pinhole camera for soft condensed matter
T. Zemb, O. Tache, F. Né, and O. Spalla, J. Appl. Crystallogr. 36, 800 (2003).</td></tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/Jscatter.jpeg" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5. Small angle scattering (sas)</a><ul>
<li><a class="reference internal" href="#smear-desmear">5.1. Smear/desmear</a></li>
<li><a class="reference internal" href="#housekeeping">5.2. Housekeeping</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="formel.html"
                        title="previous chapter">4. formel</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="formfactor.html"
                        title="next chapter">6. formfactor (ff)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/sas.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="formfactor.html" title="6. formfactor (ff)"
             >next</a> |</li>
        <li class="right" >
          <a href="formel.html" title="4. formel"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">jscatter 0.6.7 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, Ralf Biehl.
      Last updated on Jan 21, 2018.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.
    </div>
  </body>
</html>