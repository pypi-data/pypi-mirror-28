
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>8. dynamic &#8212; jscatter 0.6.8 documentation</title>
    <link rel="stylesheet" href="_static//default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.6.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="9. DLS" href="dls.html" />
    <link rel="prev" title="7. structurefactor (sf)" href="structurefactor.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dls.html" title="9. DLS"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="structurefactor.html" title="7. structurefactor (sf)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">jscatter 0.6.8 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="dynamic">
<h1>8. dynamic<a class="headerlink" href="#dynamic" title="Permalink to this headline">Â¶</a></h1>
<p>Models describing dynamic processes mainly for inealstic neutron scattering.</p>
<ul class="simple">
<li>Models in the time domain have a parameter t for time. -&gt; intermediate scattering function I(q,t)</li>
<li>Models in the frequency domain have a parameter w for frequency and _w in the name. -&gt; dynamic structure factor S(q,w)</li>
</ul>
<p>Models in time domain can be transformed to frequncy domain by <a class="reference internal" href="#jscatter.dynamic.time2frequencyFF" title="jscatter.dynamic.time2frequencyFF"><code class="xref py py-func docutils literal"><span class="pre">time2frequencyFF()</span></code></a>.</p>
<p>In time domain the combination of processes is done by multiplication, including instrument resolution.</p>
<p><img class="math" src="_images/math/b9df13270872af09cb1e57cd8f94738b1c209e4b.png" alt="I_x(t,q)=I_1(t,q)I_2(t,q)R(t,q)"/>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># multiplying and creating new dataArray</span>
<span class="n">Ix</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">dA</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">I1</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="o">..</span><span class="p">)</span><span class="o">.</span><span class="n">Y</span><span class="o">*</span><span class="n">I2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="o">..</span><span class="p">)</span><span class="o">.</span><span class="n">Y</span><span class="o">*</span><span class="n">R</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="o">..</span><span class="p">)</span><span class="o">.</span><span class="n">Y</span> <span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
<p>In frequency domain it is a convolution, including the instrument resolution.</p>
<p><img class="math" src="_images/math/016da849419b00a9a4761f828e35a6274db6bf50.png" alt="S_x(t,q) = S_1(t,q) \otimes S_2(t,q) \otimes R(w,q)"/>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">conv</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">formel</span><span class="o">.</span><span class="n">convolve</span>
<span class="n">Sx</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">w</span><span class="p">)</span><span class="o">=</span><span class="n">conv</span><span class="p">(</span><span class="n">conv</span><span class="p">(</span><span class="n">S1</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="o">..</span><span class="p">),</span><span class="n">S2</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="o">..</span><span class="p">)),</span><span class="n">res</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="o">..</span><span class="p">),</span><span class="n">normB</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>      <span class="c1"># normB normalizes resolution</span>
</pre></div>
</div>
<p><a class="reference internal" href="#jscatter.dynamic.time2frequencyFF" title="jscatter.dynamic.time2frequencyFF"><code class="xref py py-func docutils literal"><span class="pre">time2frequencyFF()</span></code></a> allows mixing between timedomain and frequncy domain models.
This FFT from timedomain needs the resolution included in the timedomain as it acts like a
window function to reduce spectral leakage with vanishing values at <img class="math" src="_images/math/3635dae2a468768581c03ae019a1435ee3b517ef.png" alt="t_{max}"/>.</p>
<p>The last step is to shift the model spectrum to the symmetry as found in the resolution measurement
and do the binning over frequency channels by <a class="reference internal" href="#jscatter.dynamic.shiftAndBinning" title="jscatter.dynamic.shiftAndBinning"><code class="xref py py-func docutils literal"><span class="pre">shiftAndBinning()</span></code></a>.</p>
<p>Let us describe the diffusion of a particle inside a diffusing invisible sphere by mixing time domain and frequency domain.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s0&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;m0&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;a0&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;bgr&#39;</span><span class="p">:</span><span class="mf">0.00</span><span class="p">}</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mf">0.5</span><span class="p">]</span>
<span class="n">resolution</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">resolution_w</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="o">**</span><span class="n">start</span><span class="p">)</span>
<span class="c1"># model</span>
<span class="k">def</span> <span class="nf">diffindiffSphere</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">Dp</span><span class="p">,</span><span class="n">Ds</span><span class="p">,</span><span class="n">w0</span><span class="p">,</span><span class="n">bgr</span><span class="p">):</span>
    <span class="c1"># time domain with transform to frequency domain</span>
    <span class="n">diff_w</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">time2frequencyFF</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">simpleDiffusion</span><span class="p">,</span><span class="n">resolution</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">D</span><span class="o">=</span><span class="n">Ds</span><span class="p">)</span>
    <span class="c1"># last convolution in frequency domain, resolution was already included in time domain.</span>
    <span class="n">Sx</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">formel</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">diffusionInSphere_w</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">D</span><span class="o">=</span><span class="n">Dp</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">),</span><span class="n">diff_w</span><span class="p">)</span>
    <span class="n">Sxsb</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">shiftAndBinning</span><span class="p">(</span><span class="n">Sx</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">)</span>
    <span class="n">Sxsb</span><span class="o">.</span><span class="n">Y</span><span class="o">+=</span><span class="n">bgr</span>       <span class="c1"># add background</span>
    <span class="k">return</span> <span class="n">Sxsb</span>
<span class="c1">#</span>
<span class="n">Iqw</span><span class="o">=</span><span class="n">diffindiffSphere</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="mf">5.5</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">Dp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Ds</span><span class="o">=</span><span class="mf">0.035</span><span class="p">,</span><span class="n">w0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">bgr</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
</pre></div>
</div>
<p>For more complex systems with different scattering length or changing contributions the fraction of
contributing atoms (with scattering length) has to be included.</p>
<p>Accordingly, if desired, the mixture of coherent and incoherent scattering needs to be accounted for.
This additionally is dependent on the used instrument e.g. for spin echo only 1/3 of the incohernet scattering
contributes to the signal.
An example model for protein dynamics is given in <a class="reference internal" href="examples.html#protein-incoherent-scattering-in-frequency-domain"><span class="std std-ref">Protein incoherent scattering in frequency domain</span></a>.</p>
<p>A comparison of different dynamic models in frequency domain is given in examples.
<a class="reference internal" href="examples.html#a-comparison-of-different-dynamic-models-in-frequency-domain"><span class="std std-ref">A comparison of different dynamic models in frequency domain</span></a>.</p>
<p>For conversion to energy use E=js.dynamic.h*w with  h=4135.667662340164 [meV/ns]</p>
<p>Return values are dataArrays were useful.
To get only Y values use .Y</p>
<div class="section" id="transfom-between-domains">
<h2>8.1. Transfom between domains<a class="headerlink" href="#transfom-between-domains" title="Permalink to this headline">Â¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.shiftAndBinning" title="jscatter.dynamic.shiftAndBinning"><code class="xref py py-obj docutils literal"><span class="pre">shiftAndBinning</span></code></a>(data[,&nbsp;w,&nbsp;dw,&nbsp;w0])</td>
<td>Shift spectrum and average (binning) in intervals.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.time2frequencyFF" title="jscatter.dynamic.time2frequencyFF"><code class="xref py py-obj docutils literal"><span class="pre">time2frequencyFF</span></code></a>(timemodel,&nbsp;resolution[,&nbsp;w,&nbsp;â¦])</td>
<td>Fast Fourier transform from time domain to frequency domain for inelastic neutron scattering.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="time-domain">
<h2>8.2. Time domain<a class="headerlink" href="#time-domain" title="Permalink to this headline">Â¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.resolution" title="jscatter.dynamic.resolution"><code class="xref py py-obj docutils literal"><span class="pre">resolution</span></code></a>(t[,&nbsp;s0,&nbsp;m0,&nbsp;s1,&nbsp;m1,&nbsp;s2,&nbsp;m2,&nbsp;s3,&nbsp;â¦])</td>
<td>Resolution in time domain as multiple Gaussians for inelastic measurement as backscattering or time of flight instruement.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.simpleDiffusion" title="jscatter.dynamic.simpleDiffusion"><code class="xref py py-obj docutils literal"><span class="pre">simpleDiffusion</span></code></a>(q,&nbsp;t,&nbsp;D[,&nbsp;amplitude])</td>
<td>Intermediate scattering function for diffusing particles.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.doubleDiffusion" title="jscatter.dynamic.doubleDiffusion"><code class="xref py py-obj docutils literal"><span class="pre">doubleDiffusion</span></code></a>(q,&nbsp;t,&nbsp;amplitude0,&nbsp;D0[,&nbsp;â¦])</td>
<td>Two exponential decaying functions.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.cumulantDiff" title="jscatter.dynamic.cumulantDiff"><code class="xref py py-obj docutils literal"><span class="pre">cumulantDiff</span></code></a>(t,&nbsp;q[,&nbsp;k0,&nbsp;k1,&nbsp;k2,&nbsp;k3,&nbsp;k4,&nbsp;k5])</td>
<td>Cumulant of order ki with cumulants as diffusion coefficients.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.cumulant" title="jscatter.dynamic.cumulant"><code class="xref py py-obj docutils literal"><span class="pre">cumulant</span></code></a>(x[,&nbsp;k0,&nbsp;k1,&nbsp;k2,&nbsp;k3,&nbsp;k4,&nbsp;k5])</td>
<td>Cumulant of order ki</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.cumulantDLS" title="jscatter.dynamic.cumulantDLS"><code class="xref py py-obj docutils literal"><span class="pre">cumulantDLS</span></code></a>(t,&nbsp;A,&nbsp;G,&nbsp;sigma[,&nbsp;skewness,&nbsp;bgr])</td>
<td>Cumulant analysis for dynamic light scattering</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.finiteRouse" title="jscatter.dynamic.finiteRouse"><code class="xref py py-obj docutils literal"><span class="pre">finiteRouse</span></code></a>(t,&nbsp;q[,&nbsp;NN,&nbsp;pmax,&nbsp;ll,&nbsp;frict,&nbsp;â¦])</td>
<td>Rouse dynamics of a finite chain with N beads of bonds length l and internal friction.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.finiteZimm" title="jscatter.dynamic.finiteZimm"><code class="xref py py-obj docutils literal"><span class="pre">finiteZimm</span></code></a>(t,&nbsp;q[,&nbsp;NN,&nbsp;pmax,&nbsp;ll,&nbsp;Dcm,&nbsp;â¦])</td>
<td>Zimm dynamics with internal friction of a finite chain with N beads of bonds length l.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.integralZimm" title="jscatter.dynamic.integralZimm"><code class="xref py py-obj docutils literal"><span class="pre">integralZimm</span></code></a>(t,&nbsp;q[,&nbsp;Temp,&nbsp;viscosity,&nbsp;amp,&nbsp;â¦])</td>
<td>Conformational dynamics of an ideal chain with hydrodynamic interaction Integral version Zimm dynamics.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.stretchedExp" title="jscatter.dynamic.stretchedExp"><code class="xref py py-obj docutils literal"><span class="pre">stretchedExp</span></code></a>(t,&nbsp;gamma,&nbsp;beta[,&nbsp;amp])</td>
<td>Stretched exponential function.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.jumpDiffusion" title="jscatter.dynamic.jumpDiffusion"><code class="xref py py-obj docutils literal"><span class="pre">jumpDiffusion</span></code></a>(t,&nbsp;Q,&nbsp;t0,&nbsp;l0)</td>
<td>Incoherent intermediate scattering function of translational jump diffusion in the time domain.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.methylRotation" title="jscatter.dynamic.methylRotation"><code class="xref py py-obj docutils literal"><span class="pre">methylRotation</span></code></a>(t,&nbsp;q[,&nbsp;t0,&nbsp;rhh,&nbsp;beta])</td>
<td>Incoherent intermediate scattering function of CH3 methyl rotation in the time domain.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.diffusionHarmonicPotential" title="jscatter.dynamic.diffusionHarmonicPotential"><code class="xref py py-obj docutils literal"><span class="pre">diffusionHarmonicPotential</span></code></a>(t,&nbsp;q,&nbsp;rmsd,&nbsp;tau)</td>
<td>ISF corresponding to the standard OU process for diffusion in harmonic potential for dimension 1,2,3.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.diffusionPeriodicPotential" title="jscatter.dynamic.diffusionPeriodicPotential"><code class="xref py py-obj docutils literal"><span class="pre">diffusionPeriodicPotential</span></code></a>(t,&nbsp;q,&nbsp;u,&nbsp;rt,&nbsp;Dg)</td>
<td>Fractional diffusion of a particle in a periodic potential.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.zilmanGranekBicontinious" title="jscatter.dynamic.zilmanGranekBicontinious"><code class="xref py py-obj docutils literal"><span class="pre">zilmanGranekBicontinious</span></code></a>(t,&nbsp;q,&nbsp;xi,&nbsp;kappa,&nbsp;eta)</td>
<td>Dynamics of bicontinuous microemulsion phases.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.zilmanGranekLamellar" title="jscatter.dynamic.zilmanGranekLamellar"><code class="xref py py-obj docutils literal"><span class="pre">zilmanGranekLamellar</span></code></a>(t,&nbsp;q,&nbsp;df,&nbsp;kappa,&nbsp;eta[,&nbsp;â¦])</td>
<td>Dynamics of lamellar microemulsion phases.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="frequency-domain">
<h2>8.3. Frequency domain<a class="headerlink" href="#frequency-domain" title="Permalink to this headline">Â¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.h" title="jscatter.dynamic.h"><code class="xref py py-obj docutils literal"><span class="pre">h</span></code></a></td>
<td>Planck constant in meV/ns</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.getHWHM" title="jscatter.dynamic.getHWHM"><code class="xref py py-obj docutils literal"><span class="pre">getHWHM</span></code></a>(data[,&nbsp;center,&nbsp;gap])</td>
<td>Find half width at half maximum of a distribution around zero.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">convolve</span></code>(A,&nbsp;B[,&nbsp;mode,&nbsp;normA,&nbsp;normB])</td>
<td>Convolve A and B  with proper tracking of the output X axis.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.resolution_w" title="jscatter.dynamic.resolution_w"><code class="xref py py-obj docutils literal"><span class="pre">resolution_w</span></code></a>(w[,&nbsp;s0,&nbsp;m0,&nbsp;s1,&nbsp;m1,&nbsp;s2,&nbsp;m2,&nbsp;â¦])</td>
<td>Resolution as multiple Gaussians for inelastic measurement as backscattering or time of flight instruement in w domain.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.elastic_w" title="jscatter.dynamic.elastic_w"><code class="xref py py-obj docutils literal"><span class="pre">elastic_w</span></code></a>(w)</td>
<td>Elastic line; dynamic structure factor in w domain.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.transDiff_w" title="jscatter.dynamic.transDiff_w"><code class="xref py py-obj docutils literal"><span class="pre">transDiff_w</span></code></a>(w,&nbsp;q,&nbsp;D)</td>
<td>Translational diffusion; dynamic structure factor in w domain.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.jumpDiff_w" title="jscatter.dynamic.jumpDiff_w"><code class="xref py py-obj docutils literal"><span class="pre">jumpDiff_w</span></code></a>(w,&nbsp;q,&nbsp;t0,&nbsp;r0)</td>
<td>Jump diffusion; dynamic structure factor in w domain.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.diffusionHarmonicPotential_w" title="jscatter.dynamic.diffusionHarmonicPotential_w"><code class="xref py py-obj docutils literal"><span class="pre">diffusionHarmonicPotential_w</span></code></a>(w,&nbsp;q,&nbsp;tau,&nbsp;rmsd)</td>
<td>Diffusion in a harmonic potential for dimension 1,2,3 (isotropic averaged), dynamic structure factor in w domain.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.diffusionInSphere_w" title="jscatter.dynamic.diffusionInSphere_w"><code class="xref py py-obj docutils literal"><span class="pre">diffusionInSphere_w</span></code></a>(w,&nbsp;q,&nbsp;D,&nbsp;R)</td>
<td>Diffusion inside of a sphere; dynamic structure factor in w domain.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.dynamic.rotDiffusion_w" title="jscatter.dynamic.rotDiffusion_w"><code class="xref py py-obj docutils literal"><span class="pre">rotDiffusion_w</span></code></a>(w,&nbsp;q,&nbsp;cloud,&nbsp;Dr[,&nbsp;lmax])</td>
<td>Rotational diffusion of an object (dummy atoms); dynamic structure factor in w domain.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.dynamic.nSiteJumpDiffusion_w" title="jscatter.dynamic.nSiteJumpDiffusion_w"><code class="xref py py-obj docutils literal"><span class="pre">nSiteJumpDiffusion_w</span></code></a>(w,&nbsp;q,&nbsp;N,&nbsp;t0,&nbsp;r0)</td>
<td>Random walk among N equidistant sites (isotropic averaged); dynamic structure factor in w domain.</td>
</tr>
</tbody>
</table>
<hr class="docutils" />
<span class="target" id="module-jscatter.dynamic"></span><p>Models describing dynamic processes mainly for inealstic neutron scattering.</p>
<ul class="simple">
<li>Models in the time domain have a parameter t for time. -&gt; intermediate scattering function I(q,t)</li>
<li>Models in the frequency domain have a parameter w for frequency and _w in the name. -&gt; dynamic structure factor S(q,w)</li>
</ul>
<p>Models in time domain can be transformed to frequncy domain by <a class="reference internal" href="#jscatter.dynamic.time2frequencyFF" title="jscatter.dynamic.time2frequencyFF"><code class="xref py py-func docutils literal"><span class="pre">time2frequencyFF()</span></code></a>.</p>
<p>In time domain the combination of processes is done by multiplication, including instrument resolution.</p>
<p><img class="math" src="_images/math/b9df13270872af09cb1e57cd8f94738b1c209e4b.png" alt="I_x(t,q)=I_1(t,q)I_2(t,q)R(t,q)"/>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># multiplying and creating new dataArray</span>
<span class="n">Ix</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">dA</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">I1</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="o">..</span><span class="p">)</span><span class="o">.</span><span class="n">Y</span><span class="o">*</span><span class="n">I2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="o">..</span><span class="p">)</span><span class="o">.</span><span class="n">Y</span><span class="o">*</span><span class="n">R</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="o">..</span><span class="p">)</span><span class="o">.</span><span class="n">Y</span> <span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
<p>In frequency domain it is a convolution, including the instrument resolution.</p>
<p><img class="math" src="_images/math/016da849419b00a9a4761f828e35a6274db6bf50.png" alt="S_x(t,q) = S_1(t,q) \otimes S_2(t,q) \otimes R(w,q)"/>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">conv</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">formel</span><span class="o">.</span><span class="n">convolve</span>
<span class="n">Sx</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">w</span><span class="p">)</span><span class="o">=</span><span class="n">conv</span><span class="p">(</span><span class="n">conv</span><span class="p">(</span><span class="n">S1</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="o">..</span><span class="p">),</span><span class="n">S2</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="o">..</span><span class="p">)),</span><span class="n">res</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="o">..</span><span class="p">),</span><span class="n">normB</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>      <span class="c1"># normB normalizes resolution</span>
</pre></div>
</div>
<p><a class="reference internal" href="#jscatter.dynamic.time2frequencyFF" title="jscatter.dynamic.time2frequencyFF"><code class="xref py py-func docutils literal"><span class="pre">time2frequencyFF()</span></code></a> allows mixing between timedomain and frequncy domain models.
This FFT from timedomain needs the resolution included in the timedomain as it acts like a
window function to reduce spectral leakage with vanishing values at <img class="math" src="_images/math/3635dae2a468768581c03ae019a1435ee3b517ef.png" alt="t_{max}"/>.</p>
<p>The last step is to shift the model spectrum to the symmetry as found in the resolution measurement
and do the binning over frequency channels by <a class="reference internal" href="#jscatter.dynamic.shiftAndBinning" title="jscatter.dynamic.shiftAndBinning"><code class="xref py py-func docutils literal"><span class="pre">shiftAndBinning()</span></code></a>.</p>
<p>Let us describe the diffusion of a particle inside a diffusing invisible sphere by mixing time domain and frequency domain.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s0&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;m0&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;a0&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;bgr&#39;</span><span class="p">:</span><span class="mf">0.00</span><span class="p">}</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mf">0.5</span><span class="p">]</span>
<span class="n">resolution</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">resolution_w</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="o">**</span><span class="n">start</span><span class="p">)</span>
<span class="c1"># model</span>
<span class="k">def</span> <span class="nf">diffindiffSphere</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">Dp</span><span class="p">,</span><span class="n">Ds</span><span class="p">,</span><span class="n">w0</span><span class="p">,</span><span class="n">bgr</span><span class="p">):</span>
    <span class="c1"># time domain with transform to frequency domain</span>
    <span class="n">diff_w</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">time2frequencyFF</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">simpleDiffusion</span><span class="p">,</span><span class="n">resolution</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">D</span><span class="o">=</span><span class="n">Ds</span><span class="p">)</span>
    <span class="c1"># last convolution in frequency domain, resolution was already included in time domain.</span>
    <span class="n">Sx</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">formel</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">diffusionInSphere_w</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">D</span><span class="o">=</span><span class="n">Dp</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">),</span><span class="n">diff_w</span><span class="p">)</span>
    <span class="n">Sxsb</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">shiftAndBinning</span><span class="p">(</span><span class="n">Sx</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">)</span>
    <span class="n">Sxsb</span><span class="o">.</span><span class="n">Y</span><span class="o">+=</span><span class="n">bgr</span>       <span class="c1"># add background</span>
    <span class="k">return</span> <span class="n">Sxsb</span>
<span class="c1">#</span>
<span class="n">Iqw</span><span class="o">=</span><span class="n">diffindiffSphere</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="mf">5.5</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">Dp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Ds</span><span class="o">=</span><span class="mf">0.035</span><span class="p">,</span><span class="n">w0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">bgr</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
</pre></div>
</div>
<p>For more complex systems with different scattering length or changing contributions the fraction of
contributing atoms (with scattering length) has to be included.</p>
<p>Accordingly, if desired, the mixture of coherent and incoherent scattering needs to be accounted for.
This additionally is dependent on the used instrument e.g. for spin echo only 1/3 of the incohernet scattering
contributes to the signal.
An example model for protein dynamics is given in <a class="reference internal" href="examples.html#protein-incoherent-scattering-in-frequency-domain"><span class="std std-ref">Protein incoherent scattering in frequency domain</span></a>.</p>
<p>A comparison of different dynamic models in frequency domain is given in examples.
<a class="reference internal" href="examples.html#a-comparison-of-different-dynamic-models-in-frequency-domain"><span class="std std-ref">A comparison of different dynamic models in frequency domain</span></a>.</p>
<p>For conversion to energy use E=js.dynamic.h*w with  h=4135.667662340164 [meV/ns]</p>
<p>Return values are dataArrays were useful.
To get only Y values use .Y</p>
<dl class="function">
<dt id="jscatter.dynamic.cumulant">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">cumulant</code><span class="sig-paren">(</span><em>x</em>, <em>k0=0</em>, <em>k1=0</em>, <em>k2=0</em>, <em>k3=0</em>, <em>k4=0</em>, <em>k5=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#cumulant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.cumulant" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Cumulant of order ki
k0*(exp(-k1*x+1/2*(k2*x)**2-1/6*(k3*x)**3+1/24*(k4*x)**4-1/120*(k5*x)**5))</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : float</p>
<blockquote>
<div><p>wavevector</p>
</div></blockquote>
<p><strong>k0,k1, k2,k3,k4,k5</strong> : float</p>
<blockquote>
<div><p>coefficients all in units 1/x
k2/k1 = relative standard deviation if a gaussian distribution is assumed
k3/k1 = relative skewness k3=skewness**3/G**3</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.cumulantDLS">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">cumulantDLS</code><span class="sig-paren">(</span><em>t</em>, <em>A</em>, <em>G</em>, <em>sigma</em>, <em>skewness=0</em>, <em>bgr=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#cumulantDLS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.cumulantDLS" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Cumulant analysis for dynamic light scattering</p>
<p>A*np.exp(-t/G)*(1+(sigma/G*t)**2/2.-(skewness/G*t)**3/6.)+elastic</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : array</p>
<blockquote>
<div><p>time</p>
</div></blockquote>
<p><strong>A</strong> : float</p>
<blockquote>
<div><p>Amplitude at t=0; Intercept</p>
</div></blockquote>
<p><strong>G</strong> : float</p>
<blockquote>
<div><p>Mean relaxation time as 1/decay rate in units of t</p>
</div></blockquote>
<p><strong>sigma</strong> : float</p>
<blockquote>
<div><ul class="simple">
<li>relative standard deviation if a gaussian distribution is assumed</li>
<li>should be smaller 1 or the Taylor expansion is not valid</li>
<li>k2=variance=sigma**2/G**2</li>
</ul>
</div></blockquote>
<p><strong>skewness</strong> : float,default 0</p>
<blockquote>
<div><p>relative skewness k3=skewness**3/G**3</p>
</div></blockquote>
<p><strong>bgr</strong> : float; default 0</p>
<blockquote>
<div><p>a constant background</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r41" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[R41]</a></td><td>Revisiting the method of cumulants for the analysis of dynamic light-scattering data
Barbara J. Frisken APPLIED OPTICS  40, 4087 (2001)</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.cumulantDiff">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">cumulantDiff</code><span class="sig-paren">(</span><em>t</em>, <em>q</em>, <em>k0=0</em>, <em>k1=0</em>, <em>k2=0</em>, <em>k3=0</em>, <em>k4=0</em>, <em>k5=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#cumulantDiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.cumulantDiff" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Cumulant of order ki with cumulants as diffusion coefficients.</p>
<p>means gamma_1 =q^2*D_1 in the linear term
k0*(exp(-q**2.*(k1*x+1/2*(k2*x)**2+1/6*(k3*x)**3+1/24*(k4*x)**4+1/120*(k5*x)**5)))</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : array</p>
<blockquote>
<div><p>time</p>
</div></blockquote>
<p><strong>q</strong> : float</p>
<blockquote>
<div><p>wavevector</p>
</div></blockquote>
<p><strong>k0</strong> : float</p>
<blockquote>
<div><p>amplitude</p>
</div></blockquote>
<p><strong>k1</strong> : float</p>
<blockquote>
<div><p>diffusion coefficient in units of 1/([q]*[t])</p>
</div></blockquote>
<p><strong>k2,k3,k4,k5</strong> : float</p>
<blockquote>
<div><p>higher coefficients in same units as k1</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray :</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.diffusionHarmonicPotential">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">diffusionHarmonicPotential</code><span class="sig-paren">(</span><em>t</em>, <em>q</em>, <em>rmsd</em>, <em>tau</em>, <em>ndim=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#diffusionHarmonicPotential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.diffusionHarmonicPotential" title="Permalink to this definition">Â¶</a></dt>
<dd><p>ISF corresponding to the standard OU process for diffusion in harmonic potential for dimension 1,2,3.</p>
<p>The intermediate scattering function corresponding to the standard OU process
for diffusion in an harmonic potenital <a class="reference internal" href="#r42" id="id2">[R42]</a>. It is used for localized translational motion in
incoherent neutron scattering <a class="reference internal" href="#r43" id="id3">[R43]</a> as improvement for the diffusion in a sphere model.
Atomic motion may be resticted to ndim=1,2,3 dimensions and are isotropical averaged.
The correlation is assumed to be exponential decaying.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : array</p>
<blockquote>
<div><p>timevalues in units ns</p>
</div></blockquote>
<p><strong>q</strong> : float</p>
<blockquote>
<div><p>wavevector in unit 1/nm</p>
</div></blockquote>
<p><strong>rmsd</strong> : float</p>
<blockquote>
<div><p>Root mean square displacement &lt;u**2&gt;**0.5 in potetial in units nm.
&lt;u**2&gt;**0.5 is the width of the potential
According to <a class="reference internal" href="#r43" id="id4">[R43]</a>  5*u**2=R**2 compared to the diffusion in a sphere.</p>
</div></blockquote>
<p><strong>tau</strong> : float</p>
<blockquote>
<div><p>Correlation time in units ns.
Diffusion constant in sphere Ds=u**2/tau</p>
</div></blockquote>
<p><strong>ndim</strong> : 1,2,3, default=3</p>
<blockquote>
<div><p>Dimensionality of the diffusion potential.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r42" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R42]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id5">2</a>)</em> Quasielastic neutron scattering and relaxation processes in proteins: analytical and simulation-based models
G. R. Kneller Phys. ChemChemPhys. ,2005, 7,2641â2655</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r43" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R43]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id4">2</a>, <a class="fn-backref" href="#id6">3</a>)</em> Gaussian model for localized translational motion: Application to incoherent neutron scattering
F. Volino, J.-C. Perrin and S. Lyonnard, J. Phys. Chem. B 110, 11217â11223 (2006)</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6</span><span class="p">:</span><span class="mf">0.1</span><span class="p">]</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">diffusionHarmonicPotential</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;1D &#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">diffusionHarmonicPotential</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;2D &#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">diffusionHarmonicPotential</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;3D &#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;I(Q,t)&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Q / ns&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">subtitle</span><span class="p">(</span><span class="s1">&#39;Figure 2 of ref Volino J. Phys. Chem. B 110, 11217&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.diffusionHarmonicPotential_w">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">diffusionHarmonicPotential_w</code><span class="sig-paren">(</span><em>w</em>, <em>q</em>, <em>tau</em>, <em>rmsd</em>, <em>ndim=3</em>, <em>nmax='auto'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#diffusionHarmonicPotential_w"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.diffusionHarmonicPotential_w" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Diffusion in a harmonic potential for dimension 1,2,3 (isotropic averaged), dynamic structure factor in w domain.</p>
<p>An approach worked out by Volino et al <a class="reference internal" href="#r44" id="id7">[R44]</a> assuming Gaussian confinement and leads to a more efficient 
formulation by replacing the expression for diffusion in a sphere with a simpler expression pertaining 
to a soft confinement in harmonic potential. Ds = â¨u**2â©/t0</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>w</strong> : array</p>
<blockquote>
<div><p>Frequencies in 1/ns</p>
</div></blockquote>
<p><strong>q</strong> : float</p>
<blockquote>
<div><p>Wavevector in nm**-1</p>
</div></blockquote>
<p><strong>tau</strong> : float</p>
<blockquote>
<div><p>Mean correlation time time. In units ns.</p>
</div></blockquote>
<p><strong>rmsd</strong> : float</p>
<blockquote>
<div><p>Root mean square displacement (width) of the Gaussian in units nm.</p>
</div></blockquote>
<p><strong>ndim</strong> : 1,2,3, default=3</p>
<blockquote>
<div><p>Dimensionality of the potential.</p>
</div></blockquote>
<p><strong>nmax</strong> : int,âautoâ</p>
<blockquote>
<div><p>Order of expansion.
âautoâ -&gt; nmax = min(max(int(6*q * q * u2),30),1000)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Volino et al <a class="reference internal" href="#r44" id="id8">[R44]</a> compared the behaviour of this approach to the well known expression for diffusion in a sphere. 
Even if the details differ, the salient features of both models match if the radius R**2 â 5*u0**2 and
the diffusion constant inside the sphere relates to the relaxation time of particle correlation t0= â¨u**2â©/Ds
towards the Gaussian with width u0=â¨u**2â©**0.5.</p>
<dl class="docutils">
<dt>ndim=3</dt>
<dd>Here we use the Fourier transform of equ 23 with equ. 29a+b in <a class="reference internal" href="#r44" id="id9">[R44]</a>.
For order n larger 30 the Stirling approximation for n! in equ 27b of <a class="reference internal" href="#r44" id="id10">[R44]</a> is used.</dd>
<dt>ndim=2</dt>
<dd>Here we use the Fourier transform of equ 23 with equ. 28a+b in <a class="reference internal" href="#r44" id="id11">[R44]</a>.</dd>
<dt>ndim=1</dt>
<dd>The equation given by Violino seems to be wrong !!!!
Dont use this !!!!!!!!
Use the model from time domain and use FFT as in example given
Here we use the Fourier transform of equ 23 with equ. 29a+b in <a class="reference internal" href="#r44" id="id12">[R44]</a>.</dd>
</dl>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r44" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R44]</td><td><em>(<a class="fn-backref" href="#id7">1</a>, <a class="fn-backref" href="#id8">2</a>, <a class="fn-backref" href="#id9">3</a>, <a class="fn-backref" href="#id10">4</a>, <a class="fn-backref" href="#id11">5</a>, <a class="fn-backref" href="#id12">6</a>, <a class="fn-backref" href="#id13">7</a>)</em> Gaussian model for localized translational motion: Application to incoherent neutron scattering. 
Volino, F., Perrin, J. C. &amp; Lyonnard, S. J. Phys. Chem. B 110, 11217â11223 (2006).</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span>
<span class="n">ql</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mf">14.1</span><span class="p">:</span><span class="mf">1.3</span><span class="p">]</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">iqt3</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dL</span><span class="p">([</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">gaussDiffusion3D_w</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">u0</span><span class="o">=</span><span class="mf">0.34</span><span class="p">,</span><span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">ql</span><span class="p">])</span>
<span class="n">iqt2</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dL</span><span class="p">([</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">gaussDiffusion3D_w</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">u0</span><span class="o">=</span><span class="mf">0.34</span><span class="p">,</span><span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">ql</span><span class="p">])</span>
<span class="c1"># as ndim=1 is a wrong solution use this instead</span>
<span class="n">iqt1</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dL</span><span class="p">([</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">time2frequencyFF</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">diffusionHarmonicPotential</span><span class="p">,</span><span class="s1">&#39;elastic&#39;</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mf">0.01</span><span class="p">],</span><span class="n">dw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">rmsd</span><span class="o">=</span><span class="n">u0</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">t0</span> <span class="p">,</span><span class="n">ndim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">ql</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iqt2</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iqt3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.diffusionInSphere_w">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">diffusionInSphere_w</code><span class="sig-paren">(</span><em>w</em>, <em>q</em>, <em>D</em>, <em>R</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#diffusionInSphere_w"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.diffusionInSphere_w" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Diffusion inside of a sphere; dynamic structure factor in w domain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>w</strong> : array</p>
<blockquote>
<div><p>Frequencies in 1/ns</p>
</div></blockquote>
<p><strong>q</strong> : float</p>
<blockquote>
<div><p>Wavevector in nm**-1</p>
</div></blockquote>
<p><strong>D</strong> : float</p>
<blockquote>
<div><p>Diffusion coefficient in units nm**2/ns</p>
</div></blockquote>
<p><strong>R</strong> : float</p>
<blockquote>
<div><p>Radius of the sphere in units nm.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Here we use equ 33 in <a class="reference internal" href="#r45" id="id14">[R45]</a> with the first 99 solutions of equ 27 a+b as given in <a class="reference internal" href="#r45" id="id15">[R45]</a>.
This is valid for q*R&lt;20 with accuracy of ~0.001 as given in <a class="reference internal" href="#r45" id="id16">[R45]</a>.
If we look at a comparison with free diffusion the valid range seems to be smaller.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r45" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R45]</td><td><em>(<a class="fn-backref" href="#id14">1</a>, <a class="fn-backref" href="#id15">2</a>, <a class="fn-backref" href="#id16">3</a>, <a class="fn-backref" href="#id17">4</a>)</em> Neutron incoherent scattering law for diffusion in a potential of spherical symmetry:
general formalism and application to diffusion inside a sphere.
Volino, F. &amp; Dianoux, A. J.,  Mol. Phys. 41, 271â279 (1980).</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span>
<span class="n">ql</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mf">14.1</span><span class="p">:</span><span class="mf">1.3</span><span class="p">]</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">iqw</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dL</span><span class="p">([</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">diffusionInSphere_w</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">D</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">ql</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iqw</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare different kinds of diffusion in restricted geometry.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># compare the HWHM</span>
<span class="n">ql</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.5</span><span class="p">:</span><span class="mf">15.</span><span class="p">:</span><span class="mf">0.2</span><span class="p">]</span>
<span class="n">D</span><span class="o">=</span><span class="mf">0.1</span><span class="p">;</span><span class="n">R</span><span class="o">=</span><span class="mf">0.5</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">iqwS</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dL</span><span class="p">([</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">diffusionInSphere_w</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">ql</span><span class="p">])</span>
<span class="n">iqwD</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dL</span><span class="p">([</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">transDiff_w</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">ql</span><span class="p">[:]])</span>
<span class="n">u0</span><span class="o">=</span><span class="n">R</span><span class="o">/</span><span class="mf">4.33</span><span class="o">**</span><span class="mf">0.5</span><span class="p">;</span><span class="n">t0</span><span class="o">=</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">4.33</span><span class="o">/</span><span class="n">D</span>
<span class="n">iqwG3</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dL</span><span class="p">([</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">gaussDiffusion3D_w</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">u0</span><span class="o">=</span><span class="n">u0</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">ql</span><span class="p">])</span>
<span class="n">iqwG2</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dL</span><span class="p">([</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">gaussDiffusion2D_w</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">u0</span><span class="o">=</span><span class="n">u0</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">ql</span><span class="p">])</span>
<span class="n">p1</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">p1</span><span class="o">.</span><span class="n">subtitle</span><span class="p">(</span><span class="s1">&#39;Comparison of HWHM for different types of diffusion&#39;</span><span class="p">)</span>
<span class="n">p1</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">R</span><span class="o">*</span><span class="n">iqwD</span><span class="o">.</span><span class="n">wavevector</span><span class="o">.</span><span class="n">array</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,[</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">getHWHM</span><span class="p">(</span><span class="n">dat</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">dat</span> <span class="ow">in</span> <span class="n">iqwD</span><span class="p">],</span> <span class="n">le</span><span class="o">=</span><span class="s1">&#39;free diffusion&#39;</span><span class="p">)</span>
<span class="n">p1</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">R</span><span class="o">*</span><span class="n">iqwS</span><span class="o">.</span><span class="n">wavevector</span><span class="o">.</span><span class="n">array</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,[</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">getHWHM</span><span class="p">(</span><span class="n">dat</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">dat</span> <span class="ow">in</span> <span class="n">iqwS</span><span class="p">],</span> <span class="n">le</span><span class="o">=</span><span class="s1">&#39;diffusion in sphere&#39;</span><span class="p">)</span>
<span class="n">p1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">60</span><span class="p">],[</span><span class="mf">4.33296</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">li</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">p1</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">R</span><span class="o">*</span><span class="n">iqwG3</span><span class="o">.</span><span class="n">wavevector</span><span class="o">.</span><span class="n">array</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,[</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">getHWHM</span><span class="p">(</span><span class="n">dat</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">dat</span> <span class="ow">in</span> <span class="n">iqwG3</span><span class="p">],</span> <span class="n">le</span><span class="o">=</span><span class="s1">&#39;diffusion 3D Gauss&#39;</span><span class="p">)</span>
<span class="n">p1</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">R</span><span class="o">*</span><span class="n">iqwG2</span><span class="o">.</span><span class="n">wavevector</span><span class="o">.</span><span class="n">array</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,[</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">getHWHM</span><span class="p">(</span><span class="n">dat</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">dat</span> <span class="ow">in</span> <span class="n">iqwG2</span><span class="p">],</span> <span class="n">le</span><span class="o">=</span><span class="s1">&#39;diffusion 2D Gauss&#39;</span><span class="p">)</span>
<span class="n">r0</span><span class="o">=.</span><span class="mi">5</span><span class="p">;</span><span class="n">t0</span><span class="o">=</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">2.</span><span class="o">/</span><span class="n">D</span>
<span class="n">iqwJ</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dL</span><span class="p">([</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">jumpDiff_w</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">r0</span><span class="o">=</span><span class="n">r0</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">ql</span><span class="p">])</span>
<span class="n">ii</span><span class="o">=</span><span class="mi">54</span><span class="p">;</span><span class="n">p1</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">r0</span><span class="o">*</span><span class="n">iqwJ</span><span class="o">.</span><span class="n">wavevector</span><span class="o">.</span><span class="n">array</span><span class="p">[:</span><span class="n">ii</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">,[</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">getHWHM</span><span class="p">(</span><span class="n">dat</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">dat</span> <span class="ow">in</span> <span class="n">iqwJ</span><span class="p">[:</span><span class="n">ii</span><span class="p">]],</span> <span class="n">le</span><span class="o">=</span><span class="s1">&#39;jump diffusion&#39;</span><span class="p">)</span>
<span class="n">p1</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;HWHM/(D/R**2)&#39;</span><span class="p">)</span>
<span class="n">p1</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;(Q*R)\S2&#39;</span><span class="p">)</span>
<span class="n">p1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.diffusionPeriodicPotential">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">diffusionPeriodicPotential</code><span class="sig-paren">(</span><em>t</em>, <em>q</em>, <em>u</em>, <em>rt</em>, <em>Dg</em>, <em>gamma=1</em>, <em>NN=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#diffusionPeriodicPotential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.diffusionPeriodicPotential" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Fractional diffusion of a particle in a periodic potential.</p>
<p>The diffusion describes a fast dynamics inside of the potential trap with a mean square displacement
before a jump and a fractional long time diffusion. For fractional coefficient gamma=1 normal diffusion
is recovered.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : array</p>
<blockquote>
<div><p>Time points</p>
</div></blockquote>
<p><strong>q</strong> : float</p>
<blockquote>
<div><p>Wavevector</p>
</div></blockquote>
<p><strong>u</strong> : float</p>
<blockquote>
<div><p>Mean displacement in the trap</p>
</div></blockquote>
<p><strong>rt</strong> : float</p>
<blockquote>
<div><p>Relaxation time of fast dynamics in the trap (1/lambda in <a class="reference internal" href="#r46" id="id18">[R46]</a> )</p>
</div></blockquote>
<p><strong>gamma</strong> : float</p>
<blockquote>
<div><p>Fractional exponent gamma=1 is normal diffusion</p>
</div></blockquote>
<p><strong>Dg</strong> : float</p>
<blockquote>
<div><p>Long time fractional diffusion coefficient</p>
</div></blockquote>
<p><strong>NN</strong> : int, default 100</p>
<blockquote>
<div><p>Order for approximating Mittag Leffler function
sum([x**k/scipy.special.gamma(a*k+1) for k in range(NN)])
Test this for your needed time range. See Examples</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dataArray</strong> : .</p>
<blockquote class="last">
<div><p>[times, intermediate scattering function , intermediate scattering function only diffusional part]</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r46" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R46]</td><td><em>(<a class="fn-backref" href="#id18">1</a>, <a class="fn-backref" href="#id19">2</a>)</em> Gupta, S.; Biehl, R.; Sill, C.; Allgaier, J.; Sharp, M.; Ohl, M.; Richter, D.
Macromolecules 2016, 49 (5), 1941.</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">q</span><span class="o">=</span><span class="mf">0.5</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">f100</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">diffusionPeriodicPotential</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mf">0.036</span><span class="p">,</span><span class="n">NN</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">f30</span><span class="o">=</span>  <span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">diffusionPeriodicPotential</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mf">0.036</span><span class="p">,</span><span class="n">NN</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f100</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;NN=100&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f100</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;NN=30&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.doubleDiffusion">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">doubleDiffusion</code><span class="sig-paren">(</span><em>q</em>, <em>t</em>, <em>amplitude0</em>, <em>D0</em>, <em>amplitude1=0</em>, <em>D1=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#doubleDiffusion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.doubleDiffusion" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Two exponential decaying functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>q</strong> : float, array</p>
<blockquote>
<div><p>wavevector</p>
</div></blockquote>
<p><strong>t</strong> : float, array</p>
<blockquote>
<div><p>timelist</p>
</div></blockquote>
<p><strong>amplitude0,amplitude1</strong> : float</p>
<blockquote>
<div><p>prefactor</p>
</div></blockquote>
<p><strong>D0,D1</strong> : float</p>
<blockquote>
<div><p>diffusion coefficient in units [ [q]**-2/[t] ]</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.elastic_w">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">elastic_w</code><span class="sig-paren">(</span><em>w</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#elastic_w"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.elastic_w" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Elastic line; dynamic structure factor in w domain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>w</strong> : array</p>
<blockquote>
<div><p>Frequencies in 1/ns</p>
</div></blockquote>
<p><strong>w0</strong> : float</p>
<blockquote>
<div><p>Position of elastic line <img class="math" src="_images/math/c68075b2ebcb747ab35a4c307d68853f2151ffe9.png" alt="\delta(w=w0)=1"/></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.finiteRouse">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">finiteRouse</code><span class="sig-paren">(</span><em>t</em>, <em>q</em>, <em>NN=None</em>, <em>pmax=None</em>, <em>ll=None</em>, <em>frict=None</em>, <em>Dcm=None</em>, <em>Wl4=None</em>, <em>Dcmfkt=&lt;function &lt;lambda&gt;&gt;</em>, <em>tintern=0.0</em>, <em>Temp=293</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#finiteRouse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.finiteRouse" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Rouse dynamics of a finite chain with N beads of bonds length l and internal friction. Coherent scattering.</p>
<p>The Rouse model describes the conformational dynamics of an ideal chain.
The single chain diffusion is represented by Brownian motion of beads connected by harmonic springs.
no excluded volume, random thermal force, drag force with solvent and optional internal friction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : array</p>
<blockquote>
<div><p>time in nanoseconds</p>
</div></blockquote>
<p><strong>q</strong> : array</p>
<blockquote>
<div><p>scattering vector          nm^-1
if q is list a dataList is returned
otherwise a dataArray is returned</p>
</div></blockquote>
<p><strong>NN</strong> : integer</p>
<blockquote>
<div><p>number of chain beads</p>
</div></blockquote>
<p><strong>ll</strong> : float, default 1</p>
<blockquote>
<div><p>bond length between beads; unit nm</p>
</div></blockquote>
<p><strong>pmax</strong> : integer</p>
<blockquote>
<div><p>as integer =&gt; maximum mode number default  is NN
as list =&gt;list of amplitudes&gt;0 for individual modes
to allow weighting; not given modes have weigth zero</p>
</div></blockquote>
<p><strong>frict</strong> : float</p>
<blockquote>
<div><p>friction of a bead</p>
</div></blockquote>
<p><strong>Wl4</strong> : float</p>
<blockquote>
<div><p>needed to calc friction and Dcm</p>
</div></blockquote>
<p><strong>Dcm</strong> : float</p>
<blockquote>
<div><dl class="docutils">
<dt>Center of mass diffusion in nm^2/ns</dt>
<dd><ul class="first last simple">
<li>=kT/NN/f     with f =solvent friction</li>
<li>=Wl^4/(3*N*l^2)=Wl^4/(3* Re^2)</li>
</ul>
</dd>
</dl>
</div></blockquote>
<p><strong>Dcmfkt</strong> : function returning array</p>
<blockquote>
<div><p>function to modify Dcm as Dcm(q)=Dcm*Dcmfkt(q)
eg for inclusion of structure factor Dcmfkt=lambda q:1/S(q)</p>
</div></blockquote>
<p><strong>tintern</strong> : float&gt;0</p>
<blockquote>
<div><p>relaxation time due to internal friction  in ns</p>
</div></blockquote>
<p><strong>Temp</strong> : float</p>
<blockquote>
<div><p>temperature  Kelvin = 273+T[Â°C]</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>Additional Attributes</dt>
<dd><ul class="first last simple">
<li>Wl4</li>
<li>Re  end to end distance Re^2=l^2*N</li>
<li>tr1 is rotational corrleation time or rouse time tr1 = f*NN^2*ll^2/(3 pi^2*kb*T)= &lt;Re^2&gt;/(3*pi*Dcm)</li>
<li>tintern relaxation time due to internal friction</li>
<li>t_p characteristic times   t_p=tr1*p^2+tintern</li>
</ul>
</dd>
<dt>From above the triple Dcm,ll,NN are fixed.</dt>
<dd><ul class="first last simple">
<li>If 2 are given 3rd is calculated</li>
<li>If all 3 are given the given values are used</li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r47" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id20">[R47]</a></td><td>Doi Edwards Theory of Polymer dynamics
in the appendix the equation is found</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r48" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id21">[R48]</a></td><td>Nonflexible Coils in Solution: A Neutron Spin-Echo Investigation of
Alkyl-Substituted Polynorbonenes in Tetrahydrofuran
Michael Monkenbusch et al Macromolecules 2006, 39, 9473-9479
The exponential is missing a âtâ
<a class="reference external" href="http://dx.doi.org/10.1021/ma0618979">http://dx.doi.org/10.1021/ma0618979</a></td></tr>
</tbody>
</table>
<p>about internal friction</p>
<table class="docutils citation" frame="void" id="r49" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id22">[R49]</a></td><td>Exploring the role of internal friction in the dynamics of unfolded proteins using simple polymer models
Cheng et al JOURNAL OF CHEMICAL PHYSICS 138, 074112 (2013)  <a class="reference external" href="http://dx.doi.org/10.1063/1.4792206">http://dx.doi.org/10.1063/1.4792206</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r50" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id23">[R50]</a></td><td>Rouse Model with Internal Friction: A Coarse Grained Framework for Single Biopolymer Dynamics
Khatri, McLeish|  Macromolecules 2007, 40, 6770-6777  <a class="reference external" href="http://dx.doi.org/10.1021/ma071175x">http://dx.doi.org/10.1021/ma071175x</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.finiteZimm">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">finiteZimm</code><span class="sig-paren">(</span><em>t</em>, <em>q</em>, <em>NN=None</em>, <em>pmax=None</em>, <em>ll=None</em>, <em>Dcm=None</em>, <em>Dcmfkt=&lt;function &lt;lambda&gt;&gt;</em>, <em>tintern=0.0</em>, <em>mu=0.5</em>, <em>viscosity=1.0</em>, <em>Temp=293</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#finiteZimm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.finiteZimm" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Zimm dynamics with internal friction of a finite chain with N beads of bonds length l. Coherent scattering.</p>
<p>The Zimm model describes the conformational dynamics of an ideal chain with hydrodynamic interaction between beads.
The single chain diffusion is represented by Brownian motion of beads connected by harmonic springs.
no excluded volume, random thermal force, drag force with solvent, hydrodynamics between beads
and optional internal friction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : array</p>
<blockquote>
<div><p>Time in nanoseconds</p>
</div></blockquote>
<p><strong>q: float, array</strong></p>
<blockquote>
<div><p>Scattering vector  in nm^-1
If q is list a dataList is returned  otherwise a dataArray is returned</p>
</div></blockquote>
<p><strong>NN</strong> : integer</p>
<blockquote>
<div><p>Number of chain beads</p>
</div></blockquote>
<p><strong>ll</strong> : float, default 1</p>
<blockquote>
<div><p>Bond length between beads; units nm</p>
</div></blockquote>
<p><strong>pmax</strong> : integer, default is NN</p>
<blockquote>
<div><ul class="simple">
<li>integer =&gt; maximum mode number</li>
<li>list    =&gt; list of amplitudes&gt;0 for individual modes
to allow weighing; not given modes have weigth zero</li>
</ul>
</div></blockquote>
<p><strong>Dcm</strong> : float</p>
<blockquote>
<div><dl class="docutils">
<dt>Center of mass diffusion in nm^2/ns</dt>
<dd><ul class="first last simple">
<li>0.196 kb T/(Re*viscosity)  theta solvent with mu=0.6</li>
<li>0.203 kb T/(Re*viscosity)  good solvent  with mu=0.5</li>
</ul>
</dd>
</dl>
</div></blockquote>
<p><strong>Dcmfkt</strong> : function returning array</p>
<blockquote>
<div><p>Function to modify Dcm as Dcm(q)=Dcm*Dcmfkt(q) e.g. for inclusion of structure factor Dcmfkt=lambda q:1/S(q)</p>
</div></blockquote>
<p><strong>tintern</strong> : float&gt;0</p>
<blockquote>
<div><p>Additional relaxation time due to internal friction
(if a tuple as (0,1,1,1,) the mode p will get tintern[p])
Automatically extended to length pmax</p>
</div></blockquote>
<p><strong>mu</strong> : float in range [0.5,0.6]</p>
<blockquote>
<div><p>varies between good solvent 0.6 and theta solvent 0.5 (gaussian chain)</p>
</div></blockquote>
<p><strong>viscosity</strong> : float</p>
<blockquote>
<div><p>cPoise=mPa*s  as water 20+273.15 K =1 mPa*s</p>
</div></blockquote>
<p><strong>Temp</strong> : float</p>
<blockquote>
<div><p>temperatur  Kelvin = 273+20</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dataArray</strong> : for single q</p>
<blockquote class="last">
<div><blockquote>
<div><ul class="simple">
<li>[wavevector q , Iqt_diff+modes, Iqt_diffusion]</li>
<li>dataArray.modecontribution of modes i in sequence</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>dataList <span class="classifier-delimiter">:</span> <span class="classifier">multiple q</span></dt>
<dd><ul class="first last simple">
<li>datalist with dataArrays as for single q as above</li>
</ul>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>Additional attributes defined:</dt>
<dd><ul class="first last simple">
<li>Re   end to end distance  Re^2=l^2*N^2mu</li>
<li>tz1  rotational corrleation time tz1 = visc*Re^3/(sqrt(3 pi)kb*T)</li>
<li>t_p  characteristic times t_p=tz1*p^-3mu+tintern</li>
<li>modecontribution is modecontribution as in PRL 71, 4158 equ (3)</li>
</ul>
</dd>
<dt>From above the triple Dcm,ll,NN are fixed.</dt>
<dd><ul class="first last simple">
<li>If 2 are given 3rd is calculated</li>
<li>If all 3 are given the given values are used</li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r51" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id24">[R51]</a></td><td>Doi Edwards Theory of Polymer dynamics
in appendix the equation is found</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r52" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id25">[R52]</a></td><td>Nonflexible Coils in Solution: A Neutron Spin-Echo Investigation of
Alkyl-Substituted Polynorbonenes in Tetrahydrofuran
Michael Monkenbusch et al Macromolecules 2006, 39, 9473-9479
The exponential is missing a âtâ
<a class="reference external" href="http://dx.doi.org/10.1021/ma0618979">http://dx.doi.org/10.1021/ma0618979</a></td></tr>
</tbody>
</table>
<p>about internal friction</p>
<table class="docutils citation" frame="void" id="r53" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id26">[R53]</a></td><td>Exploring the role of internal friction in the dynamics of unfolded proteins using simple polymer models
Cheng et al JOURNAL OF CHEMICAL PHYSICS 138, 074112 (2013)  <a class="reference external" href="http://dx.doi.org/10.1063/1.4792206">http://dx.doi.org/10.1063/1.4792206</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r54" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id27">[R54]</a></td><td>Rouse Model with Internal Friction: A Coarse Grained Framework for Single Biopolymer Dynamics
Khatri, McLeish|  Macromolecules 2007, 40, 6770-6777  <a class="reference external" href="http://dx.doi.org/10.1021/ma071175x">http://dx.doi.org/10.1021/ma071175x</a></td></tr>
</tbody>
</table>
<p>mode contribution factors from</p>
<table class="docutils citation" frame="void" id="r55" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id28">[R55]</a></td><td>Onset of Topological Constraints in Polymer Melts: A Mode Analysis by Neutron Spin Echo Spectroscopy
D. Richter et al PRL 71,4158-4161 (1993)</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.getHWHM">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">getHWHM</code><span class="sig-paren">(</span><em>data</em>, <em>center=0</em>, <em>gap=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#getHWHM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.getHWHM" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Find half width at half maximum of a distribution around zero.</p>
<p>The hwhm is determined from cubicspline between Y values to find Y.max/2.
Requirement Y.max/2&gt;Y.min and increasing X values.
If nothing is found an empty list is returned</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : dataArray</p>
<blockquote>
<div><p>Distribution</p>
</div></blockquote>
<p><strong>center: float, default=0</strong></p>
<blockquote>
<div><p>Center (symmetry point) of data.
If None the position of the maximum is used.</p>
</div></blockquote>
<p><strong>gap</strong> : float, default 0</p>
<blockquote>
<div><p>Exclude values around center as it may contain a singularity.
Excludes values within X&lt;= abs(center-gap).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of float with hwhm X&gt;0 , X&lt;0 if existing</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="data">
<dt id="jscatter.dynamic.h">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">h</code><em class="property"> = 4135.667662340164</em><a class="headerlink" href="#jscatter.dynamic.h" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Planck constant in meV/ns</p>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.integralZimm">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">integralZimm</code><span class="sig-paren">(</span><em>t</em>, <em>q</em>, <em>Temp=293</em>, <em>viscosity=0.001</em>, <em>amp=1</em>, <em>rtol=0.02</em>, <em>tol=0.02</em>, <em>limit=50</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#integralZimm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.integralZimm" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Conformational dynamics of an ideal chain with hydrodynamic interaction Integral version Zimm dynamics. Coherent scattering.</p>
<p>The Zimm model describes the conformational dynamics of an ideal chain with hydrodynamic
interaction between beads. See <a class="reference internal" href="#r56" id="id29">[R56]</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : array</p>
<blockquote>
<div><p>Time points in ns</p>
</div></blockquote>
<p><strong>q</strong> : float</p>
<blockquote>
<div><p>Wavevector in 1/nm</p>
</div></blockquote>
<p><strong>Temp</strong> : float</p>
<blockquote>
<div><p>Temperature in K</p>
</div></blockquote>
<p><strong>viscosity</strong> : float</p>
<blockquote>
<div><p>Viscosity in cP=mPa*s</p>
</div></blockquote>
<p><strong>amp</strong> : float</p>
<blockquote>
<div><p>Amplitude</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r56" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R56]</td><td><em>(<a class="fn-backref" href="#id29">1</a>, <a class="fn-backref" href="#id30">2</a>)</em> Neutron Spin Echo Investigations on the Segmental Dynamics of Polymers in Melts, Networks and Solutions
in Neutron Spin Echo Spectroscopy Viscoelasticity Rheology
Volume 134 of the series Advances in Polymer Science pp 1-129
DOI 10.1007/3-540-68449-2_1</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mf">0.2</span><span class="p">]</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.26</span><span class="p">,</span><span class="mf">0.40</span><span class="p">,</span><span class="mf">0.53</span><span class="p">,</span><span class="mf">0.79</span><span class="p">,</span><span class="mf">1.06</span><span class="p">]:</span>
   <span class="n">iqt</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">integralZimm</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">viscosity</span><span class="o">=</span><span class="mf">0.2e-3</span><span class="p">)</span>
   <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iqt</span><span class="p">)</span>
   <span class="c1">#p.plot((iqt.X*iqt.q**3)**(2/3.),iqt.Y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.jumpDiff_w">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">jumpDiff_w</code><span class="sig-paren">(</span><em>w</em>, <em>q</em>, <em>t0</em>, <em>r0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#jumpDiff_w"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.jumpDiff_w" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Jump diffusion; dynamic structure factor in w domain.</p>
<p>Jump diffusion as a markovian random walk. Jump length distribution is a Gaussian
with width r0 and jump rate distribution with width G (Poisson).
Diffusion coefficient D=r0**2/2t0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>w</strong> : array</p>
<blockquote>
<div><p>Frequencies in 1/ns</p>
</div></blockquote>
<p><strong>q</strong> : float</p>
<blockquote>
<div><p>Wavevector in nm**-1</p>
</div></blockquote>
<p><strong>t0</strong> : float</p>
<blockquote>
<div><p>Mean residence time in a Poisson distribution of jump times. In units ns.
G = 1/tg = Mean jump rate</p>
</div></blockquote>
<p><strong>r0</strong> : float</p>
<blockquote>
<div><p>Root mean square jump length in 3 dimensions &lt;r**2&gt; = 3*r_0**2</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r57" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id31">[R57]</a></td><td>Incoherent neutron scattering functions for random jump diffusion in bounded and infinite media.
Hall, P. L. &amp; Ross, D. K. Mol. Phys. 42, 637â682 (1981).</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.jumpDiffusion">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">jumpDiffusion</code><span class="sig-paren">(</span><em>t</em>, <em>Q</em>, <em>t0</em>, <em>l0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#jumpDiffusion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.jumpDiffusion" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Incoherent intermediate scattering function of translational jump diffusion in the time domain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : array</p>
<blockquote>
<div><p>list of times, units ns</p>
</div></blockquote>
<p><strong>Q</strong> : float</p>
<blockquote>
<div><p>wavevector, units nm</p>
</div></blockquote>
<p><strong>t0</strong> : float</p>
<blockquote>
<div><p>residence time, units ns</p>
</div></blockquote>
<p><strong>l0</strong> : float</p>
<blockquote>
<div><p>mean square jump length, units nm</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r58" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id32">[R58]</a></td><td>Experimental determination of the nature of diffusive motions of water molecules at low temperatures
J. Teixeira, M.-C. Bellissent-Funel, S. H. Chen, and A. J. Dianoux
Phys. Rev. A 31, 1913 â Published 1 March 1985</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.methylRotation">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">methylRotation</code><span class="sig-paren">(</span><em>t</em>, <em>q</em>, <em>t0=0.001</em>, <em>rhh=0.12</em>, <em>beta=0.8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#methylRotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.methylRotation" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Incoherent intermediate scattering function of CH3 methyl rotation in the time domain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : array</p>
<blockquote>
<div><p>List of times, units ns</p>
</div></blockquote>
<p><strong>q</strong> : float</p>
<blockquote>
<div><p>Wavevector, units nm</p>
</div></blockquote>
<p><strong>t0</strong> : float, default 0.001</p>
<blockquote>
<div><p>Residence time, units ns</p>
</div></blockquote>
<p><strong>rhh</strong> : float, default=0.12</p>
<blockquote>
<div><p>Mean square jump length, units nm</p>
</div></blockquote>
<p><strong>beta</strong> : float, default 0.8</p>
<blockquote>
<div><p>exponent</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>According to <a class="reference internal" href="#r59" id="id33">[R59]</a>:</p>
<div class="math">
<p><img src="_images/math/04db1cd9d8d09365d8e01729b26737150301b6bc.png" alt="I(q,t) = (EISF + (1-EISF) e^{-(\frac{t}{t_0})^{\beta}} )"/></p>
</div><div class="math">
<p><img src="_images/math/3ad215e5a3e53d190adec00b415c266db7a000c9.png" alt="EISF=\frac{1}{3}+\frac{2}{3}\frac{sin(qr_{HH})}{qr_{HH}}"/></p>
</div><p>with
<img class="math" src="_images/math/1410bd3aa3d34373bc7de52c132b4fd6f154019a.png" alt="t_0"/> residence time,
<img class="math" src="_images/math/4cc154ae98eee2decc1f37ad095ff6f402a34731.png" alt="r_{HH}"/> proton jump distance.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r59" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R59]</td><td><em>(<a class="fn-backref" href="#id33">1</a>, <a class="fn-backref" href="#id34">2</a>)</em> <ol class="last upperalpha simple" start="13">
<li>BÃ©e, Quasielastic Neutron Scattering (Adam Hilger, 1988).</li>
</ol>
</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>import jscatter as js
import numpy as np
# make a plot of the spectrum
w=np.r_[-100:100]
ql=np.r_[1:15:1]
iqwCH3=js.dL([js.dynamic.time2frequencyFF(js.dynamic.methylRotation,âelasticâ,w=np.r_[-100:100:0.1],dw=0,q=q ) for q in ql])
p=js.grace()
p.plot(iqwCH3,le=âCH3â)
p.yaxis(min=1e-5,max=10,scale=âlâ)</p>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.nSiteJumpDiffusion_w">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">nSiteJumpDiffusion_w</code><span class="sig-paren">(</span><em>w</em>, <em>q</em>, <em>N</em>, <em>t0</em>, <em>r0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#nSiteJumpDiffusion_w"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.nSiteJumpDiffusion_w" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Random walk among N equidistant sites (isotropic averaged); dynamic structure factor in w domain.</p>
<p>E.g. for CH3 group rotational jump diffusion over 3 sites.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>w</strong> : array</p>
<blockquote>
<div><p>Frequencies in 1/ns</p>
</div></blockquote>
<p><strong>q: float</strong></p>
<blockquote>
<div><p>Wavevector in units 1/nm</p>
</div></blockquote>
<p><strong>N</strong> : int</p>
<blockquote>
<div><p>Number of jump sites, jump angle 2pi/N</p>
</div></blockquote>
<p><strong>r0</strong> : float</p>
<blockquote>
<div><p>Distance of sites from center of rotation.
For CH3 eg 0.12 nm.</p>
</div></blockquote>
<p><strong>t0</strong> : float</p>
<blockquote>
<div><p>Rotational correlation time.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r60" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id35">[R60]</a></td><td>Incoherent scattering law for neutron quasi-elastic scattering in liquid crystals.
Dianoux, A., Volino, F. &amp; Hervet, H., Mol. Phys. 30, 37â41 (1975).</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span>
<span class="n">ql</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mf">14.1</span><span class="p">:</span><span class="mf">1.3</span><span class="p">]</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">iqw</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dL</span><span class="p">([</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">nSiteJumpDiffusion_w</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span><span class="n">r0</span><span class="o">=</span><span class="mf">0.12</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">ql</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iqw</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.resolution">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">resolution</code><span class="sig-paren">(</span><em>t</em>, <em>s0=1</em>, <em>m0=0</em>, <em>s1=None</em>, <em>m1=None</em>, <em>s2=None</em>, <em>m2=None</em>, <em>s3=None</em>, <em>m3=None</em>, <em>s4=None</em>, <em>m4=None</em>, <em>s5=None</em>, <em>m5=None</em>, <em>a0=1</em>, <em>a1=1</em>, <em>a2=1</em>, <em>a3=1</em>, <em>a4=1</em>, <em>a5=1</em>, <em>bgr=0</em>, <em>resolution_w=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#resolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.resolution" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Resolution in time domain as multiple Gaussians for inelastic measurement as backscattering or time of flight instruement.</p>
<p>Multiple Gaussians define the function to describe a resolution measurement.
Use resolution_w to fit with the appropriate normalized Gaussians.
See Notes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : array</p>
<blockquote>
<div><p>Times</p>
</div></blockquote>
<p><strong>s0,s1,â¦</strong> : float</p>
<blockquote>
<div><p>Width of Gaussian functions representing a resolution measurement.
The number of si not None determines the number of Gaussians.</p>
</div></blockquote>
<p><strong>m0, m1,â¦.</strong> : float, None</p>
<blockquote>
<div><p>Means of the Gaussian functions representing a resolution measurement.</p>
</div></blockquote>
<p><strong>a0, a1,â¦.</strong> : float, None</p>
<blockquote>
<div><p>Amplitudes of the Gaussian functions representing a resolution measurement.</p>
</div></blockquote>
<p><strong>bgr</strong> : float, default=0</p>
<blockquote>
<div><p>Background</p>
</div></blockquote>
<p><strong>resolution_w</strong> : dataArray</p>
<blockquote>
<div><p>Resolution in w domain with attributes sigmas, amps which are used instead of si, ai.
This represents the Fourier transform of multi gauss resolution from w to t domain.
The m0..m5 are NOT used as these result only in a phase shift.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>In a typical inelastic experiment the resolution is measured by e.g. a vanadium meausrement (elastic scatterer).
This is described in w domain by a multi Gaussian function as in resw=resolution_w(w,â¦) with
amplitudes ai_w, width si_w and common mean m_w.
resolution(t,resolution_w=resw) defines the Fourier transform of resolution_w using the same coefficients.
mi_t are set by default to zero as mi_w lead only to a phase shift. It is easiest to shift w values in w domain as it
corresponds to a shift of the elastic line.</p>
<p>The used Gaussians are normalized that they are a pair of Fourier transforms:</p>
<div class="math">
<p><img src="_images/math/d31267c38969f9f5b34b6defce40ee6c5624d395.png" alt="R_t(t,m_i,s_i,a_i)=\sum_i a_i s_i e^{-\frac{1}{2}s_i^2 t^2} \Leftrightarrow  R_w(w,m_i,s_i,a_i)=\sum_i a_i e^{-\frac{1}{2}(\frac{w-m_i}{s_i})^2}"/></p>
</div><p>under the Fourier transform defined as</p>
<div class="math">
<p><img src="_images/math/5dbae25c839ce47078e8556ce1aa3564cc55c5e0.png" alt="F(f(t)) =  \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty} f(t) e^{-i\omega t} dt"/></p>
</div><div class="math">
<p><img src="_images/math/3ca9cc185d2d29386f0c20d173f330c18612922e.png" alt="F(f(w)) =  \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty} f(\omega) e^{i\omega t} d\omega"/></p>
</div><p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="n">resw</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">resolution_w</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">s0</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">m0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a0</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># resolution in w domain</span>
<span class="c1"># representing the fouriertransform of resw as a gaussian transfoms to ag gaussian</span>
<span class="n">rest</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">resolution</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">resolution</span><span class="o">=</span><span class="n">resw</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.resolution_w">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">resolution_w</code><span class="sig-paren">(</span><em>w</em>, <em>s0=1</em>, <em>m0=0</em>, <em>s1=None</em>, <em>m1=None</em>, <em>s2=None</em>, <em>m2=None</em>, <em>s3=None</em>, <em>m3=None</em>, <em>s4=None</em>, <em>m4=None</em>, <em>s5=None</em>, <em>m5=None</em>, <em>a0=1</em>, <em>a1=1</em>, <em>a2=1</em>, <em>a3=1</em>, <em>a4=1</em>, <em>a5=1</em>, <em>bgr=0</em>, <em>resolution=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#resolution_w"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.resolution_w" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Resolution as multiple Gaussians for inelastic measurement as backscattering or time of flight instruement in w domain.</p>
<p>Multiple Gaussians define the function to describe a resolution measurement.
Use only a common mi to account for a shift.
See resolution for transform to time domain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>w</strong> : array</p>
<blockquote>
<div><p>Frequencies</p>
</div></blockquote>
<p><strong>s0,s1,â¦</strong> : float</p>
<blockquote>
<div><p>Sigmas of several Gaussian functions representing a resolution measurement.
The number of si not none determines the number of Gaussians.</p>
</div></blockquote>
<p><strong>m0, m1,â¦.</strong> : float, None</p>
<blockquote>
<div><p>Means of the Gaussian functions representing a resolution measurement.</p>
</div></blockquote>
<p><strong>a0, a1,â¦.</strong> : float, None</p>
<blockquote>
<div><p>Amplitudes of the Gaussian functions representing a resolution measurement.</p>
</div></blockquote>
<p><strong>bgr</strong> : float, default=0</p>
<blockquote>
<div><p>Background</p>
</div></blockquote>
<p><strong>resolution</strong> : dataArray</p>
<blockquote>
<div><p>Resolution in t space with attributes means, sigmas, amps which are used instead of si, mi, ai.
This represents the fourier transform of multi gauss resolution from t to w space.
The mi are used as mi from resolution_w result in a phase shift.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dataArray</p>
<blockquote class="last">
<div><p>.means
.amps
.sigmas</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>In a typical inelastic experiment the resolution is measured by e.g. a vanadium meausrement (elastic scatterer).
This is described in w domain by a multi Gaussian function as in resw=resolution_w(w,â¦) with
amplitudes ai_w, width si_w and common mean m_w.
resolution(t,resolution_w=resw) defines the Fourier transform of resolution_w using the same coefficients.
mi_t are set by default to zero as mi_w lead only to a phase shift. It is easiest to shift w values in w domain as it
corresponds to a shift of the elastic line.</p>
<p>The used Gaussians are normalized that they are a pair of Fourier transforms:</p>
<div class="math">
<p><img src="_images/math/d31267c38969f9f5b34b6defce40ee6c5624d395.png" alt="R_t(t,m_i,s_i,a_i)=\sum_i a_i s_i e^{-\frac{1}{2}s_i^2 t^2} \Leftrightarrow  R_w(w,m_i,s_i,a_i)=\sum_i a_i e^{-\frac{1}{2}(\frac{w-m_i}{s_i})^2}"/></p>
</div><p>under the Fourier transform  defined as</p>
<div class="math">
<p><img src="_images/math/5dbae25c839ce47078e8556ce1aa3564cc55c5e0.png" alt="F(f(t)) =  \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty} f(t) e^{-i\omega t} dt"/></p>
</div><div class="math">
<p><img src="_images/math/3ca9cc185d2d29386f0c20d173f330c18612922e.png" alt="F(f(w)) =  \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty} f(\omega) e^{i\omega t} d\omega"/></p>
</div><p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="c1"># read data</span>
<span class="n">vana</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dL</span><span class="p">(</span><span class="s1">&#39;vana_0p2mm.scat&#39;</span><span class="p">)</span> <span class="c1"># use your files here</span>
<span class="n">start</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s0&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span><span class="s1">&#39;m0&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;a0&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;bgr&#39;</span><span class="p">:</span><span class="mf">0.0073</span><span class="p">}</span>
<span class="n">dm</span><span class="o">=</span><span class="mi">5</span>
<span class="n">vana</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">setlimit</span><span class="p">(</span><span class="n">m0</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">dm</span><span class="p">,</span><span class="n">dm</span><span class="p">],</span><span class="n">m1</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">dm</span><span class="p">,</span><span class="n">dm</span><span class="p">],</span><span class="n">m2</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">dm</span><span class="p">,</span><span class="n">dm</span><span class="p">],</span><span class="n">m3</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">dm</span><span class="p">,</span><span class="n">dm</span><span class="p">],</span><span class="n">m4</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">dm</span><span class="p">,</span><span class="n">dm</span><span class="p">],</span><span class="n">m5</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">dm</span><span class="p">,</span><span class="n">dm</span><span class="p">])</span>
<span class="n">vana</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">resolution_w</span><span class="p">,</span><span class="n">start</span><span class="p">,{},{</span><span class="s1">&#39;w&#39;</span><span class="p">:</span><span class="s1">&#39;X&#39;</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.rotDiffusion_w">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">rotDiffusion_w</code><span class="sig-paren">(</span><em>w</em>, <em>q</em>, <em>cloud</em>, <em>Dr</em>, <em>lmax='auto'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#rotDiffusion_w"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.rotDiffusion_w" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Rotational diffusion of an object (dummy atoms); dynamic structure factor in w domain.</p>
<p>A cloud of dummy atoms can be used for coarse graining of a nonspherical object e.g. for amino acids in proteins.
On the other hand its just a way to integrate over an object e.g. a sphere or ellipsoid.
We use <a class="reference internal" href="#id39" id="id36">[R62]</a> for an objekt of arbitrary shape modified for incoherent scattering.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>w</strong> : array</p>
<blockquote>
<div><p>Frequencies in 1/ns</p>
</div></blockquote>
<p><strong>q</strong> : float</p>
<blockquote>
<div><p>Wavevector in units 1/nm</p>
</div></blockquote>
<p><strong>cloud</strong> : array Nx3 or Nx4 or float</p>
<blockquote>
<div><ul class="simple">
<li>A cloud of N dummy atoms with positions cloud[:3] that describe an object.</li>
<li>If given, cloud[3] is the incoherent scattering length <img class="math" src="_images/math/bc6f6c2a652ff58494377d447712644792dbb6da.png" alt="b_{inc}"/>.</li>
<li>If cloud[3] not given <img class="math" src="_images/math/c2fd932620ec6e7636d8bacffc65da8c28bfd412.png" alt="b_{inc}=1/N"/> that <img class="math" src="_images/math/189cb6b6018fba42f98267af54c0161d9263a475.png" alt="\sum_{1..N}b_{inc,N}=1"/>.</li>
<li>If cloud is single float the value is used as radius of a sphere with 10x10x10 grid.</li>
</ul>
</div></blockquote>
<p><strong>Dr</strong> : float</p>
<blockquote>
<div><p>Rotational diffusion constant in units 1/ns.</p>
</div></blockquote>
<p><strong>lmax</strong> : int</p>
<blockquote>
<div><p>Maximum order of spherical bessel function.
âautoâ -&gt; lmax &gt; pi*r.max()*q/6.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r61" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id37">[R61]</a></td><td>Incoherent scattering law for neutron quasi-elastic scattering in liquid crystals.
Dianoux, A., Volino, F. &amp; Hervet, H. Mol. Phys. 30, 37â41 (1975).</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r62" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R62]</td><td>Effect of rotational diffusion on quasielastic light scattering from fractal colloid aggregates.
Lindsay, H., Klein, R., Weitz, D., Lin, M. &amp; Meakin, P. Phys. Rev. A 38, 2614â2626 (1988).</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">R</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">NN</span><span class="o">=</span><span class="mi">5</span>
<span class="n">grid</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="n">R</span><span class="p">:</span><span class="n">R</span><span class="p">:</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">NN</span><span class="p">,</span> <span class="o">-</span><span class="n">R</span><span class="p">:</span><span class="n">R</span><span class="p">:</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">NN</span><span class="p">,</span><span class="o">-</span><span class="n">R</span><span class="p">:</span><span class="n">R</span><span class="p">:</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">NN</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="c1"># points inside of sphere with radius R</span>
<span class="n">p2</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="mi">2</span> <span class="c1"># p defines a superball with 1-&gt;sphere p=inf cuboid ....</span>
<span class="n">inside</span><span class="o">=</span><span class="k">lambda</span> <span class="n">xyz</span><span class="p">,</span><span class="n">R</span><span class="p">:(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xyz</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">R</span><span class="p">)</span><span class="o">**</span><span class="n">p2</span><span class="o">+</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xyz</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">R</span><span class="p">)</span><span class="o">**</span><span class="n">p2</span><span class="o">+</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xyz</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="n">R</span><span class="p">)</span><span class="o">**</span><span class="n">p2</span><span class="o">&lt;=</span><span class="mi">1</span>
<span class="n">insidegrid</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="n">inside</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="n">R</span><span class="p">)]</span>
<span class="n">Drot</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">formel</span><span class="o">.</span><span class="n">Drot</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="n">ql</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.5</span><span class="p">:</span><span class="mf">15.</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mf">0.1</span><span class="p">]</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">iqwR</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dL</span><span class="p">([</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">rotDiffusion_w</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">insidegrid</span><span class="p">,</span><span class="n">Drot</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">ql</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iqwR</span><span class="p">,</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;NN=</span><span class="si">%.1g</span><span class="s1"> q=$wavevector nm\S-1&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">NN</span><span class="p">))</span>
<span class="n">iqwR</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dL</span><span class="p">([</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">rotDiffusion_w</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">Drot</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">ql</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iqwR</span><span class="p">,</span><span class="n">li</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;NN=10 $wavevector nm\S-1&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mf">0.001</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.shiftAndBinning">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">shiftAndBinning</code><span class="sig-paren">(</span><em>data</em>, <em>w=None</em>, <em>dw=None</em>, <em>w0=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#shiftAndBinning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.shiftAndBinning" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Shift spectrum and average (binning) in intervals.</p>
<p>The intention is to shift spectra and average over intervalls.
It should be used after convolution with the instrument resolution, when singular values
at zero are smeared by resolution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : dataArray</p>
<blockquote>
<div><p>Data (from model) to be shifted and averaged in intervals to meet experimental data.</p>
</div></blockquote>
<p><strong>w</strong> : array</p>
<blockquote>
<div><p>New X values (e.g. from experiment). If w is None data.X values are used.</p>
</div></blockquote>
<p><strong>w0</strong> : float</p>
<blockquote>
<div><p>Shift by w0 that wnew=wold+w0</p>
</div></blockquote>
<p><strong>dw</strong> : float, default None</p>
<blockquote>
<div><p>Average over intervals between [w[i]-dw,w[i]+dw] to average over a detector pixel width.
If None dw is half the interval to neighbouring points.
If 0 the value is only linear interpolated to w values and not averaged (about 10 times faster).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For averaging over intervals scipy.interpolate.CubicSpline is used with integration in the intervals.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mf">0.5</span><span class="p">]</span>
<span class="n">start</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s0&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;m0&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;a0&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;s1&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;m1&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;a1&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;bgr&#39;</span><span class="p">:</span><span class="mf">0.00</span><span class="p">}</span>
<span class="n">resolution</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">resolution_w</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="o">**</span><span class="n">start</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">shiftAndBinning</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span><span class="n">w0</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">dw</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.simpleDiffusion">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">simpleDiffusion</code><span class="sig-paren">(</span><em>q</em>, <em>t</em>, <em>D</em>, <em>amplitude=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#simpleDiffusion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.simpleDiffusion" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Intermediate scattering function for diffusing particles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>q</strong> : float, array</p>
<blockquote>
<div><p>wavevector</p>
</div></blockquote>
<p><strong>t</strong> : float, array</p>
<blockquote>
<div><p>times</p>
</div></blockquote>
<p><strong>amplitude</strong> : float</p>
<blockquote>
<div><p>prefactor</p>
</div></blockquote>
<p><strong>D</strong> : float</p>
<blockquote>
<div><p>diffusion coefficient in units [ [q]**-2/[t] ]</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="math">
<p><img src="_images/math/50025b54d697490d21f95814dabcca4e4c6161f0.png" alt="I(q,t)=Ae^{-q^2Dt}"/></p>
</div></dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.stretchedExp">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">stretchedExp</code><span class="sig-paren">(</span><em>t</em>, <em>gamma</em>, <em>beta</em>, <em>amp=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#stretchedExp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.stretchedExp" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Stretched exponential function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : array</p>
<blockquote>
<div><p>times</p>
</div></blockquote>
<p><strong>gamma</strong> : float</p>
<blockquote>
<div><p>relaxation rate in units 1/[unit t]</p>
</div></blockquote>
<p><strong>beta</strong> : float</p>
<blockquote>
<div><p>stretched exponent</p>
</div></blockquote>
<p><strong>amp</strong> : float default 1</p>
<blockquote>
<div><p>amplitude</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.t2fFF">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">t2fFF</code><span class="sig-paren">(</span><em>timemodel</em>, <em>resolution</em>, <em>w=None</em>, <em>tfactor=7</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#jscatter.dynamic.t2fFF" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Fast Fourier transform from time domain to frequency domain for inelastic neutron scattering.</p>
<p>Shortcut t2fFF calls this function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>timemodel</strong> : function, None</p>
<blockquote>
<div><p>Model for I(q,t) in time domain. t in units of ns.
If None a constant function equal one is used like elastic scattering to fit resolution measurement.</p>
</div></blockquote>
<p><strong>resolution</strong> : dataArray</p>
<blockquote>
<div><p>dataArray that describes the resolution function from a fit with resolution_w or parametrized.
A nonzero bgr in resolution is ignored and needs to be added afterwards.
Resolution width are in the range of 6 1/ns (IN5 TOF) or 1 1/ns (Spheres BS).</p>
</div></blockquote>
<p><strong>w</strong> : array</p>
<blockquote>
<div><p>Frequencies for the result, e.g. from experimental data.
If w is None the frequencies w of the resolution are used.
This allows to use the fit of a resolution to be used with same w values.</p>
</div></blockquote>
<p><strong>kwargs</strong> : keyword args</p>
<blockquote>
<div><p>Additional keyword arguments that are passed to timemodel.</p>
</div></blockquote>
<p><strong>tfactor</strong> : float, default 7</p>
<blockquote>
<div><p>Factor to determine max time for timemodel.
tmax=1/(min(resolution_width)*tfactor) determines the resolution to decay as <img class="math" src="_images/math/12cd7c58a4122c50e6a5eca6c6f3523c29c1ab12.png" alt="e^{-tfactor^2/2}"/>.
THe timestep is dt=1/max(<a href="#id46"><span class="problematic" id="id47">|w|</span></a>). A minimum of len(w) steps is used (which might increase tmax).
Increase tfactor if artefacts (wobbling) from the limited timewindow are visible as the limited timeintervall
acts like a window function for the Fourier transform.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dataArray</strong> : A symmetric spectrum is returned.</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>.Sq     <img class="math" src="_images/math/dc32dbc6e782e34775c6007de627d15fc5bf3fcb.png" alt="\rightarrow S(q)=\int_{-\omega_{min}}^{\omega_{max}}S(Q,\omega)d\omega\approx\int_{-\infty}^{\infty} S(Q,\omega)d\omega = I(q,t=0)"/></dt>
<dd><p class="first last">Integration is done by a cubic spline in w domain on the ârawâ fourier transfom of timemodel.</p>
</dd>
<dt>.Iqt    timemodel(t,kwargs) dataarray returned from timemodel.</dt>
<dd><p class="first last">Implicitly this is the Fourier transform to timedomain after a succesfull fit in w domain.
Using a heuristic model in timedomain as multiple Gaussians or stretched exponentials allows a convenient
transform to timedomain of experimental data.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>We use Fourier transform with real signals. The transform is defined as</p>
<div class="math">
<p><img src="_images/math/5dbae25c839ce47078e8556ce1aa3564cc55c5e0.png" alt="F(f(t)) =  \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty} f(t) e^{-i\omega t} dt"/></p>
</div><div class="math">
<p><img src="_images/math/3ca9cc185d2d29386f0c20d173f330c18612922e.png" alt="F(f(w)) =  \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty} f(\omega) e^{i\omega t} d\omega"/></p>
</div><p>The resolution function is defined as (see resolution_w)</p>
<div class="math">
<p><img src="_images/math/2ee2f8be5e4ee72d7dd60c776847840b598d4f61.png" alt="R_w(w,m_i,s_i,a_i)&amp;=\sum_i a_i e^{-\frac{1}{2}(\frac{w-m_i}{s_i})^2} \\

&amp;=\frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty} \sum_i{a_i s_i e^{-\frac{1}{2}s_i^2t^2}} e^{-i\omega t} dt"/></p>
</div><p>using the resolution in timedomain <img class="math" src="_images/math/d5f18a92075dad95e9eea082f8c8e85995ab1aef.png" alt="R_t(t,m_i,s_i,a_i)=\sum_i a_i s_i e^{-\frac{1}{2}s_i^2 t^2}"/></p>
<p>The Fourier tranform of the timemodel I(q,t) is</p>
<div class="math">
<p><img src="_images/math/38256ca5ad6282af0f0b858af9f7dc737a67c658.png" alt="I(q,w) = \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty} R_t(t,m_i,s_i,a_i) I(q,t) e^{-i\omega t} dt"/></p>
</div><p>The integral is calculated by fast Fourier transform as</p>
<div class="math">
<p><img src="_images/math/d1202145212f1752dfc87e71136782ad785e61b6.png" alt="I(q,m\Delta w) = \frac{1}{\sqrt{2\pi}} \Delta t \sum_{n=-N}^{N} R_t(n\Delta t,...) I(q,n\Delta t) e^{-i mn/N}"/></p>
</div><p>with <img class="math" src="_images/math/4952c8c64fdf4a5b317351e4dd14414350667711.png" alt="t_{max}=tfactor/min(s_i)"/> large enough that the resolution decayed to be negligible.
Actually the resolution acts like a window function to reduce spectral leakage with vanishing values at <img class="math" src="_images/math/3635dae2a468768581c03ae019a1435ee3b517ef.png" alt="t_{max}"/> .
Nevertheless, due to the cutoff at <img class="math" src="_images/math/3635dae2a468768581c03ae019a1435ee3b517ef.png" alt="t_{max}"/> a wobbling migth appear indicating that <img class="math" src="_images/math/3635dae2a468768581c03ae019a1435ee3b517ef.png" alt="t_{max}"/> needs to be larger.</p>
<p><strong>Mixed domain models</strong>
Associativity and Convolution theorem allow to mix models from frequency domain and time domain.
Fourier transform needs the resolution included in time domain as it acts like a window function.
After tranformation to frequency domain the w domain models have to be convoluted with FFT transformed model.
Resolution is already taken into account in this way.</p>
<p class="rubric">Examples</p>
<p>Other usage example with a comparison of w domain and transfomed from time domain can be found in
<a class="reference internal" href="examples.html#a-comparison-of-different-dynamic-models-in-frequency-domain"><span class="std std-ref">A comparison of different dynamic models in frequency domain</span></a> .</p>
<p>Compare transDiffusion transform from time domain with direct convolution in w domain.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mf">0.5</span><span class="p">]</span>
<span class="n">start</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s0&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;m0&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;a0&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;s1&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;m1&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;a1&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;bgr&#39;</span><span class="p">:</span><span class="mf">0.00</span><span class="p">}</span>
<span class="n">resolution</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">resolution_w</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="o">**</span><span class="n">start</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">D</span><span class="o">=</span><span class="mf">0.035</span><span class="p">;</span><span class="n">qq</span><span class="o">=</span><span class="mi">3</span>  <span class="c1"># diffusion coefficient of protein alcohol dehydrogenase (140 kDa) is 0.035 nm**2/ns</span>
<span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Inelastic spectrum IN5 like&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">subtitle</span><span class="p">(</span><span class="s1">&#39;resolution width about 6 ns\S-1\N, Q=</span><span class="si">%.2g</span><span class="s1"> nm\S-1\N&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">qq</span><span class="p">))</span>
<span class="c1"># compare diffusion with convolution and transform from timedomain</span>
<span class="n">diff_ffw</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">time2frequencyFF</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">simpleDiffusion</span><span class="p">,</span><span class="n">resolution</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">qq</span><span class="p">,</span><span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>
<span class="n">diff_w</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">transDiff_w</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">qq</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diff_w</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">li</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;original diffusion D=</span><span class="si">%.3g</span><span class="s1"> nm\S2\N/ns&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diff_ffw</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;transform from time domain&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diff_ffw</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">diff_ffw</span><span class="o">.</span><span class="n">Y</span><span class="o">+</span><span class="n">diff_ffw</span><span class="o">.</span><span class="n">Y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;transform from time domain with 10\S-3\N bgr&#39;</span><span class="p">)</span>
<span class="c1"># resolution has to be normalized in convolve</span>
<span class="n">diff_cw</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">diff_w</span><span class="p">,</span><span class="n">resolution</span><span class="p">,</span><span class="n">normB</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diff_cw</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">li</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;after convolution in w domain&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resolution</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">resolution</span><span class="o">.</span><span class="n">Y</span><span class="o">/</span><span class="n">resolution</span><span class="o">.</span><span class="n">integral</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">li</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;resolution&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;S(Q,w)&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;w / ns\S-1&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;convolution edge ==&gt;\nmake broader and cut&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">8e-6</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare the resolutions direct and from transform from time domain.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">fwres</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">time2frequencyFF</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="n">resolution</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fwres</span><span class="p">,</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;fft only resolution&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">li</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;original resolution&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.time2frequencyFF">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">time2frequencyFF</code><span class="sig-paren">(</span><em>timemodel</em>, <em>resolution</em>, <em>w=None</em>, <em>tfactor=7</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#time2frequencyFF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.time2frequencyFF" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Fast Fourier transform from time domain to frequency domain for inelastic neutron scattering.</p>
<p>Shortcut t2fFF calls this function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>timemodel</strong> : function, None</p>
<blockquote>
<div><p>Model for I(q,t) in time domain. t in units of ns.
If None a constant function equal one is used like elastic scattering to fit resolution measurement.</p>
</div></blockquote>
<p><strong>resolution</strong> : dataArray</p>
<blockquote>
<div><p>dataArray that describes the resolution function from a fit with resolution_w or parametrized.
A nonzero bgr in resolution is ignored and needs to be added afterwards.
Resolution width are in the range of 6 1/ns (IN5 TOF) or 1 1/ns (Spheres BS).</p>
</div></blockquote>
<p><strong>w</strong> : array</p>
<blockquote>
<div><p>Frequencies for the result, e.g. from experimental data.
If w is None the frequencies w of the resolution are used.
This allows to use the fit of a resolution to be used with same w values.</p>
</div></blockquote>
<p><strong>kwargs</strong> : keyword args</p>
<blockquote>
<div><p>Additional keyword arguments that are passed to timemodel.</p>
</div></blockquote>
<p><strong>tfactor</strong> : float, default 7</p>
<blockquote>
<div><p>Factor to determine max time for timemodel.
tmax=1/(min(resolution_width)*tfactor) determines the resolution to decay as <img class="math" src="_images/math/12cd7c58a4122c50e6a5eca6c6f3523c29c1ab12.png" alt="e^{-tfactor^2/2}"/>.
THe timestep is dt=1/max(<a href="#id48"><span class="problematic" id="id49">|w|</span></a>). A minimum of len(w) steps is used (which might increase tmax).
Increase tfactor if artefacts (wobbling) from the limited timewindow are visible as the limited timeintervall
acts like a window function for the Fourier transform.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dataArray</strong> : A symmetric spectrum is returned.</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>.Sq     <img class="math" src="_images/math/dc32dbc6e782e34775c6007de627d15fc5bf3fcb.png" alt="\rightarrow S(q)=\int_{-\omega_{min}}^{\omega_{max}}S(Q,\omega)d\omega\approx\int_{-\infty}^{\infty} S(Q,\omega)d\omega = I(q,t=0)"/></dt>
<dd><p class="first last">Integration is done by a cubic spline in w domain on the ârawâ fourier transfom of timemodel.</p>
</dd>
<dt>.Iqt    timemodel(t,kwargs) dataarray returned from timemodel.</dt>
<dd><p class="first last">Implicitly this is the Fourier transform to timedomain after a succesfull fit in w domain.
Using a heuristic model in timedomain as multiple Gaussians or stretched exponentials allows a convenient
transform to timedomain of experimental data.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>We use Fourier transform with real signals. The transform is defined as</p>
<div class="math">
<p><img src="_images/math/5dbae25c839ce47078e8556ce1aa3564cc55c5e0.png" alt="F(f(t)) =  \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty} f(t) e^{-i\omega t} dt"/></p>
</div><div class="math">
<p><img src="_images/math/3ca9cc185d2d29386f0c20d173f330c18612922e.png" alt="F(f(w)) =  \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty} f(\omega) e^{i\omega t} d\omega"/></p>
</div><p>The resolution function is defined as (see resolution_w)</p>
<div class="math">
<p><img src="_images/math/2ee2f8be5e4ee72d7dd60c776847840b598d4f61.png" alt="R_w(w,m_i,s_i,a_i)&amp;=\sum_i a_i e^{-\frac{1}{2}(\frac{w-m_i}{s_i})^2} \\

&amp;=\frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty} \sum_i{a_i s_i e^{-\frac{1}{2}s_i^2t^2}} e^{-i\omega t} dt"/></p>
</div><p>using the resolution in timedomain <img class="math" src="_images/math/d5f18a92075dad95e9eea082f8c8e85995ab1aef.png" alt="R_t(t,m_i,s_i,a_i)=\sum_i a_i s_i e^{-\frac{1}{2}s_i^2 t^2}"/></p>
<p>The Fourier tranform of the timemodel I(q,t) is</p>
<div class="math">
<p><img src="_images/math/38256ca5ad6282af0f0b858af9f7dc737a67c658.png" alt="I(q,w) = \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty} R_t(t,m_i,s_i,a_i) I(q,t) e^{-i\omega t} dt"/></p>
</div><p>The integral is calculated by fast Fourier transform as</p>
<div class="math">
<p><img src="_images/math/d1202145212f1752dfc87e71136782ad785e61b6.png" alt="I(q,m\Delta w) = \frac{1}{\sqrt{2\pi}} \Delta t \sum_{n=-N}^{N} R_t(n\Delta t,...) I(q,n\Delta t) e^{-i mn/N}"/></p>
</div><p>with <img class="math" src="_images/math/4952c8c64fdf4a5b317351e4dd14414350667711.png" alt="t_{max}=tfactor/min(s_i)"/> large enough that the resolution decayed to be negligible.
Actually the resolution acts like a window function to reduce spectral leakage with vanishing values at <img class="math" src="_images/math/3635dae2a468768581c03ae019a1435ee3b517ef.png" alt="t_{max}"/> .
Nevertheless, due to the cutoff at <img class="math" src="_images/math/3635dae2a468768581c03ae019a1435ee3b517ef.png" alt="t_{max}"/> a wobbling migth appear indicating that <img class="math" src="_images/math/3635dae2a468768581c03ae019a1435ee3b517ef.png" alt="t_{max}"/> needs to be larger.</p>
<p><strong>Mixed domain models</strong>
Associativity and Convolution theorem allow to mix models from frequency domain and time domain.
Fourier transform needs the resolution included in time domain as it acts like a window function.
After tranformation to frequency domain the w domain models have to be convoluted with FFT transformed model.
Resolution is already taken into account in this way.</p>
<p class="rubric">Examples</p>
<p>Other usage example with a comparison of w domain and transfomed from time domain can be found in
<a class="reference internal" href="examples.html#a-comparison-of-different-dynamic-models-in-frequency-domain"><span class="std std-ref">A comparison of different dynamic models in frequency domain</span></a> .</p>
<p>Compare transDiffusion transform from time domain with direct convolution in w domain.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mf">0.5</span><span class="p">]</span>
<span class="n">start</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s0&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;m0&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;a0&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;s1&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;m1&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;a1&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;bgr&#39;</span><span class="p">:</span><span class="mf">0.00</span><span class="p">}</span>
<span class="n">resolution</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">resolution_w</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="o">**</span><span class="n">start</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">D</span><span class="o">=</span><span class="mf">0.035</span><span class="p">;</span><span class="n">qq</span><span class="o">=</span><span class="mi">3</span>  <span class="c1"># diffusion coefficient of protein alcohol dehydrogenase (140 kDa) is 0.035 nm**2/ns</span>
<span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Inelastic spectrum IN5 like&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">subtitle</span><span class="p">(</span><span class="s1">&#39;resolution width about 6 ns\S-1\N, Q=</span><span class="si">%.2g</span><span class="s1"> nm\S-1\N&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">qq</span><span class="p">))</span>
<span class="c1"># compare diffusion with convolution and transform from timedomain</span>
<span class="n">diff_ffw</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">time2frequencyFF</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">simpleDiffusion</span><span class="p">,</span><span class="n">resolution</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">qq</span><span class="p">,</span><span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>
<span class="n">diff_w</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">transDiff_w</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">qq</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diff_w</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">li</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;original diffusion D=</span><span class="si">%.3g</span><span class="s1"> nm\S2\N/ns&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diff_ffw</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;transform from time domain&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diff_ffw</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">diff_ffw</span><span class="o">.</span><span class="n">Y</span><span class="o">+</span><span class="n">diff_ffw</span><span class="o">.</span><span class="n">Y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;transform from time domain with 10\S-3\N bgr&#39;</span><span class="p">)</span>
<span class="c1"># resolution has to be normalized in convolve</span>
<span class="n">diff_cw</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">diff_w</span><span class="p">,</span><span class="n">resolution</span><span class="p">,</span><span class="n">normB</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diff_cw</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">li</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;after convolution in w domain&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resolution</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">resolution</span><span class="o">.</span><span class="n">Y</span><span class="o">/</span><span class="n">resolution</span><span class="o">.</span><span class="n">integral</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">li</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;resolution&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;S(Q,w)&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;w / ns\S-1&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;convolution edge ==&gt;\nmake broader and cut&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">8e-6</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare the resolutions direct and from transform from time domain.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">fwres</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">time2frequencyFF</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="n">resolution</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fwres</span><span class="p">,</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;fft only resolution&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span><span class="n">sy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">li</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">le</span><span class="o">=</span><span class="s1">&#39;original resolution&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.transDiff_w">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">transDiff_w</code><span class="sig-paren">(</span><em>w</em>, <em>q</em>, <em>D</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#transDiff_w"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.transDiff_w" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Translational diffusion; dynamic structure factor in w domain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>w</strong> : array</p>
<blockquote>
<div><p>Frequencies in 1/ns</p>
</div></blockquote>
<p><strong>q</strong> : float</p>
<blockquote>
<div><p>Wavevector in nm**-1</p>
</div></blockquote>
<p><strong>D</strong> : float</p>
<blockquote>
<div><p>Diffusion constant in nm**2/ns</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="id39" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R62]</td><td>Scattering of Slow Neutrons by a Liquid
Vineyard G Physical Review 1958 vol: 110 (5) pp: 999-1010</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.zilmanGranekBicontinious">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">zilmanGranekBicontinious</code><span class="sig-paren">(</span><em>t</em>, <em>q</em>, <em>xi</em>, <em>kappa</em>, <em>eta</em>, <em>mt=1</em>, <em>amp=1</em>, <em>eps=1</em>, <em>nGauss=60</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#zilmanGranekBicontinious"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.zilmanGranekBicontinious" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Dynamics of bicontinuous microemulsion phases. Zilman-Granek model as Equ B10 in <a class="reference internal" href="#r64" id="id41">[R64]</a>. Coherent scattering.</p>
<p>On very local scales (however larger than the molecular size) Zilman and Granek represent the amphiphile layer
in the bicontinuous network as consisting of an ensemble of independent patches at random orientation of size
equal to the correlation length xi.
Uses Gauss integration and multiprocessing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : array</p>
<blockquote>
<div><p>Time values in ns</p>
</div></blockquote>
<p><strong>q</strong> : float</p>
<blockquote>
<div><p>Scattering vector in 1/A</p>
</div></blockquote>
<p><strong>xi</strong> : float</p>
<blockquote>
<div><p>Correlation length related to the size of patches which are locally planar
and determine the width of the peak in static data. unit A
A result of the teubnerStrey model to e.g. SANS data. Determines kmin=eps*pi/xi .</p>
</div></blockquote>
<p><strong>kappa</strong> : float</p>
<blockquote>
<div><p>Apparent single membrane bending modulus, unit kT</p>
</div></blockquote>
<p><strong>eta</strong> : float</p>
<blockquote>
<div><p>Solvent viscosity, unit kT*A^3/ns=100/(1.38065*T)*eta[unit Pa*s]
Water about 0.001 Pa*s = 0.000243 kT*A^3/ns</p>
</div></blockquote>
<p><strong>amp</strong> : float, default = 1</p>
<blockquote>
<div><p>Amplitude scaling factor</p>
</div></blockquote>
<p><strong>eps</strong> : float, default=1</p>
<blockquote>
<div><p>Scaling factor in range [1..1.3] for kmin=eps*pi/xi and rmax=xi/eps. See <a class="reference internal" href="#r64" id="id42">[R64]</a>.</p>
</div></blockquote>
<p><strong>mt</strong> : float, default 0.1</p>
<blockquote>
<div><p>Membrane thickness in unit A as approximated from molecular size of material. Determines kmax=pi/mt.
About 12 Angstroem for tenside C10E4.</p>
</div></blockquote>
<p><strong>nGauss</strong> : int, default 60</p>
<blockquote>
<div><p>Number of points in Gauss integration</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataList</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ul class="simple">
<li>For technical reasons, in order to avoid numerical difficulties, the real space upper (rmax integration) cutoff
was realized by multiplying the integrand with a Gaussian having a width of eps*xi and integrating over [0,3*eps*xi].</li>
</ul>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r64" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R64]</td><td><em>(<a class="fn-backref" href="#id41">1</a>, <a class="fn-backref" href="#id42">2</a>, <a class="fn-backref" href="#id43">3</a>)</em> Dynamics of bicontinuous microemulsion phases with and without amphiphilic block-copolymers
M. Mihailescu1, M. Monkenbusch et al
J. Chem. Phys. 115, 9563 (2001); <a class="reference external" href="http://dx.doi.org/10.1063/1.1413509">http://dx.doi.org/10.1063/1.1413509</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">t</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">iqt</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">zilmanGranekBicontinious</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.03</span><span class="p">:</span><span class="mf">0.2</span><span class="p">:</span><span class="mf">0.04</span><span class="p">],</span><span class="n">xi</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span><span class="n">kappa</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">eta</span><span class="o">=</span><span class="mf">0.24e-3</span><span class="p">,</span><span class="n">nGauss</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iqt</span><span class="p">)</span>
<span class="c1"># to use the multiprocessing in a fit of data use memoize</span>
<span class="n">data</span><span class="o">=</span><span class="n">iqt</span>                          <span class="c1"># this represent your measured data</span>
<span class="n">tt</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">flatten</span><span class="p">))</span>      <span class="c1"># a list of all time values</span>
<span class="n">tt</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="c1"># use correct values from data for q     -&gt; interpolation is exact for q and tt</span>
<span class="n">zGBmem</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">formel</span><span class="o">.</span><span class="n">memoize</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">tt</span><span class="p">)(</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">zilmanGranekBicontinious</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">mfitfunc</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">amp</span><span class="p">):</span>
   <span class="c1"># this will calculate in each fit step for forst Q (but calc all) and then take from memoized values</span>
   <span class="n">res</span><span class="o">=</span> <span class="n">zGBmem</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">xi</span><span class="o">=</span><span class="n">xi</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="n">amp</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">X</span><span class="o">=</span><span class="n">t</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># use mfitfunc for fitting with multiprocessing</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.dynamic.zilmanGranekLamellar">
<code class="descclassname">jscatter.dynamic.</code><code class="descname">zilmanGranekLamellar</code><span class="sig-paren">(</span><em>t</em>, <em>q</em>, <em>df</em>, <em>kappa</em>, <em>eta</em>, <em>mu=0.001</em>, <em>eps=1</em>, <em>amp=1</em>, <em>mt=0.1</em>, <em>nGauss=40</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/dynamic.html#zilmanGranekLamellar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.dynamic.zilmanGranekLamellar" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Dynamics of lamellar microemulsion phases.  Zilman-Granek model as Equ B10 in <a class="reference internal" href="#r65" id="id44">[R65]</a>. Coherent scattering.</p>
<p>Oriented lamellar phases at the length scale of the inter membrane distance and beyond are performed
using small-angle neutrons scattering and neutron spin-echo spectroscopy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : array</p>
<blockquote>
<div><p>Time in ns</p>
</div></blockquote>
<p><strong>q</strong> : float</p>
<blockquote>
<div><p>Scattering vector</p>
</div></blockquote>
<p><strong>df</strong> : float</p>
<blockquote>
<div><ul class="simple">
<li>film-film distance. unit A</li>
<li>This represents half the periodicity of the structure, generally denoted by d=0.5df which determines the peak position.
and determines kmin=eps*pi/df</li>
</ul>
</div></blockquote>
<p><strong>kappa</strong> : float</p>
<blockquote>
<div><p>Apparent single membrane bending modulus, unit kT</p>
</div></blockquote>
<p><strong>mu</strong> : float, default 0.001</p>
<blockquote>
<div><p>Angle between q and surface normal in unit rad.
For lamelar oriented system this is close to zero in NSE.</p>
</div></blockquote>
<p><strong>eta</strong> : float</p>
<blockquote>
<div><p>Solvent viscosity, unit kT*A^3/ns = 100/(1.38065*T)*eta[unit Pa*s]
Water about 0.001 Pa*s = 0.000243 kT*A^3/ns</p>
</div></blockquote>
<p><strong>eps</strong> : float, default=1</p>
<blockquote>
<div><p>Scaling factor in range [1..1.3] for kmin=eps*pi/xi and rmax=xi/eps</p>
</div></blockquote>
<p><strong>amp</strong> : float, default 1</p>
<blockquote>
<div><p>Amplitude scaling factor</p>
</div></blockquote>
<p><strong>mt</strong> : float, default 0.1</p>
<blockquote>
<div><p>Membrane thickness in unit A as approximated from molecular size of material. Determines kmax=pi/mt
About 12 Angstroem for  tenside C10E4.</p>
</div></blockquote>
<p><strong>nGauss</strong> : int, default 40</p>
<blockquote>
<div><p>Number of points in Gauss integration</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataList</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The integrations are done by nGauss point Gauss quadrature, except for the kmax-kmin integration which is done by
adaptive Gauss integration with rtol=0.1/nGauss k&lt; kmax/8 and rtol=1./nGauss k&gt; kmax/8.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r65" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R65]</td><td><em>(<a class="fn-backref" href="#id44">1</a>, <a class="fn-backref" href="#id45">2</a>)</em> Neutron scattering study on the structure and dynamics of oriented lamellar phase microemulsions
M. Mihailescu, M. Monkenbusch, J. Allgaier, H. Frielinghaus, D. Richter, B. Jakobs, and T. Sottmann
Phys. Rev. E 66, 041504 (2002)</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">t</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ql</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.08</span><span class="p">:</span><span class="mf">0.261</span><span class="p">:</span><span class="mf">0.03</span><span class="p">]</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">iqt</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">zilmanGranekLamellar</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">ql</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">kappa</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">eta</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mf">0.24e-3</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iqt</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/Jscatter.jpeg" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">8. dynamic</a><ul>
<li><a class="reference internal" href="#transfom-between-domains">8.1. Transfom between domains</a></li>
<li><a class="reference internal" href="#time-domain">8.2. Time domain</a></li>
<li><a class="reference internal" href="#frequency-domain">8.3. Frequency domain</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="structurefactor.html"
                        title="previous chapter">7. structurefactor (sf)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dls.html"
                        title="next chapter">9. DLS</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/dynamic.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dls.html" title="9. DLS"
             >next</a> |</li>
        <li class="right" >
          <a href="structurefactor.html" title="7. structurefactor (sf)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">jscatter 0.6.8 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, Ralf Biehl.
      Last updated on Jan 23, 2018.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>