webpackJsonp([40],{0:function(t,e,s){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var i=s(75),o=_interopRequireDefault(i),n=s(6),r=_interopRequireDefault(n),a=s(29),u=_interopRequireDefault(a);s(992);var l=s(336),c=_interopRequireDefault(l),d=s(340),p=_interopRequireDefault(d);new u.default({mixins:[o.default],components:{ShareButton:c.default,DiscussionThreads:p.default},ready:function(){r.default.debug("Post page ready")}})},86:function(t,e,s){var i,o;i=s(309),o=s(329),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),o&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=o)},309:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=52;e.default={props:{user:Object,size:{type:Number,default:s}}}},310:function(t,e,s){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=s(87),o=(_interopRequireDefault(i),s(81)),n=_interopRequireDefault(o);e.default={props:{title:{type:String,required:!0},url:{type:String,required:!0}},filters:{encode:encodeURIComponent},methods:{click:function(){n.default.publish("SHARE"),this.$refs.popover.show=!1}}}},311:function(t,e,s){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=s(6),o=_interopRequireDefault(i);e.default={props:{discussionId:String},data:function(){return{sending:!1,comment:""}},methods:{prefill:function(t){t=t||"",this.comment=t,this.$els.textarea.setSelectionRange(t.length,t.length),this.$els.textarea.focus()},submit:function(){var t=this;this.sending=!0,this.$api.post("discussions/"+this.discussionId+"/",{comment:this.comment}).then(function(e){t.$dispatch("discussion:updated",e),t.comment="",t.sending=!1,document.location.href="#discussion-"+t.discussionId+"-"+(e.discussion.length-1)}).catch(function(e){var s=t._("An error occured while submitting your comment");t.$dispatch("notify.error",s),o.default.error(e),t.sending=!1})}}}},312:function(t,e,s){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=s(17),o=_interopRequireDefault(i),n=s(86),r=_interopRequireDefault(n),a=s(337),u=_interopRequireDefault(a),l=s(19),c=_interopRequireDefault(l);e.default={components:{Avatar:r.default,ThreadForm:u.default},props:{discussion:Object,position:Number},data:function(){return{detailed:!1,formDisplayed:!1,currentUser:o.default.user}},events:{"discussion:updated":function(t){return this.hideForm(),!0}},computed:{discussionIdAttr:function(){return"discussion-"+this.discussion.id},createdDate:function(){return(0,c.default)(this.discussion.created).format("LL")},closedDate:function(){return(0,c.default)(this.discussion.closed).format("LL")}},methods:{toggleDiscussions:function(){this.detailed=!this.detailed},displayForm:function(){this.$auth(this._("You need to be logged in to comment.")),this.formDisplayed=!0,this.detailed=!0},hideForm:function(){this.formDisplayed=!1},start:function(t){var e=this;this.displayForm(),this.$nextTick(function(){e.$els.form&&e.$refs.form&&(e.$scrollTo(e.$els.form),e.$refs.form.prefill(t))})},focus:function(t){var e=this;this.detailed=!0,t?this.$nextTick(function(){e.$scrollTo("#"+e.discussionIdAttr+"-"+t)}):this.$scrollTo(this)},formatDate:function(t){return(0,c.default)(t).format("LL")}}}},313:function(t,e,s){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=s(6),o=_interopRequireDefault(i);e.default={props:{subjectId:String,subjectClass:String,position:Number},data:function(){return{sending:!1,title:"",comment:""}},methods:{prefill:function(t,e){e=e||"",this.comment=e,this.title=t||"",t?(this.$els.textarea.setSelectionRange(e.length,e.length),this.$els.textarea.focus()):this.$els.title.focus()},submit:function(){var t=this,e={title:this.title,comment:this.comment,subject:{id:this.subjectId,class:this.subjectClass}};this.sending=!0,this.$api.post("discussions/",e).then(function(e){t.$dispatch("discussion:created",e),t.title="",t.comment="",t.sending=!1,document.location.href="#discussion-"+e.id}).catch(function(e){var s=t._("An error occured while submitting your comment");t.$dispatch("notify:error",s),o.default.error(e),t.sending=!1})}}}},314:function(t,e,s){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=s(132),o=_interopRequireDefault(i),n=s(17),r=_interopRequireDefault(n),a=s(86),u=_interopRequireDefault(a),l=s(338),c=_interopRequireDefault(l),d=s(339),p=_interopRequireDefault(d),f=s(6),m=_interopRequireDefault(f),h=/^#discussion-([0-9a-f]{24})$/,v=/^#discussion-([0-9a-f]{24})-(\d+)$/,g=/^#discussion-([0-9a-f]{24})-new-comment$/;e.default={components:{Avatar:u.default,DiscussionThread:c.default,ThreadsForm:p.default},data:function(){return{discussions:[],formDisplayed:!1,currentUser:r.default.user}},props:{subjectId:String,subjectClass:String},events:{"discussion:created":function(t){var e=this;this.hideForm(),this.discussions.unshift(t),this.$nextTick(function(){var s=e.threadFor(t.id);s.detailed=!0,e.$scrollTo(s)})},"discussion:updated":function(t){var e=this.discussions.indexOf(this.discussions.find(function(e){return e.id==t.id}));this.discussions.$set(e,t)}},ready:function(){var t=this;this.$api.get("discussions/",{for:this.subjectId}).then(function(e){t.discussions=e.data,document.location.hash&&t.$nextTick(function(){t.jumpToHash(document.location.hash)})}).catch(m.default.error.bind(m.default))},methods:{displayForm:function(){this.$auth(this._("You need to be logged in to start a discussion.")),this.formDisplayed=!0},hideForm:function(){this.formDisplayed=!1},start:function(t,e){var s=this;this.displayForm(),this.$nextTick(function(){s.$els.form&&s.$refs.form&&(s.$scrollTo(s.$els.form),s.$refs.form.prefill(t,e))})},threadFor:function(t){return this.$refs.threads.find(function(e){return e.discussion.id==t})},jumpToHash:function(t){if("#discussion-create"===t)this.start();else if(h.test(t)){var e=t.match(h),s=(0,o.default)(e,2),i=s[1];this.threadFor(i).focus()}else if(v.test(t)){var n=t.match(v),r=(0,o.default)(n,3),a=r[1],u=r[2];this.threadFor(a).focus(u)}else if(g.test(t)){var l=t.match(g),c=(0,o.default)(l,2),d=c[1];this.threadFor(d).start()}}}}},324:function(t,e,s){e=t.exports=s(14)(),e.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",file:"share.vue",sourceRoot:"webpack://"}])},325:function(t,e,s){e=t.exports=s(14)(),e.push([t.id,".list-group-item p.list-group-item-heading a,.list-group-item p.list-group-item-heading a:hover{text-decoration:underline}","",{version:3,sources:["/./js/components/discussions/thread.vue"],names:[],mappings:"AAAA,gGAAgG,yBAAyB,CAAC",file:"thread.vue",sourcesContent:[".list-group-item p.list-group-item-heading a,.list-group-item p.list-group-item-heading a:hover{text-decoration:underline}"],sourceRoot:"webpack://"}])},329:function(t,e){t.exports=' <a class=avatar :href=user.url :title="user | display"> <img class=avatar :src="user | avatar_url size" :alt="user | display" :width=size :height=size> </a> '},330:function(t,e){t.exports=' <button type=button class="btn btn-primary btn-share" :title="_(\'Share\')" v-tooltip v-popover popover-large :popover-title="_(\'Share\')"> <span class="fa fa-share-alt"></span> <div class="btn-group btn-group-lg" data-popover-content> <a class="btn btn-link" title=Google+ @click=click href="https://plus.google.com/share?url={{url|encode}}" target=_blank> <span class="fa fa-2x fa-google-plus"></span> </a> <a class="btn btn-link" title=Twitter @click=click href="https://twitter.com/home?status={{title|encode}}%20-%20{{url|encode}}" target=_blank> <span class="fa fa-2x fa-twitter"></span> </a> <a class="btn btn-link" title=Facebook @click=click href="https://www.facebook.com/sharer/sharer.php?u={{url|encode}}" target=_blank> <span class="fa fa-2x fa-facebook"></span> </a> <a class="btn btn-link" title=LinkedIn @click=click href="https://www.linkedin.com/shareArticle?mini=true&url={{url|encode}}&title={{title|encode}}" target=_blank> <span class="fa fa-2x fa-linkedin"></span> </a> </div> </button> '},331:function(t,e){t.exports=' <form role=form class="clearfix animated" @submit.prevent=submit> <div class=form-group> <label for=comment-new-message>{{ _(\'Comment\') }}</label> <textarea v-el:textarea id=comment-new-message v-model=comment class=form-control rows=3 required></textarea> </div> <button type=submit :disabled="this.sending || !this.comment" class="btn btn-primary btn-block pull-right submit-new-message"> {{ _(\'Submit your comment\') }} </button> </form> '},332:function(t,e){t.exports=' <div> <div class=list-group-item :id=discussionIdAttr @click=toggleDiscussions :class="{expanded: detailed}"> <div class="format-label pull-left"> <avatar :user=discussion.user></avatar> </div> <span class=list-group-item-link> <a href="#{{ discussionIdAttr }}"><span class="fa fa-link"></span></a> </span> <h4 class="list-group-item-heading ellipsis open-discussion-thread"> <span>{{ discussion.title }}</span> <span v-if=discussion.closed class="fa fa-microphone-slash"></span> </h4> <p class="list-group-item-text ellipsis open-discussion-thread list-group-message-number-{{ discussion.id }}"> <span v-if=!discussion.closed>{{ _(\'Discussion started on {created} with {count} messages.\', {created: createdDate, count: discussion.discussion.length}) }}</span> <span v-if=discussion.closed>{{ _(\'Discussion closed on {closed} with {count} messages.\', {closed: closedDate, count: discussion.discussion.length}) }}</span> </p> </div> <div v-for="(index, response) in discussion.discussion" id="{{ discussionIdAttr }}-{{ index }}" class="list-group-item list-group-indent animated discussion-messages-list" :class="{\'body-only\': index == 0}" v-show=detailed> <template v-if="index > 0"> <div class="format-label pull-left"> <avatar :user=response.posted_by></avatar> </div> <span class=list-group-item-link> <a href="#{{ discussionIdAttr }}-{{ index }}"><span class="fa fa-link"></span></a> </span> <div class="list-group-item-text ellipsis">{{ _(\'Comment posted on {posted_on}\', { posted_on: formatDate(response.posted_on) }) }}</div> </template> <p class=list-group-item-heading> {{{ response.content | markdown }}} </p> </div> <a v-if=!discussion.closed class="list-group-item add new-comment list-group-indent animated" v-show="!formDisplayed && detailed" @click=displayForm> <div class="format-label pull-left">+</div> <h4 class=list-group-item-heading> {{ _(\'Add a comment\') }} </h4> </a> <div v-el:form id="{{ discussionIdAttr }}-new-comment" v-show=formDisplayed v-if=currentUser class="list-group-item list-group-form list-group-indent animated"> <div class="format-label pull-left"> <avatar :user=currentUser></avatar> </div> <span class=list-group-item-link> <a href="#{{ discussionIdAttr }}-new-comment"><span class="fa fa-link"></span></a> <a @click=hideForm><span class="fa fa-times"></span></a> </span> <h4 class=list-group-item-heading> {{ _(\'Commenting on this thread\') }} </h4> <p class=list-group-item-text> {{ _("You\'re about to answer to this particular thread about:") }}<br/> {{ discussion.title }} </p> <thread-form v-ref:form :discussion-id=discussion.id></thread-form> </div> </div> '},333:function(t,e){t.exports=" <form role=form class=\"clearfix animated\" @submit.prevent=submit> <div class=form-group> <label for=title-new-discussion>{{ _('Title') }}</label> <input v-el:title type=text id=title-new-discussion v-model=title class=form-control required/> <label for=comment-new-discussion>{{ _('Comment') }}</label> <textarea v-el:textarea id=comment-new-discussion v-model=comment class=form-control rows=3 required></textarea> </div> <button type=submit :disabled=\"this.sending || !this.title || !this.comment\" class=\"btn btn-primary btn-block pull-right submit-new-discussion\"> {{ _('Start a discussion') }} </button> </form> "},334:function(t,e){t.exports=' <div class="list-group resources-list smaller"> <discussion-thread v-ref:threads v-for="discussion in discussions" :discussion=discussion track-by=id> </discussion-thread> <a class="list-group-item add new-discussion" @click=displayForm v-show=!formDisplayed> <div class="format-label pull-left">+</div> <h4 class=list-group-item-heading>{{ _(\'Start a new discussion\') }}</h4> </a> <div v-el:form id=discussion-create v-show=formDisplayed v-if=currentUser class="list-group-item list-group-form list-group-form-discussion animated"> <div class="format-label pull-left"> <avatar :user=currentUser></avatar> </div> <span class=list-group-item-link> <a href=#discussion-create><span class="fa fa-link"></span></a> <a @click=hideForm><span class="fa fa-times"></span></a> </span> <h4 class=list-group-item-heading> {{ _(\'Starting a new discussion thread\') }} </h4> <p class=list-group-item-text> {{ _("You\'re about to start a new discussion thread. Make sure that a thread about the same topic doesn\'t exist yet just above.") }} </p> <threads-form v-ref:form :subject-id=subjectId :subject-class=subjectClass></threads-form> </div> </div> '},336:function(t,e,s){var i,o;s(342),i=s(310),o=s(330),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),o&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=o)},337:function(t,e,s){var i,o;i=s(311),o=s(331),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),o&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=o)},338:function(t,e,s){var i,o;s(343),i=s(312),o=s(332),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),o&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=o)},339:function(t,e,s){var i,o;i=s(313),o=s(333),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),o&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=o)},340:function(t,e,s){var i,o;i=s(314),o=s(334),t.exports=i||{},t.exports.__esModule&&(t.exports=t.exports.default),o&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=o)},342:function(t,e,s){var i=s(324);"string"==typeof i&&(i=[[t.id,i,""]]);s(15)(i,{sourceMap:!0});i.locals&&(t.exports=i.locals)},343:function(t,e,s){var i=s(325);"string"==typeof i&&(i=[[t.id,i,""]]);s(15)(i,{sourceMap:!0});i.locals&&(t.exports=i.locals)},992:993});
//# sourceMappingURL=post.js.map