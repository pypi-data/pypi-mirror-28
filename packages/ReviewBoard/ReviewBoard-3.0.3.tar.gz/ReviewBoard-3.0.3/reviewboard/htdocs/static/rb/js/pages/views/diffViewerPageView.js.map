{"version":3,"sources":["diffViewerPageView.es6.js"],"names":[],"mappings":";;AAAA;;;;;;AAMA,GAAG,kBAAH,GAAwB,GAAG,kBAAH,CAAsB,MAAtB,CAA6B;AACjD,qBAAiB,CAAC,CAD+B;AAEjD,oBAAgB,CAFiC;;AAIjD,oBAAgB,CAJiC;AAKjD,iBAAa,CALoC;AAMjD,kBAAc,CANmC;;AAQjD,4BAAwB,EARyB;;AAUjD,iBAAa;AACT,kBAAU,qBADD;AAET,iBAAS,iBAFA;AAGT,iBAAS,qBAHA;AAIT,iBAAS,iBAJA;AAKT,cAAM,wBALG;AAMT,cAAM,oBANG;AAOT,gBAAQ,mBAPC;AAQT,cAAM;AARG,KAVoC;;AAqBjD,YAAQ,EAAE,MAAF,CAAS;AACb,gDAAwC,6BAD3B;AAEb,yCAAiC;AAFpB,KAAT,EAGL,GAAG,kBAAH,CAAsB,SAAtB,CAAgC,MAH3B,CArByC;;AA0BjD,wBAAoB,EAAE,QAAF,4WA1B6B;;AA4CjD;AACA,oBAAgB,EAAE,QAAF,CACZ,2DADY,CA7CiC;;AAgDjD;;;AAGA,cAnDiD,wBAmDpC;AAAA;;AACT,YAAM,cAAc,KAAK,KAAL,CAAW,QAAX,CAAoB,GAApB,CAAwB,UAAxB,CAApB;AACA,YAAM,OAAO,GAAG,eAAH,EAAb;AACA,YAAM,SAAS,SAAS,QAAT,CAAkB,MAAlB,IAA4B,EAA3C;;AAEA,WAAG,kBAAH,CAAsB,SAAtB,CAAgC,UAAhC,CAA2C,KAA3C,CAAiD,IAAjD,EAAuD,SAAvD;;AAEA,aAAK,oBAAL,GAA4B,CAAC,CAA7B;AACA,aAAK,QAAL,GAAgB,EAAE,MAAF,CAAhB;AACA,aAAK,SAAL,GAAiB,GAAjB;AACA,aAAK,UAAL,GAAkB,IAAlB;AACA,aAAK,OAAL,GAAe,IAAf;AACA,aAAK,oBAAL,GAA4B,EAA5B;AACA,aAAK,kBAAL,GAA0B,IAA1B;AACA,aAAK,iBAAL,GAAyB,IAAzB;;AAEA;;;;;;;AAOA,aAAK,QAAL,CAAc,KAAK,KAAL,CAAW,eAAzB,EAA0C,KAA1C,EACc,KAAK,sBADnB;;AAGA;;;;;AAKA,YAAM,YAAY,EAAE,SAAF,CAAY,YAAZ,CAAlB;;AAEA,aAAK,QAAL,CAAc,KAAK,KAAL,CAAW,eAAzB,EAA0C,YAA1C,EAAwD,YAAM;AAC1D,kBAAK,oBAAL,CAA0B,OAA1B,CAAkC;AAAA,uBAAQ,KAAK,MAAL,EAAR;AAAA,aAAlC;AACA,kBAAK,oBAAL,GAA4B,EAA5B;AACA,kBAAK,OAAL,CAAa,QAAb,CAAsB,iBAAtB,EAAyC,MAAzC;AACA,kBAAK,iBAAL,GAAyB,IAAzB;;AAEA,sBAAU,KAAV;AACH,SAPD;AAQA,aAAK,QAAL,CAAc,KAAK,KAAL,CAAW,eAAzB,EAA0C,WAA1C,EACc;AAAA,mBAAM,UAAU,KAAV,EAAN;AAAA,SADd;;AAGA;AACA,aAAK,kBAAL,GAA0B,QAAQ,IAAlC;;AAEA,aAAK,MAAL,GAAc,IAAI,SAAS,MAAb,CAAoB;AAC9B,oBAAQ;AACJ,8BAAc,UADV;AAEJ,yCAAyB;AAFrB;AADsB,SAApB,CAAd;AAMA,aAAK,QAAL,CAAc,KAAK,MAAnB,EAA2B,gBAA3B,EAA6C,UAAC,QAAD,EAAW,IAAX,EAAoB;AAC7D,gBAAI,SAAS,SAAb,EAAwB;AACpB,uBAAO,CAAP;AACH,aAFD,MAEO;AACH,uBAAO,SAAS,IAAT,EAAe,EAAf,CAAP;AACH;;AAED,gBAAI,SAAS,OAAT,CAAiB,GAAjB,MAA0B,CAAC,CAA/B,EAAkC;AAC9B,sBAAK,KAAL,CAAW,gBAAX,CAA4B;AACxB,0BAAM,IADkB;AAExB,8BAAU,SAAS,QAAT,EAAmB,EAAnB;AAFc,iBAA5B;AAIH,aALD,MAKO;AACH,oBAAM,QAAQ,SAAS,KAAT,CAAe,GAAf,EAAoB,CAApB,CAAd;;AAEA,sBAAK,KAAL,CAAW,gBAAX,CAA4B;AACxB,0BAAM,IADkB;AAExB,8BAAU,SAAS,MAAM,CAAN,CAAT,EAAmB,EAAnB,CAFc;AAGxB,uCAAmB,SAAS,MAAM,CAAN,CAAT,EAAmB,EAAnB;AAHK,iBAA5B;AAKH;AACJ,SArBD;;AAuBA;;;;;;;;;;;;;;AAcA,iBAAS,OAAT,CAAiB,KAAjB,CAAuB;AACnB,uBAAW,IADQ;AAEnB,wBAAY,KAFO;AAGnB,kBAAS,KAAK,KAAL,CAAW,GAAX,CAAe,eAAf,EAAgC,GAAhC,CAAoC,WAApC,CAAT,UAHmB;AAInB,oBAAQ;AAJW,SAAvB;;AAOA;;;;;;;;;;;;;;AAcA,YAAI,gBAAgB,WAApB;AACA,YAAM,uBACF,KAAK,KAAL,CAAW,QAAX,CAAoB,GAApB,CAAwB,mBAAxB,CADJ;;AAGA,YAAI,oBAAJ,EAA0B;AACtB,mCAAqB,oBAArB;AACH;;AAED,aAAK,MAAL,CAAY,QAAZ,CAAwB,aAAxB,SAAyC,MAAzC,SAAmD,IAAnD,EAA2D;AACvD,qBAAS,IAD8C;AAEvD,qBAAS;AAF8C,SAA3D;AAIH,KA9KgD;;;AAgLjD;;;AAGA,UAnLiD,oBAmLxC;AACL,WAAG,kBAAH,CAAsB,SAAtB,CAAgC,MAAhC,CAAuC,IAAvC,CAA4C,IAA5C;;AAEA,aAAK,QAAL,CAAc,GAAd,aAA4B,KAAK,GAAjC;AACA,aAAK,kBAAL,CAAwB,MAAxB;AACH,KAxLgD;;;AA0LjD;;;;;;;AAOA,UAjMiD,oBAiMxC;AAAA;;AACL,WAAG,kBAAH,CAAsB,SAAtB,CAAgC,MAAhC,CAAuC,IAAvC,CAA4C,IAA5C;;AAEA,aAAK,UAAL,GAAkB,EAAE,gBAAF,CAAlB;;AAEA,aAAK,kBAAL,GAA0B,IAAI,GAAG,iBAAP,CAAyB;AAC/C,gBAAI,EAAE,aAAF,CAD2C;AAE/C,wBAAY,KAAK,KAAL,CAAW;AAFwB,SAAzB,CAA1B;AAIA,aAAK,kBAAL,CAAwB,MAAxB;;AAEA,aAAK,QAAL,CAAc,KAAK,kBAAnB,EAAuC,eAAvC,EACc,KAAK,kBADnB;;AAGA,aAAK,sBAAL,GAA8B,IAAI,GAAG,qBAAP,CAA6B;AACvD,gBAAI,EAAE,sBAAF,CADmD;AAEvD,mBAAO,KAAK,KAAL,CAAW;AAFqC,SAA7B,CAA9B;AAIA,aAAK,sBAAL,CAA4B,MAA5B;;AAEA,aAAK,QAAL,CAAc,KAAK,sBAAnB,EAA2C,kBAA3C,EACc,KAAK,mBADnB;;AAGA;;;;AAIA,YAAM,WAAW,KAAK,KAAL,CAAW,GAAX,CAAe,UAAf,CAAjB;;AAEA,YAAI,WAAW,CAAf,EAAkB;AACd,iBAAK,yBAAL,GAAiC,IAAI,GAAG,wBAAP,CAAgC;AAC7D,oBAAI,EAAE,yBAAF,CADyD;AAE7D,uBAAO,KAAK,KAAL,CAAW,QAF2C;AAG7D,0BAAU;AAHmD,aAAhC,CAAjC;AAKA,iBAAK,yBAAL,CAA+B,MAA/B;;AAEA,iBAAK,QAAL,CAAc,KAAK,yBAAnB,EAA8C,kBAA9C,EACc,KAAK,mBADnB;AAEH;;AAED,aAAK,iBAAL,GAAyB,IAAI,GAAG,oBAAP,CAA4B;AACjD,gBAAI,EAAE,qBAAF,CAD6C;AAEjD,mBAAO,KAAK,KAAL,CAAW;AAF+B,SAA5B,CAAzB;AAIA,aAAK,iBAAL,CAAuB,MAAvB;AACA,aAAK,QAAL,CAAc,KAAK,iBAAnB,EAAsC,kBAAtC,EACc,KAAK,mBADnB;;AAGA,aAAK,gBAAL,GAAwB,IAAI,GAAG,cAAP,CAAsB;AAC1C,gBAAI,EAAE,cAAF,CADsC;AAE1C,mBAAO,KAAK,KAAL,CAAW;AAFwB,SAAtB,CAAxB;AAIA,aAAK,gBAAL,CAAsB,MAAtB;AACA,aAAK,QAAL,CAAc,KAAK,gBAAnB,EAAqC,cAArC,EACc,EAAE,OAAF,CAAU,KAAK,eAAf,EAAgC,KAAhC,CADd;;AAGA,aAAK,gBAAL,GAAwB,IAAI,GAAG,cAAP,CAAsB;AAC1C,gBAAI,EAAE,cAAF,CADsC;AAE1C,mBAAO,KAAK,KAAL,CAAW;AAFwB,SAAtB,CAAxB;AAIA,aAAK,gBAAL,CAAsB,MAAtB;AACA,aAAK,QAAL,CAAc,KAAK,gBAAnB,EAAqC,cAArC,EACc,EAAE,OAAF,CAAU,KAAK,eAAf,EAAgC,IAAhC,CADd;;AAGA,aAAK,OAAL,GAAe,EAAE,QAAF,EACV,SADU,CACA,GAAG,WAAH,CAAe,QADf,EAEA,0BAFA,EAE4B,MAF5B,CAAf;;AAIA,aAAK,iBAAL,GAAyB,IAAI,GAAG,oBAAP,EAAzB;AACA,aAAK,iBAAL,CAAuB,MAAvB,GAAgC,GAAhC,CAAoC,SAApC,CAA8C,KAAK,OAAnD;;AAEA,UAAE,eAAF,EAAmB,WAAnB,CAA+B,SAA/B;AACA,UAAE,uBAAF,EAA2B,cAA3B,CAA0C,KAAK,KAA/C,EAC0C,iBAD1C;;AAGA,aAAK,QAAL,CAAc,EAAd,aAA2B,KAAK,GAAhC,EACiB,EAAE,cAAF,CAAiB,KAAK,eAAL,CAAqB,IAArB,CAA0B,IAA1B,CAAjB,CADjB;;AAGA;;;;AAIA,YAAI,KAAK,KAAL,CAAW,eAAX,CAA2B,MAA3B,GAAoC,CAAxC,EAA2C;AACvC,iBAAK,KAAL,CAAW,eAAX,CAA2B,IAA3B,CACI;AAAA,uBAAkB,OAAK,sBAAL,CAA4B,cAA5B,CAAlB;AAAA,aADJ;AAEA,cAAE,SAAF,CAAY,YAAZ,EAA0B,KAA1B;AACH;;AAED,eAAO,IAAP;AACH,KA3RgD;;;AA6RjD;;;;;;;;;;;;;;;;;;;AAmBA,iBAhTiD,yBAgTnC,cAhTmC,EAgTP;AAAA;;AAAA,YAAZ,OAAY,uEAAJ,EAAI;;AACtC,UAAE,SAAF,CAAY,YAAZ,EAA0B,GAA1B,CAA8B,YAAM;AAChC,gBAAM,aAAa,eAAe,GAAf,CAAmB,YAAnB,CAAnB;;AAEA,gBAAI,CAAC,QAAQ,WAAT,IAAwB,YAAU,UAAV,EAAwB,MAAxB,KAAmC,CAA/D,EAAkE;AAC9D;;;;AAIA,uBAAK,eAAL,CAAqB,cAArB;AACH,aAND,MAMO;AACH;;;;AAIA,oBAAM,SAAU,QAAQ,WAAR,GACE,OADF,GAEE,kBAFlB;;AAIA,+BAAe,eAAf,CAA+B;AAC3B,8BAAU,uBAAO;AACb,4BAAM,aAAa,EAAE,SAAS,UAAX,EACd,MADc,EAAnB;;AAGA,4BAAI,WAAW,MAAX,KAAsB,CAA1B,EAA6B;AACzB;;;;;AAKA;AACH;;AAED,mCAAW,IAAX;;AAEA;;;;;;;;;;;AAWA,mCAAW,CAAX,EAAc,SAAd,GAA0B,IAAI,YAA9B;AACA,+BAAK,eAAL,CAAqB,cAArB;AACH;AA7B0B,iBAA/B,UA8BS,OA9BT;AA+BH;AACJ,SAlDD;AAmDH,KApWgD;;;AAsWjD;;;;;;;;;;;;;;AAcA,mBApXiD,2BAoXjC,cApXiC,EAoXjB;AAAA;;AAC5B,YAAM,cAAc,SAAS,eAAe,GAAf,CAAmB,YAAnB,CAA7B;AACA,YAAM,MAAM,QAAM,WAAN,CAAZ;;AAEA,YAAI,IAAI,MAAJ,KAAe,CAAnB,EAAsB;AAClB;;;;AAIA,cAAE,SAAF,CAAY,YAAZ,EAA0B,IAA1B;AACA;AACH;;AAED,YAAM,qBAAqB,IAAI,GAAG,kBAAP,CAA0B;AACjD,gBAAI,GAD6C;AAEjD,mBAAO;AAF0C,SAA1B,CAA3B;;AAKA,aAAK,kBAAL,CAAwB,OAAxB,CAAgC,KAAK,oBAAL,CAA0B,MAA1D,EACgC,kBADhC;;AAGA,aAAK,oBAAL,CAA0B,IAA1B,CAA+B,kBAA/B;AACA,2BAAmB,MAAnB;AACA,2BAAmB,GAAnB,CAAuB,MAAvB,GAAgC,IAAhC;;AAEA,aAAK,QAAL,CAAc,kBAAd,EAAkC,aAAlC,EAAiD,YAAM;AACnD,mBAAK,kBAAL,CAAwB,eAAe,GAAf,CAAmB,MAAnB,EAA2B,GAA3B,CAA+B,OAA/B,CAAxB;AACH,SAFD;;AAIA,aAAK,QAAL,CAAc,kBAAd,EAAkC,cAAlC,EAAkD,gBAAQ;AACtD,mBAAK,kBAAL,CAAwB,IAAxB,EAA8B,KAA9B;AACH,SAFD;;AAIA,aAAK,QAAL,CAAc,kBAAd,EAAkC,iBAAlC,EAAqD,gBAAQ;AACzD,mBAAK,YAAL,CAAkB,OAAK,CAAL,eAAmB,IAAnB,OAAlB;AACH,SAFD;;AAIA;AACA,aAAK,cAAL,CAAoB,mBAAmB,GAAvC;;AAEA,aAAK,QAAL,CAAc,kBAAd,EAAkC,uBAAlC,EAA2D,YAAM;AAC7D;AACA,mBAAK,gBAAL,CACI,EAAE,OAAK,SAAL,CAAe,OAAK,oBAApB,CAAF,CADJ;AAEH,SAJD;;AAMA,YAAI,KAAK,kBAAT,EAA6B;AACzB;AACA,gBAAI,UACA,EAAE,SAAS,iBAAT,CAA2B,KAAK,kBAAhC,CAAF,CADJ;;AAGA;;;;;;AAMA,gBAAM,WAAW,KAAK,kBAAL,CAAwB,KAAxB,CAA8B,GAA9B,CAAjB;;AAEA,gBAAI,QAAQ,MAAR,KAAmB,CAAnB,IACA,SAAS,MAAT,KAAoB,CADpB,IAEA,gBAAgB,SAAS,CAAT,CAFpB,EAEiC;AAC7B,0BAAU,EAAE,KAAK,cAAL,CAAoB;AAC5B,gCAAY,KAAK;AADW,iBAApB,CAAF,CAAV;;AAIA,mCAAmB,GAAnB,CACK,IADL,gBACsB,SAAS,CAAT,CADtB,UAES,QAFT,CAEkB,kBAFlB,EAGS,MAHT,CAGgB,OAHhB;AAIH;;AAED,gBAAI,QAAQ,MAAR,KAAmB,CAAvB,EAA0B;AACtB,qBAAK,YAAL,CAAkB,OAAlB;AACA,qBAAK,kBAAL,GAA0B,IAA1B;AACH;AACJ;;AAED,aAAK,QAAL,CAAc,kBAAd,EAAkC,oBAAlC,EAAwD,YAAM;AAC1D,mBAAK,aAAL,CAAmB,cAAnB,EAAmC,EAAC,aAAa,IAAd,EAAnC;AACA,cAAE,SAAF,CAAY,YAAZ,EAA0B,KAA1B;AACH,SAHD;;AAKA,UAAE,SAAF,CAAY,YAAZ,EAA0B,IAA1B;AACH,KAxcgD;;;AA0cjD;;;;;;;;;;;;;;;;;;;AAmBA,gBA7diD,wBA6dpC,OA7doC,EA6d3B,MA7d2B,EA6dnB;AAC1B,YAAI,CAAC,OAAD,IAAY,QAAQ,MAAR,KAAmB,CAA/B,IACA,QAAQ,MAAR,GAAiB,EAAjB,CAAoB,SAApB,CADJ,EACoC;AAChC,mBAAO,KAAP;AACH;;AAED,YAAI,WAAW,KAAf,EAAsB;AAClB,gBAAM,MAAM,CACR,KAAK,cAAL,EADQ,EAER,SAAS,MAFD,EAGR,GAHQ,EAIR,QAAQ,IAAR,CAAa,MAAb,CAJQ,EAKV,IALU,CAKL,EALK,CAAZ;;AAOA,iBAAK,MAAL,CAAY,QAAZ,CAAqB,GAArB,EAA0B;AACtB,yBAAS,IADa;AAEtB,yBAAS;AAFa,aAA1B;;AAKA,gBAAI,eAAe,KAAK,sBAAxB;;AAEA,gBAAI,GAAG,qBAAH,CAAyB,QAA7B,EAAuC;AACnC,gCAAgB,GAAG,qBAAH,CAAyB,QAAzB,CAAkC,SAAlC,EAAhB;AACH;;AAED,iBAAK,QAAL,CAAc,SAAd,CAAwB,QAAQ,MAAR,GAAiB,GAAjB,GAAuB,YAA/C;AACH;;AAED,aAAK,gBAAL,CAAsB,OAAtB;;AAEA,aAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAAK,SAAL,CAAe,MAAnC,EAA2C,GAA3C,EAAgD;AAC5C,gBAAI,KAAK,SAAL,CAAe,CAAf,MAAsB,QAAQ,CAAR,CAA1B,EAAsC;AAClC,qBAAK,oBAAL,GAA4B,CAA5B;AACA;AACH;AACJ;;AAED,eAAO,IAAP;AACH,KAngBgD;;;AAqgBjD;;;;;;;;;;;;;;;;AAgBA,sBArhBiD,8BAqhB9B,IArhB8B,EAqhBxB,MArhBwB,EAqhBhB;AAC7B,eAAO,KAAK,YAAL,CAAkB,EAAE,SAAS,iBAAT,CAA2B,IAA3B,CAAF,CAAlB,EAAuD,MAAvD,CAAP;AACH,KAvhBgD;;;AAyhBjD;;;;;;;AAOA,oBAhiBiD,4BAgiBhC,OAhiBgC,EAgiBvB;AACtB,aAAK,iBAAL,GACI,QAAQ,OAAR,CAAgB,OAAhB,EACC,GADD,CACK,QAAQ,OAAR,CAAgB,OAAhB,CADL,CADJ;AAGA,aAAK,iBAAL,CAAuB,SAAvB,CAAiC,KAAK,iBAAtC;AACH,KAriBgD;;;AAuiBjD;;;;;;;;;;;;;AAaA,kBApjBiD,0BAojBlC,MApjBkC,EAojB1B;AACnB,aAAK,SAAL,GAAiB,KAAK,SAAL,CAAe,GAAf,CAAmB,OAAO,IAAP,CAAY,YAAZ,CAAnB,CAAjB;;AAEA;AACA,YAAI,KAAK,oBAAL,KAA8B,CAAC,CAA/B,IAAoC,KAAK,SAAL,CAAe,MAAf,GAAwB,CAAhE,EAAmE;AAC/D,iBAAK,oBAAL,GAA4B,CAA5B;AACA,iBAAK,gBAAL,CACI,EAAE,KAAK,SAAL,CAAe,KAAK,oBAApB,CAAF,CADJ;AAEH;AACJ,KA7jBgD;;;AA+jBjD;;;;;;;;;;;;;;;;;;;;;;AAsBA,kBArlBiD,0BAqlBlC,GArlBkC,EAqlB7B,WArlB6B,EAqlBhB;AAC7B,aAAK,IAAI,IAAI,KAAK,oBAAL,GAA4B,GAAzC,EACK,KAAK,CAAL,IAAU,IAAI,KAAK,SAAL,CAAe,MADlC,EAEK,KAAK,GAFV,EAEe;AACX,gBAAM,UAAU,EAAE,KAAK,SAAL,CAAe,CAAf,CAAF,CAAhB;;AAEA,gBAAI,QAAQ,OAAR,CAAgB,IAAhB,EAAsB,QAAtB,CAA+B,QAA/B,CAAJ,EAA8C;AAC1C;AACH;;AAED,gBAAM,cAAc,KAAK,cAApB,IACA,QAAQ,QAAR,CAAiB,oBAAjB,CADD,IAEE,cAAc,KAAK,WAApB,IACA,QAAQ,QAAR,CAAiB,aAAjB,CAHD,IAIE,cAAc,KAAK,YAApB,IACA,QAAQ,QAAR,CAAiB,cAAjB,CALL,EAKwC;AACpC,uBAAO,OAAP;AACH;AACJ;;AAED,eAAO,IAAP;AACH,KA1mBgD;;;AA4mBjD;;;AAGA,uBA/mBiD,iCA+mB3B;AAClB,aAAK,YAAL,CAAkB,KAAK,cAAL,CAAoB,KAAK,eAAzB,EACoB,KAAK,WADzB,CAAlB;AAEH,KAlnBgD;;;AAonBjD;;;AAGA,mBAvnBiD,6BAunB/B;AACd,aAAK,YAAL,CAAkB,KAAK,cAAL,CAAoB,KAAK,cAAzB,EACoB,KAAK,WADzB,CAAlB;AAEH,KA1nBgD;;;AA4nBjD;;;AAGA,uBA/nBiD,iCA+nB3B;AAClB,aAAK,YAAL,CACI,KAAK,cAAL,CAAoB,KAAK,eAAzB,EACoB,KAAK,YAAL,GAAoB,KAAK,WAD7C,CADJ;AAGH,KAnoBgD;;;AAqoBjD;;;AAGA,mBAxoBiD,6BAwoB/B;AACd,aAAK,YAAL,CACI,KAAK,cAAL,CAAoB,KAAK,cAAzB,EACoB,KAAK,YAAL,GAAoB,KAAK,WAD7C,CADJ;AAGH,KA5oBgD;;;AA8oBjD;;;AAGA,0BAjpBiD,oCAipBxB;AACrB,aAAK,YAAL,CACI,KAAK,cAAL,CAAoB,KAAK,eAAzB,EAA0C,KAAK,cAA/C,CADJ;AAEH,KAppBgD;;;AAspBjD;;;AAGA,sBAzpBiD,gCAypB5B;AACjB,aAAK,YAAL,CACI,KAAK,cAAL,CAAoB,KAAK,cAAzB,EAAyC,KAAK,cAA9C,CADJ;AAEH,KA5pBgD;;;AA8pBjD;;;AAGA,qBAjqBiD,+BAiqB7B;AAChB,aAAK,YAAL,CAAkB,EAAE,KAAK,SAAL,CAAe,KAAK,oBAApB,CAAF,CAAlB;AACH,KAnqBgD;;;AAqqBlD;;;AAGC,kBAxqBiD,4BAwqBhC;AACb,YAAM,UAAU,KAAK,iBAAL,CAAuB,CAAvB,EAA0B,EAA1C;AACA,YAAM,eAAe,SAAS,cAAT,CAAwB,OAAxB,CAArB;;AAEA,YAAI,YAAJ,EAAkB;AACd,gBAAM,eAAe,aAAa,oBAAb,CAAkC,IAAlC,CAArB;AACA,gBAAM,eAAe,aAAa,CAAb,EAAgB,YAAhB,CAA6B,MAA7B,CAArB;AACA,gBAAM,YAAY,aAAa,CAAb,EAAgB,KAAhB,CAAsB,CAAtB,CAAlB;AACA,gBAAM,aAAa,aAAa,aAAa,MAAb,GAAsB,CAAnC,EACd,YADc,CACD,MADC,CAAnB;AAEA,gBAAM,UAAU,aAAa,aAAa,MAAb,GAAsB,CAAnC,EAAsC,KAAtC,CAA4C,CAA5C,CAAhB;;AAEA,iBAAK,oBAAL,CAA0B,OAA1B,CAAkC,8BAAsB;AACpD,oBAAI,EAAE,QAAF,CAAW,mBAAmB,EAA9B,EAAkC,SAAlC,CAAJ,EAAiD;AAC7C,uCAAmB,aAAnB,CAAiC,YAAjC,EAA+C,UAA/C,EACiC,SADjC,EAC4C,OAD5C;AAEH;AACJ,aALD;AAMH;AACJ,KA3rBgD;;;AA6rBjD;;;;;;;AAOA,+BApsBiD,yCAosBnB;AAC1B,aAAK,oBAAL,CAA0B,OAA1B,CACI;AAAA,mBAAQ,KAAK,0BAAL,EAAR;AAAA,SADJ;;AAGA,aAAK,UAAL,CAAgB,IAAhB,CAAqB,KAArB,EAA4B,MAA5B;;AAEA,eAAO,KAAP;AACH,KA3sBgD;;;AA6sBjD;;;;;;;;;;AAUA,8BAvtBiD,wCAutBpB;AACzB,aAAK,UAAL,CAAgB,IAAhB,CAAqB,KAArB,EAA4B,MAA5B;AACA,WAAG,WAAH,CAAe,QAAf,CAAwB,UAAxB,CAAmC,0BAAnC;;AAEA,eAAO,KAAP;AACH,KA5tBgD;;;AA8tBjD;;;;;;;;;;AAUA,0BAxuBiD,kCAwuB1B,cAxuB0B,EAwuBV;AACnC,YAAM,OAAO,eAAe,GAAf,CAAmB,MAAnB,CAAb;;AAEA,aAAK,OAAL,CAAa,MAAb,CAAoB,KAAK,kBAAL,CAAwB;AACxC,gBAAI,KAAK,EAD+B;AAExC,qBAAS,KAAK,GAAL,CAAS,OAAT,CAF+B;AAGxC,sBAAU,KAAK,GAAL,CAAS,eAAT;AAH8B,SAAxB,CAApB;;AAMA,aAAK,aAAL,CAAmB,cAAnB;AACH,KAlvBgD;;;AAovBjD;;;;;AAKA,mBAzvBiD,6BAyvB/B;AACd,aAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAAK,oBAAL,CAA0B,MAA9C,EAAsD,GAAtD,EAA2D;AACvD,iBAAK,oBAAL,CAA0B,CAA1B,EAA6B,YAA7B;AACH;;AAED,aAAK,iBAAL,CAAuB,YAAvB;AACH,KA/vBgD;;;AAiwBjD;;;;;;;;;AASA,uBA1wBiD,+BA0wB7B,SA1wB6B,EA0wBlB;AAC3B,YAAM,OAAO,UAAU,CAAV,CAAb;AACA,YAAM,MAAM,UAAU,CAAV,CAAZ;;AAEA,YAAI,SAAS,CAAb,EAAgB;AACZ,iBAAK,MAAL,CAAY,QAAZ,CAAwB,GAAxB,QAAgC,EAAC,SAAS,IAAV,EAAhC;AACH,SAFD,MAEO;AACH,iBAAK,MAAL,CAAY,QAAZ,CAAwB,IAAxB,SAAgC,GAAhC,QAAwC,EAAC,SAAS,IAAV,EAAxC;AACH;AACJ,KAnxBgD;;;AAqxBjD;;;;;;;;;;AAUA,kBA/xBiD,4BA+xBhC;AACb,YAAM,WAAW,KAAK,KAAL,CAAW,QAA5B;AACA,YAAM,oBAAoB,SAAS,GAAT,CAAa,mBAAb,CAA1B;;AAEA,YAAI,MAAM,SAAS,GAAT,CAAa,UAAb,CAAV;;AAEA,YAAI,sBAAsB,IAA1B,EAAgC;AAC5B,yBAAW,iBAAX;AACH;;AAED,eAAO,GAAP;AACH,KA1yBgD;;;AA4yBjD;;;;;;;;;;;;AAYA,mBAxzBiD,2BAwzBjC,MAxzBiC,EAwzBzB,IAxzByB,EAwzBnB;AAC1B,YAAM,MAAM,KAAK,cAAL,EAAZ;;AAEA,YAAI,MAAJ,EAAY;AACR,iBAAK,kBAAL,CAAwB,cAAxB,EAAwC,IAAxC;AACH;;AAED,aAAK,MAAL,CAAY,QAAZ,CAAwB,GAAxB,eAAqC,IAArC,EAA6C,EAAC,SAAS,IAAV,EAA7C;AACH;AAh0BgD,CAA7B,CAAxB;AAk0BA,EAAE,MAAF,CAAS,GAAG,kBAAH,CAAsB,SAA/B,EAA0C,GAAG,gBAA7C","file":"diffViewerPageView.js","sourcesContent":["/**\n * Manages the diff viewer page.\n *\n * This provides functionality for the diff viewer page for managing the\n * loading and display of diffs, and all navigation around the diffs.\n */\nRB.DiffViewerPageView = RB.ReviewablePageView.extend({\n    SCROLL_BACKWARD: -1,\n    SCROLL_FORWARD: 1,\n\n    ANCHOR_COMMENT: 1,\n    ANCHOR_FILE: 2,\n    ANCHOR_CHUNK: 4,\n\n    DIFF_SCROLLDOWN_AMOUNT: 15,\n\n    keyBindings: {\n        'aAKP<m': '_selectPreviousFile',\n        'fFJN>': '_selectNextFile',\n        'sSkp,': '_selectPreviousDiff',\n        'dDjn.': '_selectNextDiff',\n        '[x': '_selectPreviousComment',\n        ']c': '_selectNextComment',\n        '\\x0d': '_recenterSelected',\n        'rR': '_createComment',\n    },\n\n    events: _.extend({\n        'click .toggle-whitespace-only-chunks': '_toggleWhitespaceOnlyChunks',\n        'click .toggle-show-whitespace': '_toggleShowExtraWhitespace',\n    }, RB.ReviewablePageView.prototype.events),\n\n    _fileEntryTemplate: _.template(dedent`\n        <div class=\"diff-container\">\n         <div class=\"diff-box\">\n          <table class=\"sidebyside loading <% if (newFile) { %>newfile<% } %>\"\n                 id=\"file_container_<%- id %>\">\n           <thead>\n            <tr class=\"filename-row\">\n             <th>\n              <span class=\"fa fa-spinner fa-pulse\"></span>\n              <%- filename %>\n             </th>\n            </tr>\n           </thead>\n          </table>\n         </div>\n        </div>\n    `),\n\n    /* Template for code line link anchor */\n    anchorTemplate: _.template(\n        '<a name=\"<%- anchorName %>\" class=\"highlight-anchor\"></a>'),\n\n    /**\n     * Initialize the diff viewer page.\n     */\n    initialize() {\n        const curRevision = this.model.revision.get('revision');\n        const hash = RB.getLocationHash();\n        const search = document.location.search || '';\n\n        RB.ReviewablePageView.prototype.initialize.apply(this, arguments);\n\n        this._selectedAnchorIndex = -1;\n        this._$window = $(window);\n        this._$anchors = $();\n        this._$controls = null;\n        this._$diffs = null;\n        this._diffReviewableViews = [];\n        this._diffFileIndexView = null;\n        this._highlightedChunk = null;\n\n        /*\n         * Listen for the construction of added DiffReviewables.\n         *\n         * We'll queue up the loading and construction of a view when added.\n         * This will ultimately result in a RB.DiffReviewableView being\n         * constructed, once the data from the server is loaded.\n         */\n        this.listenTo(this.model.diffReviewables, 'add',\n                      this._onDiffReviewableAdded);\n\n        /*\n         * Listen for when we're started and finished populating the list\n         * of DiffReviewables. We'll use these events to clear and start the\n         * diff loading queue.\n         */\n        const diffQueue = $.funcQueue('diff_files');\n\n        this.listenTo(this.model.diffReviewables, 'populating', () => {\n            this._diffReviewableViews.forEach(view => view.remove());\n            this._diffReviewableViews = [];\n            this._$diffs.children('.diff-container').remove();\n            this._highlightedChunk = null;\n\n            diffQueue.clear();\n        });\n        this.listenTo(this.model.diffReviewables, 'populated',\n                      () => diffQueue.start());\n\n        /* Check to see if there's an anchor we need to scroll to. */\n        this._startAtAnchorName = hash || null;\n\n        this.router = new Backbone.Router({\n            routes: {\n                ':revision/': 'revision',\n                ':revision/?page=:page': 'revision',\n            }\n        });\n        this.listenTo(this.router, 'route:revision', (revision, page) => {\n            if (page === undefined) {\n                page = 1;\n            } else {\n                page = parseInt(page, 10);\n            }\n\n            if (revision.indexOf('-') === -1) {\n                this.model.loadDiffRevision({\n                    page: page,\n                    revision: parseInt(revision, 10),\n                });\n            } else {\n                const parts = revision.split('-', 2);\n\n                this.model.loadDiffRevision({\n                    page: page,\n                    revision: parseInt(parts[0], 10),\n                    interdiffRevision: parseInt(parts[1], 10),\n                });\n            }\n        });\n\n        /*\n         * Begin managing the URL history for the page, so that we can\n         * switch revisions and handle pagination while keeping the history\n         * clean and the URLs representative of the current state.\n         *\n         * Note that Backbone will attempt to convert the hash to part of\n         * the page URL, stripping away the \"#\". This will result in a\n         * URL pointing to an incorrect, possible non-existent diff revision.\n         *\n         * We work around that by saving the values for the hash and query\n         * string (up above), and by later replacing the current URL with a\n         * new one that, amongst other things, contains the hash present\n         * when the page was loaded.\n         */\n        Backbone.history.start({\n            pushState: true,\n            hashChange: false,\n            root: `${this.model.get('reviewRequest').get('reviewURL')}diff/`,\n            silent: true,\n        });\n\n        /*\n         * Navigating here accomplishes two things:\n         *\n         * 1. The user may have viewed diff/, and not diff/<revision>/, but\n         *    we want to always show the revision in the URL. This ensures\n         *    we have a URL equivalent to the one we get when clicking\n         *    a revision in the slider.\n         *\n         * 2. We want to add back any hash and query string that was\n         *    stripped away.\n         *\n         * We won't be invoking any routes or storing new history. The back\n         * button will correctly bring the user to the previous page.\n         */\n        let revisionRange = curRevision;\n        const curInterdiffRevision =\n            this.model.revision.get('interdiffRevision');\n\n        if (curInterdiffRevision) {\n            revisionRange += `-${curInterdiffRevision}`;\n        }\n\n        this.router.navigate(`${revisionRange}/${search}#${hash}`, {\n            replace: true,\n            trigger: false,\n        });\n    },\n\n    /**\n     * Remove the view from the page.\n     */\n    remove() {\n        RB.ReviewablePageView.prototype.remove.call(this);\n\n        this._$window.off(`resize.${this.cid}`);\n        this._diffFileIndexView.remove();\n    },\n\n    /**\n     * Render the page and begins loading all diffs.\n     *\n     * Returns:\n     *     RB.DiffViewerPageView:\n     *     This instance, for chaining.\n     */\n    render() {\n        RB.ReviewablePageView.prototype.render.call(this);\n\n        this._$controls = $('#view_controls');\n\n        this._diffFileIndexView = new RB.DiffFileIndexView({\n            el: $('#diff_index'),\n            collection: this.model.files,\n        });\n        this._diffFileIndexView.render();\n\n        this.listenTo(this._diffFileIndexView, 'anchorClicked',\n                      this.selectAnchorByName);\n\n        this._diffRevisionLabelView = new RB.DiffRevisionLabelView({\n            el: $('#diff_revision_label'),\n            model: this.model.revision,\n        });\n        this._diffRevisionLabelView.render();\n\n        this.listenTo(this._diffRevisionLabelView, 'revisionSelected',\n                      this._onRevisionSelected);\n\n        /*\n         * Determine whether we need to show the revision selector. If there's\n         * only one revision, we don't need to add it.\n         */\n        const numDiffs = this.model.get('numDiffs');\n\n        if (numDiffs > 1) {\n            this._diffRevisionSelectorView = new RB.DiffRevisionSelectorView({\n                el: $('#diff_revision_selector'),\n                model: this.model.revision,\n                numDiffs: numDiffs,\n            });\n            this._diffRevisionSelectorView.render();\n\n            this.listenTo(this._diffRevisionSelectorView, 'revisionSelected',\n                          this._onRevisionSelected);\n        }\n\n        this._commentsHintView = new RB.DiffCommentsHintView({\n            el: $('#diff_comments_hint'),\n            model: this.model.commentsHint,\n        });\n        this._commentsHintView.render();\n        this.listenTo(this._commentsHintView, 'revisionSelected',\n                      this._onRevisionSelected);\n\n        this._paginationView1 = new RB.PaginationView({\n            el: $('#pagination1'),\n            model: this.model.pagination,\n        });\n        this._paginationView1.render();\n        this.listenTo(this._paginationView1, 'pageSelected',\n                      _.partial(this._onPageSelected, false));\n\n        this._paginationView2 = new RB.PaginationView({\n            el: $('#pagination2'),\n            model: this.model.pagination,\n        });\n        this._paginationView2.render();\n        this.listenTo(this._paginationView2, 'pageSelected',\n                      _.partial(this._onPageSelected, true));\n\n        this._$diffs = $('#diffs')\n            .bindClass(RB.UserSession.instance,\n                       'diffsShowExtraWhitespace', 'ewhl');\n\n        this._chunkHighlighter = new RB.ChunkHighlighterView();\n        this._chunkHighlighter.render().$el.prependTo(this._$diffs);\n\n        $('#diff-details').removeClass('loading');\n        $('#download-diff-action').bindVisibility(this.model,\n                                                  'canDownloadDiff');\n\n        this._$window.on(`resize.${this.cid}`,\n                         _.throttleLayout(this._onWindowResize.bind(this)));\n\n        /*\n         * Begin creating any DiffReviewableViews needed for the page, and\n         * start loading their contents.\n         */\n        if (this.model.diffReviewables.length > 0) {\n            this.model.diffReviewables.each(\n                diffReviewable => this._onDiffReviewableAdded(diffReviewable));\n            $.funcQueue('diff_files').start();\n        }\n\n        return this;\n    },\n\n    /**\n     * Queue the loading of the corresponding diff.\n     *\n     * When the diff is loaded, it will be placed into the appropriate location\n     * in the diff viewer. The anchors on the page will be rebuilt. This will\n     * then trigger the loading of the next file.\n     *\n     * Args:\n     *     diffReviewable (RB.DiffReviewable):\n     *         The diff reviewable for loading and reviewing the diff.\n     *\n     *     options (object):\n     *         The option arguments that control the behavior of this function.\n     *\n     * Option Args:\n     *     showDeleted (boolean):\n     *         Determines whether or not we want to requeue the corresponding\n     *         diff in order to show its deleted content.\n     */\n    queueLoadDiff(diffReviewable, options={}) {\n        $.funcQueue('diff_files').add(() => {\n            const fileDiffID = diffReviewable.get('fileDiffID');\n\n            if (!options.showDeleted && $(`#file${fileDiffID}`).length === 1) {\n                /*\n                 * We already have this diff (probably pre-loaded), and we\n                 * don't want to requeue it to show its deleted content.\n                 */\n                this._renderFileDiff(diffReviewable);\n            } else {\n                /*\n                 * We either want to queue this diff for the first time, or we\n                 * want to requeue it to show its deleted content.\n                 */\n                const prefix = (options.showDeleted\n                                ? '#file'\n                                : '#file_container_');\n\n                diffReviewable.getRenderedDiff({\n                    complete: xhr => {\n                        const $container = $(prefix + fileDiffID)\n                            .parent();\n\n                        if ($container.length === 0) {\n                            /*\n                             * The revision or page may have changed. There's\n                             * no element to work with. Just ignore this and\n                             * move on to the next.\n                             */\n                            return;\n                        }\n\n                        $container.hide();\n\n                        /*\n                         * jQuery's html() and replaceWith() perform checks of\n                         * the HTML, looking for things like <script> tags to\n                         * determine how best to set the HTML, and possibly\n                         * manipulating the string to do some normalization of\n                         * for cases we don't need to worry about. While this\n                         * is all fine for most HTML fragments, this can be\n                         * slow for diffs, given their size, and is\n                         * unnecessary. It's much faster to just set innerHTML\n                         * directly.\n                         */\n                        $container[0].innerHTML = xhr.responseText;\n                        this._renderFileDiff(diffReviewable);\n                    }\n                }, this, options);\n            }\n        });\n    },\n\n    /**\n     * Set up a diff as DiffReviewableView and renders it.\n     *\n     * This will set up a :js:class:`RB.DiffReviewableView` for the given\n     * diffReviewable. The anchors from this diff render will be stored for\n     * navigation.\n     *\n     * Once rendered and set up, the next diff in the load queue will be\n     * pulled from the server.\n     *\n     * Args:\n     *     diffReviewable (RB.DiffReviewable):\n     *         The reviewable diff to render.\n     */\n    _renderFileDiff(diffReviewable) {\n        const elementName = 'file' + diffReviewable.get('fileDiffID');\n        const $el = $(`#${elementName}`);\n\n        if ($el.length === 0) {\n            /*\n             * The user changed revisions before the file finished loading, and\n             * the target element no longer exists. Just return.\n             */\n            $.funcQueue('diff_files').next();\n            return;\n        }\n\n        const diffReviewableView = new RB.DiffReviewableView({\n            el: $el,\n            model: diffReviewable,\n        });\n\n        this._diffFileIndexView.addDiff(this._diffReviewableViews.length,\n                                        diffReviewableView);\n\n        this._diffReviewableViews.push(diffReviewableView);\n        diffReviewableView.render();\n        diffReviewableView.$el.parent().show();\n\n        this.listenTo(diffReviewableView, 'fileClicked', () => {\n            this.selectAnchorByName(diffReviewable.get('file').get('index'));\n        });\n\n        this.listenTo(diffReviewableView, 'chunkClicked', name => {\n            this.selectAnchorByName(name, false);\n        });\n\n        this.listenTo(diffReviewableView, 'moveFlagClicked', line => {\n            this.selectAnchor(this.$(`a[target=${line}]`));\n        });\n\n        /* We must rebuild this every time. */\n        this._updateAnchors(diffReviewableView.$el);\n\n        this.listenTo(diffReviewableView, 'chunkExpansionChanged', () => {\n            /* The selection rectangle may not update -- bug #1353. */\n            this._highlightAnchor(\n                $(this._$anchors[this._selectedAnchorIndex]));\n        });\n\n        if (this._startAtAnchorName) {\n            /* See if we've loaded the anchor the user wants to start at. */\n            let $anchor =\n                $(document.getElementsByName(this._startAtAnchorName));\n\n            /*\n             * Some anchors are added by the template (such as those at\n             * comment locations), but not all are. If the anchor isn't found,\n             * but the URL hash is indicating that we want to start at a\n             * location within this file, add the anchor.\n             * */\n            const urlSplit = this._startAtAnchorName.split(',');\n\n            if ($anchor.length === 0 &&\n                urlSplit.length === 2 &&\n                elementName === urlSplit[0]) {\n                $anchor = $(this.anchorTemplate({\n                    anchorName: this._startAtAnchorName,\n                }));\n\n                diffReviewableView.$el\n                    .find(`tr[line='${urlSplit[1]}']`)\n                        .addClass('highlight-anchor')\n                        .append($anchor);\n            }\n\n            if ($anchor.length !== 0) {\n                this.selectAnchor($anchor);\n                this._startAtAnchorName = null;\n            }\n        }\n\n        this.listenTo(diffReviewableView, 'showDeletedClicked', () => {\n            this.queueLoadDiff(diffReviewable, {showDeleted: true});\n            $.funcQueue('diff_files').start();\n        });\n\n        $.funcQueue('diff_files').next();\n    },\n\n    /**\n     * Select the anchor at a specified location.\n     *\n     * By default, this will scroll the page to position the anchor near\n     * the top of the view.\n     *\n     * Args:\n     *     $anchor (jQuery):\n     *         The anchor to select.\n     *\n     *     scroll (boolean, optional):\n     *         Whether to scroll the page to the anchor. This defaults to\n     *         ``true``.\n     *\n     * Returns:\n     *     boolean:\n     *     ``true`` if the anchor was found and selected. ``false`` if not\n     *     found.\n     */\n    selectAnchor($anchor, scroll) {\n        if (!$anchor || $anchor.length === 0 ||\n            $anchor.parent().is(':hidden')) {\n            return false;\n        }\n\n        if (scroll !== false) {\n            const url = [\n                this._getCurrentURL(),\n                location.search,\n                '#',\n                $anchor.attr('name'),\n            ].join('');\n\n            this.router.navigate(url, {\n                replace: true,\n                trigger: false,\n            });\n\n            let scrollAmount = this.DIFF_SCROLLDOWN_AMOUNT;\n\n            if (RB.DraftReviewBannerView.instance) {\n                scrollAmount += RB.DraftReviewBannerView.instance.getHeight();\n            }\n\n            this._$window.scrollTop($anchor.offset().top - scrollAmount);\n        }\n\n        this._highlightAnchor($anchor);\n\n        for (let i = 0; i < this._$anchors.length; i++) {\n            if (this._$anchors[i] === $anchor[0]) {\n                this._selectedAnchorIndex = i;\n                break;\n            }\n        }\n\n        return true;\n    },\n\n    /**\n     * Select an anchor by name.\n     *\n     * Args:\n     *     name (string):\n     *         The name of the anchor.\n     *\n     *     scroll (boolean, optional):\n     *         Whether to scroll the page to the anchor. This defaults to\n     *         ``true``.\n     *\n     * Returns:\n     *     boolean:\n     *     ``true`` if the anchor was found and selected. ``false`` if not\n     *     found.\n     */\n    selectAnchorByName(name, scroll) {\n        return this.selectAnchor($(document.getElementsByName(name)), scroll);\n    },\n\n    /**\n     * Highlight a chunk bound to an anchor element.\n     *\n     * Args:\n     *     $anchor (jQuery):\n     *         The anchor to highlight.\n     */\n    _highlightAnchor($anchor) {\n        this._highlightedChunk =\n            $anchor.closest('tbody')\n            .add($anchor.closest('thead'));\n        this._chunkHighlighter.highlight(this._highlightedChunk);\n    },\n\n    /**\n     * Update the list of known anchors.\n     *\n     * This will update the list of known anchors based on all named anchors\n     * in the specified table. This is called after every part of the diff\n     * that is loaded.\n     *\n     * If no anchor is selected, this will try to select the first one.\n     *\n     * Args:\n     *     $table (jQuery):\n     *         The table containing anchors.\n     */\n    _updateAnchors($table) {\n        this._$anchors = this._$anchors.add($table.find('th a[name]'));\n\n        /* Skip over the change index to the first item. */\n        if (this._selectedAnchorIndex === -1 && this._$anchors.length > 0) {\n            this._selectedAnchorIndex = 0;\n            this._highlightAnchor(\n                $(this._$anchors[this._selectedAnchorIndex]));\n        }\n    },\n\n    /**\n     * Return the next navigatable anchor.\n     *\n     * This will take a direction to search, starting at the currently\n     * selected anchor. The next anchor matching one of the types in the\n     * anchorTypes bitmask will be returned. If no anchor is found,\n     * null will be returned.\n     *\n     * Args:\n     *     dir (number):\n     *         The direction to navigate in. This should be\n     *         :js:data:`SCROLL_BACKWARD` or js:data:`SCROLL_FORWARD`.\n     *\n     *     anchorTypes (number):\n     *         A bitmask of types to consider when searching for the next\n     *         anchor.\n     *\n     * Returns:\n     *     jQuery:\n     *     The anchor, if found. If an anchor was not found, ``null`` is\n     *     returned.\n     */\n    _getNextAnchor(dir, anchorTypes) {\n        for (let i = this._selectedAnchorIndex + dir;\n             i >= 0 && i < this._$anchors.length;\n             i += dir) {\n            const $anchor = $(this._$anchors[i]);\n\n            if ($anchor.closest('tr').hasClass('dimmed')) {\n                continue;\n            }\n\n            if (((anchorTypes & this.ANCHOR_COMMENT) &&\n                 $anchor.hasClass('commentflag-anchor')) ||\n                ((anchorTypes & this.ANCHOR_FILE) &&\n                 $anchor.hasClass('file-anchor')) ||\n                ((anchorTypes & this.ANCHOR_CHUNK) &&\n                 $anchor.hasClass('chunk-anchor'))) {\n                return $anchor;\n            }\n        }\n\n        return null;\n    },\n\n    /**\n     * Select the previous file's header on the page.\n     */\n    _selectPreviousFile() {\n        this.selectAnchor(this._getNextAnchor(this.SCROLL_BACKWARD,\n                                              this.ANCHOR_FILE));\n    },\n\n    /**\n     * Select the next file's header on the page.\n     */\n    _selectNextFile() {\n        this.selectAnchor(this._getNextAnchor(this.SCROLL_FORWARD,\n                                              this.ANCHOR_FILE));\n    },\n\n    /**\n     * Select the previous diff chunk on the page.\n     */\n    _selectPreviousDiff() {\n        this.selectAnchor(\n            this._getNextAnchor(this.SCROLL_BACKWARD,\n                                this.ANCHOR_CHUNK | this.ANCHOR_FILE));\n    },\n\n    /**\n     * Select the next diff chunk on the page.\n     */\n    _selectNextDiff() {\n        this.selectAnchor(\n            this._getNextAnchor(this.SCROLL_FORWARD,\n                                this.ANCHOR_CHUNK | this.ANCHOR_FILE));\n    },\n\n    /**\n     * Select the previous comment on the page.\n     */\n    _selectPreviousComment() {\n        this.selectAnchor(\n            this._getNextAnchor(this.SCROLL_BACKWARD, this.ANCHOR_COMMENT));\n    },\n\n    /**\n     * Select the next comment on the page.\n     */\n    _selectNextComment() {\n        this.selectAnchor(\n            this._getNextAnchor(this.SCROLL_FORWARD, this.ANCHOR_COMMENT));\n    },\n\n    /**\n     * Re-center the currently selected area on the page.\n     */\n    _recenterSelected() {\n        this.selectAnchor($(this._$anchors[this._selectedAnchorIndex]));\n    },\n\n   /**\n    * Create a comment for a chunk of a diff\n    */\n    _createComment() {\n        const chunkID = this._highlightedChunk[0].id;\n        const chunkElement = document.getElementById(chunkID);\n\n        if (chunkElement) {\n            const lineElements = chunkElement.getElementsByTagName('tr');\n            const beginLineNum = lineElements[0].getAttribute('line');\n            const beginNode = lineElements[0].cells[2];\n            const endLineNum = lineElements[lineElements.length - 1]\n                .getAttribute('line');\n            const endNode = lineElements[lineElements.length - 1].cells[2];\n\n            this._diffReviewableViews.forEach(diffReviewableView => {\n                if ($.contains(diffReviewableView.el, beginNode)){\n                    diffReviewableView.createComment(beginLineNum, endLineNum,\n                                                     beginNode, endNode);\n                }\n            });\n        }\n    },\n\n    /**\n     * Toggle the display of diff chunks that only contain whitespace changes.\n     *\n     * Returns:\n     *     boolean:\n     *     ``false``, to prevent events from bubbling up.\n     */\n    _toggleWhitespaceOnlyChunks() {\n        this._diffReviewableViews.forEach(\n            view => view.toggleWhitespaceOnlyChunks());\n\n        this._$controls.find('.ws').toggle();\n\n        return false;\n    },\n\n    /**\n     * Toggle the display of extra whitespace highlights on diffs.\n     *\n     * A cookie will be set to the new whitespace display setting, so that\n     * the new option will be the default when viewing diffs.\n     *\n     * Returns:\n     *     boolean:\n     *     ``false``, to prevent events from bubbling up.\n     */\n    _toggleShowExtraWhitespace() {\n        this._$controls.find('.ew').toggle();\n        RB.UserSession.instance.toggleAttr('diffsShowExtraWhitespace');\n\n        return false;\n    },\n\n    /**\n     * Handler for when a RB.DiffReviewable is added.\n     *\n     * This will add a placeholder entry for the file and queue the diff\n     * for loading/rendering.\n     *\n     * Args:\n     *     diffReviewable (RB.DiffReviewable):\n     *         The DiffReviewable that was added.\n     */\n    _onDiffReviewableAdded(diffReviewable) {\n        const file = diffReviewable.get('file');\n\n        this._$diffs.append(this._fileEntryTemplate({\n            id: file.id,\n            newFile: file.get('isnew'),\n            filename: file.get('depotFilename'),\n        }));\n\n        this.queueLoadDiff(diffReviewable);\n    },\n\n    /**\n     * Handler for when the window resizes.\n     *\n     * Triggers a relayout of all the diffs and the chunk highlighter.\n     */\n    _onWindowResize() {\n        for (let i = 0; i < this._diffReviewableViews.length; i++) {\n            this._diffReviewableViews[i].updateLayout();\n        }\n\n        this._chunkHighlighter.updateLayout();\n    },\n\n    /**\n     * Callback for when a new revision is selected.\n     *\n     * This supports both single revisions and interdiffs. If `base` is 0, a\n     * single revision is selected. If not, the interdiff between `base` and\n     * `tip` will be shown.\n     *\n     * This will always implicitly navigate to page 1 of any paginated diffs.\n     */\n    _onRevisionSelected(revisions) {\n        const base = revisions[0];\n        const tip = revisions[1];\n\n        if (base === 0) {\n            this.router.navigate(`${tip}/`, {trigger: true});\n        } else {\n            this.router.navigate(`${base}-${tip}/`, {trigger: true});\n        }\n    },\n\n    /**\n     * Return the current URL.\n     *\n     * This will compute and return the current page's URL (relative to the\n     * router root), not including query parameters or hash locations.\n     *\n     * Returns:\n     *     string:\n     *     The current page URL, given the revision information.\n     */\n    _getCurrentURL() {\n        const revision = this.model.revision;\n        const interdiffRevision = revision.get('interdiffRevision');\n\n        let url = revision.get('revision');\n\n        if (interdiffRevision !== null) {\n            url += `-${interdiffRevision}`;\n        }\n\n        return url;\n    },\n\n    /**\n     * Callback for when a new page is selected.\n     *\n     * Navigates to the same revision with a different page number.\n     *\n     * Args:\n     *     scroll (boolean):\n     *         Whether to scroll to the file index.\n     *\n     *     page (number):\n     *         The page number to navigate to.\n     */\n    _onPageSelected(scroll, page) {\n        const url = this._getCurrentURL();\n\n        if (scroll) {\n            this.selectAnchorByName('index_header', true);\n        }\n\n        this.router.navigate(`${url}/?page=${page}`, {trigger: true});\n    },\n});\n_.extend(RB.DiffViewerPageView.prototype, RB.KeyBindingsMixin);\n"]}