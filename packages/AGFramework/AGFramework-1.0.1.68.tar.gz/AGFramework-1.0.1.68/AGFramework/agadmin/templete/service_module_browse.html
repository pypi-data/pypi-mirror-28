{% extends "base.html" %}
{% block content %}
<section id="main-content">
    <section class="wrapper">
        <!-- //market-->
        <div class="panel panel-default">
            <div class="panel-heading" >
                <span style="font-size:28px;">
                    服务管理
                </span>
            </div>
            <div class="panel-body">
                <div class="market-updates">
                    <table class="table table-condensed">
                      <thead>
                        <td>模块名称</td>
                        <td>状态</td>
                        <td>操作</td>
                        <td>删除</td>
                      </thead>
                      {% for item in _module_state_arr %}
                        <tr>
                            <td><a href="ServiceModuleEdit?module_name={{ item['name'] }}">{{ item['name'] }}</a></td>
                            <td>
                                    <span class="glyphicon {% if item['is_run'] %}glyphicon-play{% else %}glyphicon-stop{% endif %}"></span>
                            <td>
                                <button type="button" class="btn btn-default btn-sm" onclick="javascript:restart_service('{{ item['name'] }}');">
                                    <span class="glyphicon glyphicon-play"></span>
                                </button>

                                <button type="button" class="btn btn-default btn-sm" onclick="javascript:stop_service('{{ item['name'] }}');">
                                    <span class="glyphicon glyphicon-stop"></span>
                                </button>
                                &nbsp;&nbsp;&nbsp;&nbsp;
                                <button type="button" class="btn btn-default btn-sm" onclick="javascript:refresh_service();">
                                    <span class="glyphicon glyphicon-refresh"></span>
                                </button>
                            </td>
                            <td>
                                <button type="button" class="btn btn-default btn-sm" onclick="javascript:del_service('{{ item['name'] }}');">
                                    <span class="glyphicon glyphicon-remove"></span>
                                </button>
                            </td>
                        </tr>
                      {% endfor %}
                    </table>
                     <div class="clearfix"> </div>
                </div>
                <div class="market-updates">
                    <div class="clearfix"> </div>
                </div>
            </div>
        </div>
    </section>

    <div class="footer">
        <div class="wthree-copyright">
            <p>Copyright &copy; 2017.TTFramework All rights reserved.<a target="_blank" href="#"></a></p>
        </div>
    </div>

</section>

{% endblock %}
{% block js %}
<script type="text/javascript">
    function stop_service(module_name){
        $.ajax({
            url:"rest_stop_service",
            data:{
                  "module_name":module_name
                  },
            async:true,
            type:"POST",
            success:function (data) {
                if (data.state == 'success'){
                    window.location.reload();
                }else {
                    alert('停止失败:' + data.message);
                }
            },
            error:function (err) {
                console.log(err);
            }
      });
    }
    function restart_service(module_name){
       $.ajax({
            url:"rest_restart_service",
            data:{
                  "module_name":module_name
                  },
            async:true,
            type:"POST",
            success:function (data) {
                if (data.state == 'success'){
                    window.location.reload();
                }else {
                    alert('启动失败:' + data.message);
                }
            },
            error:function (err) {
                console.log(err);
            }
       });
    }
    function del_service(module_name){
        $.ajax({
            url:"rest_delete_service",
            data:{
                  "module_name":module_name
                  },
            async:true,
            type:"POST",
            success:function (data) {
                if (data.state == 'success'){
                    window.location.reload();
                }else {
                    alert('删除失败:' + data.message);
                }
            },
            error:function (err) {
                console.log(err);
            }
       });
    }
    function refresh_service(){
        window.location.reload();
    }
    $(document).ready(function(){

    });
</script>
{% endblock %}
