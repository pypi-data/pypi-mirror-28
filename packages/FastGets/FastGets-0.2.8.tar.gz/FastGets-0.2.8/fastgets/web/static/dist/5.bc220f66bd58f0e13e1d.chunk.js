webpackJsonp([5],{246:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(837),a=r.n(n),o=r(838),s=r.n(o),l=r(1),i=!1,c=null,u=null,p=null,m=l(a.a,s.a,i,c,u,p);e.default=m.exports},837:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){var t=this;return{showModal:!1,currentTemplate:null,trigger:"",columns:[{title:"#",type:"index",width:50,align:"center"},{title:"名称",key:"name",render:function(e,r){return r.row.process?e("div",{},[e("span",r.row.name),e("Tag",{props:{size:"small",color:"green",type:"border"},style:{float:"right"}},"正在运行")]):e("div",{},[e("span",r.row.name),e("Button",{props:{size:"small"},style:{float:"right"},on:{click:function(){t.runTemplate(r.row.name)}}},"启动")])}},{title:"描述",key:"description"},{title:"定时任务配置",key:"trigger",render:function(e,r){return r.row.job?e("div",{},[e("span",r.row.job.trigger),e("Button",{props:{type:"error",size:"small"},style:{float:"right"},on:{click:function(){t.deleteJob(r.row.job.id)}}},"取消")]):e("span",{},"-")}},{title:"下次运行时间",key:"next",render:function(t,e){return e.row.job?t("span",e.row.job.next_run_at):t("span","-")}},{title:"操作",key:"action",render:function(e,r){return e("div",[e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){t.showModal=!0,t.currentTemplate=r.row,t.trigger=t.currentTemplate.job?t.currentTemplate.job.trigger:null}}},"配置")])}}],templates:[],cron_templates:[],running_templates:[]}},methods:{setTrigger:function(t){this.trigger=t},runTemplate:function(t){var e=this;this.$axios.get("/process/add",{params:{name:t,type:"template"}}).then(function(t){0===t.data.error_code?e.fetchTemplates():alert(t.data.error_msg)})},addJob:function(){var t=this;this.$axios.get("/job/add",{params:{name:this.currentTemplate.name,trigger:this.trigger,type:"template"}}).then(function(e){0===e.data.error_code?t.fetchTemplates():alert(e.data.error_msg)})},deleteJob:function(t){var e=this;this.$axios.get("/job/delete",{params:{id:t,type:"template"}}).then(function(t){0===t.data.error_code?e.fetchTemplates():alert(t.data.error_msg)})},fetchTemplates:function(){var t=this;this.$axios.get("/template/list").then(function(e){t.templates=e.data.templates,t.cron_templates=[],t.running_templates=[],t.templates.forEach(function(e){e.job&&t.cron_templates.push(e),e.process&&t.running_templates.push(e)})})}},created:function(){this.fetchTemplates()}}},838:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Row",{staticClass:"margin-top-10"},[r("Modal",{attrs:{title:"配置定时任务"},on:{"on-ok":t.addJob},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[r("p",[r("Input",{model:{value:t.trigger,callback:function(e){t.trigger=e},expression:"trigger"}})],1),t._v(" "),r("br"),t._v(" "),r("p",[r("Button",{attrs:{size:"small",type:"ghost"},on:{click:function(){return t.setTrigger("0 3 1 * *")}}},[t._v("monthly")]),t._v(" "),r("Button",{attrs:{size:"small",type:"ghost"},on:{click:function(){return t.setTrigger("0 3 * * WED")}}},[t._v("weekly")]),t._v(" "),r("Button",{attrs:{size:"small",type:"ghost"},on:{click:function(){return t.setTrigger("0 3 * * *")}}},[t._v("daily")]),t._v(" "),r("Button",{attrs:{size:"small",type:"ghost"},on:{click:function(){return t.setTrigger("0 * * * *")}}},[t._v("hourly")])],1)]),t._v(" "),r("Card",[r("Row",[r("Col",{attrs:{span:"24"}},[r("Tabs",{attrs:{animated:!1}},[r("TabPane",{attrs:{label:"全部模板"}},[r("Table",{attrs:{stripe:"",border:"",columns:t.columns,data:t.templates}})],1),t._v(" "),r("TabPane",{attrs:{label:"已配置"}},[r("Table",{attrs:{stripe:"",border:"",columns:t.columns,data:t.cron_templates}})],1),t._v(" "),r("TabPane",{attrs:{label:"正在运行"}},[r("Table",{attrs:{stripe:"",border:"",columns:t.columns,data:t.running_templates}})],1),t._v(" "),r("Button",{attrs:{slot:"extra",type:"ghost",size:"small"},on:{click:t.fetchTemplates},slot:"extra"},[t._v("刷新")])],1)],1)],1)],1)],1)},a=[],o={render:n,staticRenderFns:a};e.default=o}});