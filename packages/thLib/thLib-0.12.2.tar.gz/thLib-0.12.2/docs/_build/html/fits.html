
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Fits &#8212; thLib 0.12.2 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.12.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/thLib.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Signal Processing Utilities" href="signals.html" />
    <link rel="prev" title="thLib - Documentation" href="index.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="signals.html" title="Signal Processing Utilities"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="thLib - Documentation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">thLib 0.12.2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="fits">
<span id="fit-label"></span><h1>Fits<a class="headerlink" href="#fits" title="Permalink to this headline">¶</a></h1>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="#fits.demo_ransac" title="fits.demo_ransac"><code class="xref py py-func docutils literal"><span class="pre">fits.demo_ransac()</span></code></a> … RANSAC fit of best circle in image</li>
<li><a class="reference internal" href="#fits.fit_circle" title="fits.fit_circle"><code class="xref py py-func docutils literal"><span class="pre">fits.fit_circle()</span></code></a> … basic circle fit</li>
<li><a class="reference internal" href="#fits.fit_ellipse" title="fits.fit_ellipse"><code class="xref py py-func docutils literal"><span class="pre">fits.fit_ellipse()</span></code></a> … ellipse fit (Taubin’s method)</li>
<li><a class="reference internal" href="#fits.fit_exp" title="fits.fit_exp"><code class="xref py py-func docutils literal"><span class="pre">fits.fit_exp()</span></code></a> … exponential fit</li>
<li><a class="reference internal" href="#fits.fit_line" title="fits.fit_line"><code class="xref py py-func docutils literal"><span class="pre">fits.fit_line()</span></code></a> … linear regression fit, complete with confidence intervals for mean and values, and with plotting</li>
<li><a class="reference internal" href="#fits.fit_sin" title="fits.fit_sin"><code class="xref py py-func docutils literal"><span class="pre">fits.fit_sin()</span></code></a> … sine fit</li>
<li><a class="reference internal" href="#fits.regress" title="fits.regress"><code class="xref py py-func docutils literal"><span class="pre">fits.regress()</span></code></a> … regression fit, similar to MATLAB</li>
</ul>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="module-fits">
<span id="details"></span><h2>Details<a class="headerlink" href="#module-fits" title="Permalink to this headline">¶</a></h2>
<p>Collection of fitting functions</p>
<dl class="function">
<dt id="fits.demo_ransac">
<code class="descclassname">fits.</code><code class="descname">demo_ransac</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fits.html#demo_ransac"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fits.demo_ransac" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the best-fit circle in an image, using the RANSAC algorithm</p>
</dd></dl>

<dl class="function">
<dt id="fits.fit_circle">
<code class="descclassname">fits.</code><code class="descname">fit_circle</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fits.html#fit_circle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fits.fit_circle" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the best-fit circle to given datapoints.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array (N,)</p>
<blockquote>
<div><p>x-values.</p>
</div></blockquote>
<p><strong>y</strong> : array (N,)</p>
<blockquote>
<div><p>corresponding y-values.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>center</strong> : array (2,)</p>
<blockquote>
<div><p>x/y coordinates of center of the circle</p>
</div></blockquote>
<p><strong>radius</strong> : float</p>
<blockquote class="last">
<div><p>Circle radius.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span><span class="mi">10</span><span class="n">j</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">+</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">+</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cFit</span><span class="p">,</span><span class="n">rFit</span> <span class="o">=</span> <span class="n">thLib</span><span class="o">.</span><span class="n">fits</span><span class="o">.</span><span class="n">fit_circle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="fits.fit_ellipse">
<code class="descclassname">fits.</code><code class="descname">fit_ellipse</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fits.html#fit_ellipse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fits.fit_ellipse" title="Permalink to this definition">¶</a></dt>
<dd><p>Ellipse fit by Taubin’s Method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array</p>
<blockquote>
<div><p>x-coordinates of the ellipse points</p>
</div></blockquote>
<p><strong>y</strong> : array</p>
<blockquote>
<div><p>y-coordinates of the ellipse points</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>A</strong> : array</p>
<blockquote class="last">
<div><p>Ellipse parameters
A = [a b c d e f]
is the vector of algebraic parameters of thefitting ellipse:
ax^2 + bxy + cy^2 +dx + ey + f = 0
The vector A is normed, so that ||A||=1.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Among fast non-iterative ellipse fitting methods, 
this is perhaps the most accurate and robust.</p>
<p>This method fits a quadratic curve (conic) to a set of points;
if points are better approximated by a hyperbola, this fit will 
return a hyperbola. To fit ellipses only, use “Direct Ellipse Fit”.</p>
<p>Published in
G. Taubin, “Estimation Of Planar Curves, Surfaces And Nonplanar
Space Curves Defined By Implicit Equations, With 
Applications To Edge And Range Image Segmentation”,
IEEE Trans. PAMI, Vol. 13, pages 1115-1138, (1991)</p>
</dd></dl>

<dl class="function">
<dt id="fits.fit_exp">
<code class="descclassname">fits.</code><code class="descname">fit_exp</code><span class="sig-paren">(</span><em>tFit</em>, <em>yFit</em>, <em>plotFlag=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fits.html#fit_exp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fits.fit_exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates best-fit parameters for the exponential decay to an offset.
This can serve as an example for a general non-linear fit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tFit</strong> : array (N,)</p>
<blockquote>
<div><p>Time values.</p>
</div></blockquote>
<p><strong>yFit</strong> : array (N,)</p>
<blockquote>
<div><p>Function values</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>offset</strong> : float</p>
<blockquote>
<div><p>Function offset/bias.</p>
</div></blockquote>
<p><strong>amp</strong> : float</p>
<blockquote>
<div><p>Amplitude of exponential function</p>
</div></blockquote>
<p><strong>tau</strong> : float</p>
<blockquote class="last">
<div><p>Decay time.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span> <span class="o">=</span> <span class="mf">2.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="mf">2.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">amp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>    
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted</span> <span class="o">=</span>  <span class="n">thLib</span><span class="o">.</span><span class="n">fits</span><span class="o">.</span><span class="n">fit_exp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="fits.fit_line">
<code class="descclassname">fits.</code><code class="descname">fit_line</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>alpha=0.05</em>, <em>newx=[]</em>, <em>plotFlag=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fits.html#fit_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fits.fit_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear regression fit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : ndarray</p>
<blockquote>
<div><p>Input / Predictor.</p>
</div></blockquote>
<p><strong>y</strong> : ndarray</p>
<blockquote>
<div><p>Input / Estimator.</p>
</div></blockquote>
<p><strong>alpha</strong> : float</p>
<blockquote>
<div><p>Confidence limit [default=0.05]</p>
</div></blockquote>
<p><strong>newx</strong> : float or ndarray</p>
<blockquote>
<div><p>Values for which the fit and the prediction limits are calculated (optional)</p>
</div></blockquote>
<p><strong>plotFlag: int, optional</strong></p>
<blockquote>
<div><p>1 = plot, 0 = no_plot [default]</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>a</strong> : float</p>
<blockquote>
<div><p>Intercept</p>
</div></blockquote>
<p><strong>b</strong> : float</p>
<blockquote>
<div><p>Slope</p>
</div></blockquote>
<p><strong>ci</strong> : ndarray</p>
<blockquote>
<div><p>Lower and upper confidence interval for the slope</p>
</div></blockquote>
<p><strong>info</strong> : dictionary</p>
<blockquote>
<div><p>contains return information on
- residuals
- var_res
- sd_res
- alpha
- tval
- df</p>
</div></blockquote>
<p><strong>newy</strong> : list(ndarray)</p>
<blockquote class="last">
<div><p>Predictions for (newx, newx-ciPrediction, newx+ciPrediction)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Example data and formulas are taken from
D. Altman, “Practical Statistics for Medicine”</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">11</span><span class="n">j</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,(</span><span class="n">ci_a</span><span class="p">,</span> <span class="n">ci_b</span><span class="p">),</span><span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">thLib</span><span class="o">.</span><span class="n">fits</span><span class="o">.</span><span class="n">fit_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>    
<span class="go">Summary: a=-15.0000+/-12.4590, b=10.0000+/-2.1060</span>
<span class="go">Confidence intervals: ci_a=(-27.4590 - -2.5410), ci_b=(7.8940 - 12.1060)</span>
<span class="go">Residuals: variance = 95.3333, standard deviation = 9.7639</span>
<span class="go">alpha = 0.050, tval = 2.2622, df=9</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="fits.fit_sin">
<code class="descclassname">fits.</code><code class="descname">fit_sin</code><span class="sig-paren">(</span><em>tList</em>, <em>yList</em>, <em>freq</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fits.html#fit_sin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fits.fit_sin" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a sine wave with a known frequency to a given set of data.</p>
<p>y = amplitude * sin(2*pi*freq * tList + phase*pi/180) + bias</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>yList</strong> : array</p>
<blockquote>
<div><p>datapoints</p>
</div></blockquote>
<p><strong>tList</strong> : float</p>
<blockquote>
<div><p>time base, in sec</p>
</div></blockquote>
<p><strong>freq</strong> : float</p>
<blockquote>
<div><p>in Hz</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>phase</strong> : float</p>
<blockquote>
<div><p>in degrees</p>
</div></blockquote>
<p><strong>amplitude</strong> : float</p>
<p class="last"><strong>bias</strong> : float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">=</span> <span class="n">thLib</span><span class="o">.</span><span class="n">fits</span><span class="o">.</span><span class="n">fit_sin</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="fits.regress">
<code class="descclassname">fits.</code><code class="descname">regress</code><span class="sig-paren">(</span><em>y</em>, <em>X</em>, <em>alpha=0.05</em>, <em>intercept=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fits.html#regress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fits.regress" title="Permalink to this definition">¶</a></dt>
<dd><p>Multilinear regression and confidence intervals.
Note that by default, an intercept is added to the design matrix!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>X</strong> : ndarray (N,) or (N,p)</p>
<blockquote>
<div><p>predictors at each of N observations</p>
</div></blockquote>
<p><strong>y</strong> : ndarray(N,)</p>
<blockquote>
<div><p>observed responses</p>
</div></blockquote>
<p><strong>alpha</strong> : float, optional</p>
<blockquote>
<div><p>Defines the 100*(1-alpha)% confidence level in ci.
Default alpha=0.05</p>
</div></blockquote>
<p><strong>intercept</strong> : boolean</p>
<blockquote>
<div><p>If ‘True’, an intercept is automatically added to the design matrix.
If ‘False’, the behavior is like the Matlab “regress” function, and
no intercept is added.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fit</strong> : float</p>
<blockquote>
<div><p>best fit intercept and regression parameters</p>
</div></blockquote>
<p><strong>ci</strong> : ndarray (2,)</p>
<blockquote class="last">
<div><p>confidence intervals for the coefficient estimates
at the given alpha level (default: 95%-level)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#fits.fit_line" title="fits.fit_line"><code class="xref py py-obj docutils literal"><span class="pre">fit_line</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="n">ci</span><span class="p">)</span> <span class="o">=</span> <span class="n">thLib</span><span class="o">.</span><span class="n">fits</span><span class="o">.</span><span class="n">regress</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>    
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span> <span class="p">),</span> <span class="n">X</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">pars</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">+=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="n">ci</span><span class="p">)</span> <span class="o">=</span> <span class="n">thLib</span><span class="o">.</span><span class="n">fits</span><span class="o">.</span><span class="n">regress</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">mat</span><span class="p">)</span>    
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/thLib.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Fits</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#module-fits">Details</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">thLib - Documentation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="signals.html"
                        title="next chapter">Signal Processing Utilities</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/fits.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="signals.html" title="Signal Processing Utilities"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="thLib - Documentation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">thLib 0.12.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, thomas haslwanter.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.
    </div>
  </body>
</html>