
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>api.assets.v1.host &#8212; Argus-Toolbelt 1.0 documentation</title>
    <link rel="stylesheet" href="../../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for api.assets.v1.host</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Autogenerated API&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">argus_cli.plugin</span> <span class="k">import</span> <span class="n">register_command</span>


<div class="viewcode-block" id="search_host_assets_simplified"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.search_host_assets_simplified">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span><span class="s1">&#39;host&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">search_host_assets_simplified</span><span class="p">(</span><span class="n">keywords</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">keywordField</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">hostID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">serviceID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">businessProcessID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">customerID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ip</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">protocol</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cpe</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">vulnID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">vulnRef</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">includeFlag</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">excludeFlag</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sortBy</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">keywordMatch</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns as set of HostAssets defined by query parameters. (PUBLIC)</span>

<span class="sd">    </span>

<span class="sd">    :param list keywords: Search by keywords</span>
<span class="sd">    :param list keywordField: Set field strategy for keyword search</span>
<span class="sd">    :param list name: Search by name</span>
<span class="sd">    :param list hostID: Search by HostAsset ID</span>
<span class="sd">    :param list serviceID: Search by ServiceAsset ID</span>
<span class="sd">    :param list businessProcessID: Search by BusinessProcess ID</span>
<span class="sd">    :param list customerID: Search by customer ID</span>
<span class="sd">    :param list ip: Search by IP range</span>
<span class="sd">    :param list port: Search by application port</span>
<span class="sd">    :param list protocol: Search by application protocol</span>
<span class="sd">    :param list cpe: Search by CPE</span>
<span class="sd">    :param list vulnID: Search by vulnerability ID</span>
<span class="sd">    :param list vulnRef: Search by vulnerability reference</span>
<span class="sd">    :param list includeFlag: Include certain HostAssets in the search result based on set flags</span>
<span class="sd">    :param list excludeFlag: Exclude certain HostAssets from the search result based on set flags</span>
<span class="sd">    :param list sortBy: Sort search result</span>
<span class="sd">    :param int offset: Skip a number of results</span>
<span class="sd">    :param int limit: Maximum number of returned results</span>
<span class="sd">    :param str keywordMatch: Set match strategy for keyword search</span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :returns: {&quot;offset&quot;: 700, &quot;limit&quot;: 500, &quot;responseCode&quot;: 200, &quot;count&quot;: 891, &quot;data&quot;: [{&quot;id&quot;: &quot;Make the rate within experience.&quot;, &quot;ownedByUser&quot;: {&quot;id&quot;: 474, &quot;customerID&quot;: 120, &quot;userName&quot;: &quot;matthew59&quot;, &quot;name&quot;: &quot;Michael Eaton&quot;}, &quot;name&quot;: &quot;Patrick Rowe&quot;, &quot;description&quot;: &quot;But painting public pressure support.&quot;, &quot;totalCvss&quot;: 674, &quot;vulnerabilitiesCount&quot;: 606, &quot;createdTimestamp&quot;: 368869034, &quot;createdByUser&quot;: {&quot;id&quot;: 726, &quot;customerID&quot;: 945, &quot;userName&quot;: &quot;ecannon&quot;, &quot;name&quot;: &quot;Maria Mccann&quot;}, &quot;lastUpdatedTimestamp&quot;: 789883740, &quot;lastUpdatedByUser&quot;: {&quot;id&quot;: 298, &quot;customerID&quot;: 669, &quot;userName&quot;: &quot;tara90&quot;, &quot;name&quot;: &quot;Paul White&quot;}, &quot;deletedTimestamp&quot;: 1409145582, &quot;deletedByUser&quot;: {&quot;id&quot;: 312, &quot;customerID&quot;: 565, &quot;userName&quot;: &quot;melaniejackson&quot;, &quot;name&quot;: &quot;Savannah Murray&quot;}, &quot;flags&quot;: [&quot;DELETED_FROM_CVM&quot;], &quot;properties&quot;: {&quot;additionalProperties&quot;: &quot;Green pay personal government white.&quot;}, &quot;firstSeenTimestamp&quot;: 1432484279, &quot;lastSeenTimestamp&quot;: 584590728, &quot;lastScanTimestamp&quot;: 364529281, &quot;ipAddresses&quot;: [{&quot;host&quot;: true, &quot;maskBits&quot;: 942, &quot;ipv6&quot;: false, &quot;multicast&quot;: true, &quot;public&quot;: false, &quot;address&quot;: &quot;Talk no notice trouble that.&quot;}], &quot;aliases&quot;: [{&quot;fqdn&quot;: &quot;Reason past real.&quot;}], &quot;services&quot;: [{&quot;id&quot;: &quot;Method method everyone.&quot;, &quot;name&quot;: &quot;Leslie Brown&quot;}], &quot;applications&quot;: [{&quot;id&quot;: &quot;Education author both talk determine cell thought.&quot;, &quot;name&quot;: &quot;Jenna Jenkins&quot;, &quot;description&quot;: &quot;Less prevent road agree increase like specific recent.&quot;, &quot;createdTimestamp&quot;: 1290910322, &quot;lastUpdatedTimestamp&quot;: 630721363, &quot;deletedTimestamp&quot;: 1301247431, &quot;firstSeenTimestamp&quot;: 1022142152, &quot;lastSeenTimestamp&quot;: 273539809, &quot;flags&quot;: [&quot;DELETED_FROM_CVM&quot;], &quot;properties&quot;: {&quot;additionalProperties&quot;: &quot;Compare shake under oil help too public.&quot;}, &quot;cpe&quot;: &quot;Authority direction responsibility argue way matter.&quot;, &quot;sockets&quot;: [&quot;Walk reduce level wide imagine clearly.&quot;]}], &quot;vulnerabilities&quot;: [{&quot;id&quot;: &quot;Effect white system hope beautiful in.&quot;, &quot;vulnerabilityID&quot;: &quot;Fast up history particular.&quot;, &quot;references&quot;: [&quot;Direction stage investment herself.&quot;], &quot;name&quot;: &quot;Christine Simpson&quot;, &quot;description&quot;: &quot;Occur interesting claim stock.&quot;, &quot;conclusion&quot;: &quot;Program approach drive strong person.&quot;, &quot;solution&quot;: &quot;Staff wait story six.&quot;, &quot;rawOutput&quot;: &quot;Day better employee create single which.&quot;, &quot;cvss&quot;: 273, &quot;createdTimestamp&quot;: 906318467, &quot;lastUpdatedTimestamp&quot;: 456935280, &quot;deletedTimestamp&quot;: 310618325, &quot;firstSeenTimestamp&quot;: 1087407926, &quot;lastSeenTimestamp&quot;: 1409398477, &quot;resolutionTimestamp&quot;: 243910728, &quot;resolutionComment&quot;: &quot;Color blood message increase describe current.&quot;, &quot;resolution&quot;: &quot;FALSE_POSITIVE&quot;, &quot;flags&quot;: [&quot;MISSING_FROM_CVM&quot;], &quot;properties&quot;: {&quot;additionalProperties&quot;: &quot;Small cup recognize.&quot;}, &quot;severity&quot;: &quot;medium&quot;, &quot;socket&quot;: &quot;Budget simply hold relationship audience reveal.&quot;}], &quot;operatingSystemCPE&quot;: &quot;Far least different enjoy far trouble.&quot;}], &quot;metaData&quot;: {&quot;additionalProperties&quot;: {}}, &quot;messages&quot;: [{&quot;message&quot;: &quot;Position which feeling opportunity suffer contain throw.&quot;, &quot;messageTemplate&quot;: &quot;Because doctor specific police enjoy.&quot;, &quot;field&quot;: &quot;Hope choice news debate.&quot;, &quot;parameter&quot;: {}, &quot;timestamp&quot;: 1120411516}], &quot;currentPage&quot;: 565, &quot;size&quot;: 424} </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">get</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">()</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/1.0&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">if</span> <span class="n">offset</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="n">offset</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">limit</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">keywordMatch</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;keywordMatch&quot;</span><span class="p">:</span> <span class="n">keywordMatch</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">keywords</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;keywords&quot;</span><span class="p">:</span> <span class="n">keywords</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">keywordField</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;keywordField&quot;</span><span class="p">:</span> <span class="n">keywordField</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">hostID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;hostID&quot;</span><span class="p">:</span> <span class="n">hostID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">serviceID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;serviceID&quot;</span><span class="p">:</span> <span class="n">serviceID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">businessProcessID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;businessProcessID&quot;</span><span class="p">:</span> <span class="n">businessProcessID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">customerID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;customerID&quot;</span><span class="p">:</span> <span class="n">customerID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">ip</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="n">ip</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">port</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="n">port</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">protocol</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="n">protocol</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">cpe</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;cpe&quot;</span><span class="p">:</span> <span class="n">cpe</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">vulnID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;vulnID&quot;</span><span class="p">:</span> <span class="n">vulnID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">vulnRef</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;vulnRef&quot;</span><span class="p">:</span> <span class="n">vulnRef</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">includeFlag</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;includeFlag&quot;</span><span class="p">:</span> <span class="n">includeFlag</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">excludeFlag</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;excludeFlag&quot;</span><span class="p">:</span> <span class="n">excludeFlag</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">sortBy</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;sortBy&quot;</span><span class="p">:</span> <span class="n">sortBy</span><span class="p">})</span>


    <span class="n">response</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>

<div class="viewcode-block" id="add_host_asset"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.add_host_asset">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span><span class="s1">&#39;host&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">add_host_asset</span><span class="p">(</span><span class="n">ownerID</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">customerID</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">operatingSystemCPE</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ipAddresses</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">aliases</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;SERVER&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;USER&#39;</span><span class="p">,</span><span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates a new HostAsset. (PUBLIC)</span>

<span class="sd">    </span>

<span class="sd">    :param int ownerID: User who owns the asset. </span>
<span class="sd">    :param int customerID: Customer the asset belongs to. </span>
<span class="sd">    :param str name: Name of the asset.  =&gt; [\s\w\{\}\$\-\(\)\.\[\]&quot;\&#39;_/\\,\*\+\#:@!?;]*</span>
<span class="sd">    :param str description: Description of the asset.  =&gt; [\s\w\{\}\$\-\(\)\.\[\]&quot;\&#39;_/\\,\*\+\#:@!?;]*</span>
<span class="sd">    :param dict properties: Custom user-defined properties.  =&gt; [\s\w\{\}\$\-\(\)\.\[\]&quot;\&#39;_/\\,\*\+\#:@!?;]*</span>
<span class="sd">    :param str operatingSystemCPE: CPE of the host operating system. </span>
<span class="sd">    :param list ipAddresses: IP address(es) of the host. </span>
<span class="sd">    :param list aliases: Aliases (domain names) of the host. </span>
<span class="sd">    :param str type: Defines if host is a client or a server. (default SERVER)</span>
<span class="sd">    :param str source: Source of the request. (default USER)</span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :returns: {&quot;offset&quot;: 921, &quot;limit&quot;: 562, &quot;responseCode&quot;: 200, &quot;count&quot;: 827, &quot;metaData&quot;: {&quot;additionalProperties&quot;: {}}, &quot;messages&quot;: [{&quot;message&quot;: &quot;Of baby factor notice letter perhaps.&quot;, &quot;messageTemplate&quot;: &quot;Loss charge garden performance military table scene.&quot;, &quot;field&quot;: &quot;Computer really past with.&quot;, &quot;parameter&quot;: {}, &quot;timestamp&quot;: 930891971}], &quot;currentPage&quot;: 12, &quot;size&quot;: 313} </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">post</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">()</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/1.0&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">source</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">ownerID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;ownerID&quot;</span><span class="p">:</span> <span class="n">ownerID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">customerID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;customerID&quot;</span><span class="p">:</span> <span class="n">customerID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">properties</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="n">properties</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">operatingSystemCPE</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;operatingSystemCPE&quot;</span><span class="p">:</span> <span class="n">operatingSystemCPE</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">ipAddresses</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;ipAddresses&quot;</span><span class="p">:</span> <span class="n">ipAddresses</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">aliases</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;aliases&quot;</span><span class="p">:</span> <span class="n">aliases</span><span class="p">})</span>


    <span class="n">response</span> <span class="o">=</span> <span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>

<div class="viewcode-block" id="bulk_update_host_asset"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.bulk_update_host_asset">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span><span class="s1">&#39;host&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">bulk_update_host_asset</span><span class="p">(</span><span class="n">assetVulnerabilityAddRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">assetVulnerabilityUpdateRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">assetVulnerabilityResolveRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">assetVulnerabilityDeleteRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">hostApplicationAddRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">hostApplicationUpdateRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">hostApplicationDeleteRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">hostAssetAddRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">hostAssetUpdateRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">hostAssetDeleteRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;USER&#39;</span><span class="p">,</span><span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Performs multiple updates to HostAssets in a single transaction. (PUBLIC)</span>

<span class="sd">    </span>

<span class="sd">    :param list assetVulnerabilityAddRequests: List of AssetVulnerabilityAddRequests. </span>
<span class="sd">    :param list assetVulnerabilityUpdateRequests: List of AssetVulnerabilityUpdateRequests. </span>
<span class="sd">    :param list assetVulnerabilityResolveRequests: List of AssetVulnerabilityResolveRequests. </span>
<span class="sd">    :param list assetVulnerabilityDeleteRequests: List of AssetVulnerabilityDeleteRequests. </span>
<span class="sd">    :param list hostApplicationAddRequests: List of HostApplicationAddRequests. </span>
<span class="sd">    :param list hostApplicationUpdateRequests: List of HostApplicationUpdateRequests. </span>
<span class="sd">    :param list hostApplicationDeleteRequests: List of HostApplicationDeleteRequests. </span>
<span class="sd">    :param list hostAssetAddRequests: List of HostAssetAddRequests. Adding vulnerabilities/applications to added hosts must be done in separate transaction. </span>
<span class="sd">    :param list hostAssetUpdateRequests: List of HostAssetUpdateRequests. </span>
<span class="sd">    :param list hostAssetDeleteRequests: List of HostAssetDeleteRequests. </span>
<span class="sd">    :param str source: Source of the request. (default USER)</span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :raises ObjectNotFoundException: on 404</span>
<span class="sd">    :returns: {&quot;offset&quot;: 835, &quot;limit&quot;: 223, &quot;responseCode&quot;: 200, &quot;count&quot;: 54, &quot;metaData&quot;: {&quot;additionalProperties&quot;: {}}, &quot;messages&quot;: [{&quot;message&quot;: &quot;Music five itself find discussion claim else arrive.&quot;, &quot;messageTemplate&quot;: &quot;Per what action bill around.&quot;, &quot;field&quot;: &quot;Me walk environment describe relate civil image.&quot;, &quot;parameter&quot;: {}, &quot;timestamp&quot;: 671373210}], &quot;currentPage&quot;: 652, &quot;size&quot;: 469} </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">put</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">()</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/1.0&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">if</span> <span class="n">source</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">assetVulnerabilityAddRequests</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;assetVulnerabilityAddRequests&quot;</span><span class="p">:</span> <span class="n">assetVulnerabilityAddRequests</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">assetVulnerabilityUpdateRequests</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;assetVulnerabilityUpdateRequests&quot;</span><span class="p">:</span> <span class="n">assetVulnerabilityUpdateRequests</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">assetVulnerabilityResolveRequests</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;assetVulnerabilityResolveRequests&quot;</span><span class="p">:</span> <span class="n">assetVulnerabilityResolveRequests</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">assetVulnerabilityDeleteRequests</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;assetVulnerabilityDeleteRequests&quot;</span><span class="p">:</span> <span class="n">assetVulnerabilityDeleteRequests</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">hostApplicationAddRequests</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;hostApplicationAddRequests&quot;</span><span class="p">:</span> <span class="n">hostApplicationAddRequests</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">hostApplicationUpdateRequests</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;hostApplicationUpdateRequests&quot;</span><span class="p">:</span> <span class="n">hostApplicationUpdateRequests</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">hostApplicationDeleteRequests</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;hostApplicationDeleteRequests&quot;</span><span class="p">:</span> <span class="n">hostApplicationDeleteRequests</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">hostAssetAddRequests</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;hostAssetAddRequests&quot;</span><span class="p">:</span> <span class="n">hostAssetAddRequests</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">hostAssetUpdateRequests</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;hostAssetUpdateRequests&quot;</span><span class="p">:</span> <span class="n">hostAssetUpdateRequests</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">hostAssetDeleteRequests</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;hostAssetDeleteRequests&quot;</span><span class="p">:</span> <span class="n">hostAssetDeleteRequests</span><span class="p">})</span>


    <span class="n">response</span> <span class="o">=</span> <span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>

<div class="viewcode-block" id="search_host_assets"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.search_host_assets">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span><span class="s1">&#39;host&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">search_host_assets</span><span class="p">(</span><span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">subCriteria</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">customerID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">startTimestamp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">endTimestamp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">keywordMatchStrategy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeMatchStrategy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">hostID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">serviceID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">businessProcessID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ipRange</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">applicationPort</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">applicationProtocol</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cpe</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">hostCPE</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">applicationCPE</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ownerID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">criticality</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">minimumTotalCvss</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">maximumTotalCvss</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">vulnerabilityReference</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">vulnerabilityID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">applicationRole</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeFieldStrategy</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">keywordFieldStrategy</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sortBy</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">includeFlags</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">excludeFlags</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">includeDeleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="s1">&#39;False&#39;</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="s1">&#39;False&#39;</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="s1">&#39;False&#39;</span><span class="p">,</span> <span class="n">includeVulnerabilityRawOutput</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="s1">&#39;False&#39;</span><span class="p">,</span> <span class="n">includeVulnerabilityConclusion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="s1">&#39;False&#39;</span><span class="p">,</span> <span class="n">includeVulnerabilitySolution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="s1">&#39;False&#39;</span><span class="p">,</span> <span class="n">includeVulnerabilities</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="s1">&#39;False&#39;</span><span class="p">,</span> <span class="n">includeApplications</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="s1">&#39;False&#39;</span><span class="p">,</span> <span class="n">includeServices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="s1">&#39;False&#39;</span><span class="p">,</span> <span class="n">connectedToService</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="s1">&#39;False&#39;</span><span class="p">,</span><span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a set of HostAssets defined by a HostAssetSearchCriteria. (PUBLIC)</span>

<span class="sd">    </span>

<span class="sd">    :param int limit: Set this value to set max number of results. By default, no restriction on result set size. </span>
<span class="sd">    :param int offset: Set this value to skip the first (offset) objects. By default, return result from first object. </span>
<span class="sd">    :param list subCriteria: </span>
<span class="sd">    :param list customerID: Restrict search to data belonging to specified customers. </span>
<span class="sd">    :param list name: Restrict search to specific asset name </span>
<span class="sd">    :param int startTimestamp: Restrict search to a time frame based on the set TimeFieldStrategy (start timestamp). </span>
<span class="sd">    :param int endTimestamp: Restrict search to a time frame based on the set TimeFieldStrategy (end timestamp). </span>
<span class="sd">    :param list keywords: Search for keywords. </span>
<span class="sd">    :param str keywordMatchStrategy: Defines the MatchStrategy for keywords (default match all keywords). </span>
<span class="sd">    :param str timeMatchStrategy: Defines how strict to match against different timestamps (all/any) using start and end timestamp (default any) </span>
<span class="sd">    :param list hostID: Restrict search to specific host UUIDs. </span>
<span class="sd">    :param list serviceID: Restrict search to specific service UUIDs. </span>
<span class="sd">    :param list businessProcessID: Restrict search to specific business process UUIDs. </span>
<span class="sd">    :param list ipRange: Restrict search to entities related to these IP-addresses (may specify single IPs, IP networks or IP ranges. </span>
<span class="sd">    :param list applicationPort: Restrict to applications listening on specific ports. </span>
<span class="sd">    :param list applicationProtocol: Restrict to applications by transport protocol name. </span>
<span class="sd">    :param list cpe: Restrict to applications or hosts by CPE. </span>
<span class="sd">    :param list hostCPE: Restrict to hosts by CPE. </span>
<span class="sd">    :param list applicationCPE: Restrict to applications by CPE. </span>
<span class="sd">    :param list ownerID: Restrict search to specific ownerIDs </span>
<span class="sd">    :param list criticality: Restrict search to a range of criticality levels (add multiple CriticalitySearch objects to specify OR criteria). </span>
<span class="sd">    :param int minimumTotalCvss: Restrict search to a minimum total CVSS score. </span>
<span class="sd">    :param int maximumTotalCvss: Restrict search to a maximum total CVSS score. </span>
<span class="sd">    :param list vulnerabilityReference: Restrict to vulnerabilities identified by vulnerability reference. </span>
<span class="sd">    :param list vulnerabilityID: Restrict to vulnerabilities identified by vulnerability ID. </span>
<span class="sd">    :param list applicationRole: Restrict to applications with specific roles (list of role IDs). </span>
<span class="sd">    :param str type: Restrict search to a specific type of host (client or server). </span>
<span class="sd">    :param list timeFieldStrategy: Defines which timestamps will be included in the search (default lastUpdatedTimestamp on host). </span>
<span class="sd">    :param list keywordFieldStrategy: Defines which fields will be searched by keywords (default all supported fields). </span>
<span class="sd">    :param list sortBy: List of properties to sort by (prefix with &quot;-&quot; to sort descending). </span>
<span class="sd">    :param list includeFlags: Only include objects which have includeFlags set. </span>
<span class="sd">    :param list excludeFlags: Exclude objects which have excludeFlags set. </span>
<span class="sd">    :param bool includeDeleted: Set to true to include deleted objects. By default, exclude deleted objects. </span>
<span class="sd">    :param bool exclude: Only relevant for subcriteria. If set to true, objects matching this subcriteria object will be excluded. </span>
<span class="sd">    :param bool required: Only relevant for subcriteria. If set to true, objects matching this subcriteria are required (AND-ed together with parent criteria). </span>
<span class="sd">    :param bool includeVulnerabilityRawOutput: Include vulnerability rawOutput in result (default false). </span>
<span class="sd">    :param bool includeVulnerabilityConclusion: Include vulnerability conclusion in result (default false). </span>
<span class="sd">    :param bool includeVulnerabilitySolution: Include vulnerability solution in result (default false). </span>
<span class="sd">    :param bool includeVulnerabilities: Include host vulnerabilities in result (default false). </span>
<span class="sd">    :param bool includeApplications: Include host applications in result (default false). </span>
<span class="sd">    :param bool includeServices: Include related services in result (default false). </span>
<span class="sd">    :param bool connectedToService: If true, only return hosts connected to service(s). If false, return hosts not connected to any service. If not set, do not filter. </span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :returns: {&quot;offset&quot;: 468, &quot;limit&quot;: 746, &quot;responseCode&quot;: 200, &quot;count&quot;: 364, &quot;data&quot;: [{&quot;id&quot;: &quot;Arm candidate cup meeting that same cover.&quot;, &quot;ownedByUser&quot;: {&quot;id&quot;: 867, &quot;customerID&quot;: 657, &quot;userName&quot;: &quot;kwhite&quot;, &quot;name&quot;: &quot;Donald Smith&quot;}, &quot;name&quot;: &quot;Alexander Morgan&quot;, &quot;description&quot;: &quot;Exactly training treatment fund scientist born hospital.&quot;, &quot;totalCvss&quot;: 846, &quot;vulnerabilitiesCount&quot;: 216, &quot;createdTimestamp&quot;: 877203316, &quot;createdByUser&quot;: {&quot;id&quot;: 160, &quot;customerID&quot;: 415, &quot;userName&quot;: &quot;lisahopkins&quot;, &quot;name&quot;: &quot;Brian Armstrong&quot;}, &quot;lastUpdatedTimestamp&quot;: 826689143, &quot;lastUpdatedByUser&quot;: {&quot;id&quot;: 706, &quot;customerID&quot;: 289, &quot;userName&quot;: &quot;dalvarez&quot;, &quot;name&quot;: &quot;William Garcia DDS&quot;}, &quot;deletedTimestamp&quot;: 1397817734, &quot;deletedByUser&quot;: {&quot;id&quot;: 136, &quot;customerID&quot;: 381, &quot;userName&quot;: &quot;brian77&quot;, &quot;name&quot;: &quot;Mary Brown&quot;}, &quot;flags&quot;: [&quot;UPDATED_BY_CVM&quot;], &quot;properties&quot;: {&quot;additionalProperties&quot;: &quot;Any class later analysis.&quot;}, &quot;firstSeenTimestamp&quot;: 624667547, &quot;lastSeenTimestamp&quot;: 251487487, &quot;lastScanTimestamp&quot;: 1069334030, &quot;ipAddresses&quot;: [{&quot;host&quot;: false, &quot;maskBits&quot;: 245, &quot;ipv6&quot;: false, &quot;multicast&quot;: true, &quot;public&quot;: true, &quot;address&quot;: &quot;Room effort fish choose door talk.&quot;}], &quot;aliases&quot;: [{&quot;fqdn&quot;: &quot;Career church fall fly human.&quot;}], &quot;services&quot;: [{&quot;id&quot;: &quot;Around recognize enough yard similar ready.&quot;, &quot;name&quot;: &quot;Haley Watts&quot;}], &quot;applications&quot;: [{&quot;id&quot;: &quot;Mean important whose local space.&quot;, &quot;name&quot;: &quot;Tony Harper&quot;, &quot;description&quot;: &quot;Similar say east visit piece we.&quot;, &quot;createdTimestamp&quot;: 784063238, &quot;lastUpdatedTimestamp&quot;: 1493775590, &quot;deletedTimestamp&quot;: 1168521787, &quot;firstSeenTimestamp&quot;: 696407045, &quot;lastSeenTimestamp&quot;: 949118185, &quot;flags&quot;: [&quot;MISSING_FROM_CVM&quot;], &quot;properties&quot;: {&quot;additionalProperties&quot;: &quot;Toward detail plan focus remain also hour one.&quot;}, &quot;cpe&quot;: &quot;Sport poor woman trial in.&quot;, &quot;sockets&quot;: [&quot;Science best weight prevent personal upon evening rest.&quot;]}], &quot;vulnerabilities&quot;: [{&quot;id&quot;: &quot;Question under again seat into.&quot;, &quot;vulnerabilityID&quot;: &quot;American important whom stand let.&quot;, &quot;references&quot;: [&quot;Director want coach organization collection.&quot;], &quot;name&quot;: &quot;Jamie Clark&quot;, &quot;description&quot;: &quot;Prove test institution his high.&quot;, &quot;conclusion&quot;: &quot;Foot pay store include.&quot;, &quot;solution&quot;: &quot;Play least step beautiful green assume audience.&quot;, &quot;rawOutput&quot;: &quot;Read challenge might human.&quot;, &quot;cvss&quot;: 935, &quot;createdTimestamp&quot;: 228571607, &quot;lastUpdatedTimestamp&quot;: 1348122011, &quot;deletedTimestamp&quot;: 1107303135, &quot;firstSeenTimestamp&quot;: 763948522, &quot;lastSeenTimestamp&quot;: 325621442, &quot;resolutionTimestamp&quot;: 386705016, &quot;resolutionComment&quot;: &quot;White role away where.&quot;, &quot;resolution&quot;: &quot;ACCEPTED&quot;, &quot;flags&quot;: [&quot;EXPLOIT_AVAILABLE&quot;], &quot;properties&quot;: {&quot;additionalProperties&quot;: &quot;Plan lead full democratic describe serious consumer.&quot;}, &quot;severity&quot;: &quot;high&quot;, &quot;socket&quot;: &quot;Contain anyone sea girl view then.&quot;}], &quot;operatingSystemCPE&quot;: &quot;Simply enough hotel through bar brother.&quot;}], &quot;metaData&quot;: {&quot;additionalProperties&quot;: {}}, &quot;messages&quot;: [{&quot;message&quot;: &quot;Upon career recognize create man report.&quot;, &quot;messageTemplate&quot;: &quot;Tonight analysis year even.&quot;, &quot;field&quot;: &quot;Message pick authority pattern then.&quot;, &quot;parameter&quot;: {}, &quot;timestamp&quot;: 1437990416}], &quot;currentPage&quot;: 3, &quot;size&quot;: 285} </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">post</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host/search&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">()</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/1.0&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">if</span> <span class="n">limit</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">offset</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="n">offset</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">includeDeleted</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;includeDeleted&quot;</span><span class="p">:</span> <span class="n">includeDeleted</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">subCriteria</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;subCriteria&quot;</span><span class="p">:</span> <span class="n">subCriteria</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">exclude</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;exclude&quot;</span><span class="p">:</span> <span class="n">exclude</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">required</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="n">required</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">customerID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;customerID&quot;</span><span class="p">:</span> <span class="n">customerID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">startTimestamp</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;startTimestamp&quot;</span><span class="p">:</span> <span class="n">startTimestamp</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">endTimestamp</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;endTimestamp&quot;</span><span class="p">:</span> <span class="n">endTimestamp</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">keywords</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;keywords&quot;</span><span class="p">:</span> <span class="n">keywords</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">keywordMatchStrategy</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;keywordMatchStrategy&quot;</span><span class="p">:</span> <span class="n">keywordMatchStrategy</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">timeMatchStrategy</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;timeMatchStrategy&quot;</span><span class="p">:</span> <span class="n">timeMatchStrategy</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">hostID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;hostID&quot;</span><span class="p">:</span> <span class="n">hostID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">serviceID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;serviceID&quot;</span><span class="p">:</span> <span class="n">serviceID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">businessProcessID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;businessProcessID&quot;</span><span class="p">:</span> <span class="n">businessProcessID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">ipRange</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;ipRange&quot;</span><span class="p">:</span> <span class="n">ipRange</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">applicationPort</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;applicationPort&quot;</span><span class="p">:</span> <span class="n">applicationPort</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">applicationProtocol</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;applicationProtocol&quot;</span><span class="p">:</span> <span class="n">applicationProtocol</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">cpe</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;cpe&quot;</span><span class="p">:</span> <span class="n">cpe</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">hostCPE</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;hostCPE&quot;</span><span class="p">:</span> <span class="n">hostCPE</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">applicationCPE</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;applicationCPE&quot;</span><span class="p">:</span> <span class="n">applicationCPE</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">ownerID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;ownerID&quot;</span><span class="p">:</span> <span class="n">ownerID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">criticality</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;criticality&quot;</span><span class="p">:</span> <span class="n">criticality</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">minimumTotalCvss</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;minimumTotalCvss&quot;</span><span class="p">:</span> <span class="n">minimumTotalCvss</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">maximumTotalCvss</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;maximumTotalCvss&quot;</span><span class="p">:</span> <span class="n">maximumTotalCvss</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">vulnerabilityReference</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;vulnerabilityReference&quot;</span><span class="p">:</span> <span class="n">vulnerabilityReference</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">vulnerabilityID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;vulnerabilityID&quot;</span><span class="p">:</span> <span class="n">vulnerabilityID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">applicationRole</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;applicationRole&quot;</span><span class="p">:</span> <span class="n">applicationRole</span><span class="p">})</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">timeFieldStrategy</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;timeFieldStrategy&quot;</span><span class="p">:</span> <span class="n">timeFieldStrategy</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">keywordFieldStrategy</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;keywordFieldStrategy&quot;</span><span class="p">:</span> <span class="n">keywordFieldStrategy</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">includeVulnerabilityRawOutput</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;includeVulnerabilityRawOutput&quot;</span><span class="p">:</span> <span class="n">includeVulnerabilityRawOutput</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">includeVulnerabilityConclusion</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;includeVulnerabilityConclusion&quot;</span><span class="p">:</span> <span class="n">includeVulnerabilityConclusion</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">includeVulnerabilitySolution</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;includeVulnerabilitySolution&quot;</span><span class="p">:</span> <span class="n">includeVulnerabilitySolution</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">includeVulnerabilities</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;includeVulnerabilities&quot;</span><span class="p">:</span> <span class="n">includeVulnerabilities</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">includeApplications</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;includeApplications&quot;</span><span class="p">:</span> <span class="n">includeApplications</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">includeServices</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;includeServices&quot;</span><span class="p">:</span> <span class="n">includeServices</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">connectedToService</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;connectedToService&quot;</span><span class="p">:</span> <span class="n">connectedToService</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">sortBy</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;sortBy&quot;</span><span class="p">:</span> <span class="n">sortBy</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">includeFlags</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;includeFlags&quot;</span><span class="p">:</span> <span class="n">includeFlags</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">excludeFlags</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;excludeFlags&quot;</span><span class="p">:</span> <span class="n">excludeFlags</span><span class="p">})</span>


    <span class="n">response</span> <span class="o">=</span> <span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>

<div class="viewcode-block" id="get_host_asset"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.get_host_asset">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span><span class="s1">&#39;host&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">get_host_asset</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span><span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a HostAsset identified by its ID. (PUBLIC)</span>

<span class="sd">    </span>

<span class="sd">    :param str id: HostAsset ID</span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :raises ObjectNotFoundException: on 404</span>
<span class="sd">    :returns: {&quot;offset&quot;: 23, &quot;limit&quot;: 95, &quot;responseCode&quot;: 200, &quot;count&quot;: 548, &quot;metaData&quot;: {&quot;additionalProperties&quot;: {}}, &quot;messages&quot;: [{&quot;message&quot;: &quot;Write doctor trial include loss evidence.&quot;, &quot;messageTemplate&quot;: &quot;Lot next hit prevent.&quot;, &quot;field&quot;: &quot;Control contain past both beat.&quot;, &quot;parameter&quot;: {}, &quot;timestamp&quot;: 831486135}], &quot;currentPage&quot;: 241, &quot;size&quot;: 181} </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">get</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/1.0&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{}</span>
    

    <span class="n">response</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>

<div class="viewcode-block" id="update_host_asset"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.update_host_asset">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span><span class="s1">&#39;host&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">update_host_asset</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ownerID</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">addProperties</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">deleteProperties</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">operatingSystemCPE</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">addIpAddresses</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">deleteIpAddresses</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">addAliases</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">deleteAliases</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;USER&#39;</span><span class="p">,</span><span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Updates an existing HostAsset. (PUBLIC)</span>

<span class="sd">    </span>

<span class="sd">    :param str id: HostAsset ID</span>
<span class="sd">    :param int ownerID: Change user who owns the asset. </span>
<span class="sd">    :param str name: Change name of asset.  =&gt; [\s\w\{\}\$\-\(\)\.\[\]&quot;\&#39;_/\\,\*\+\#:@!?;]*</span>
<span class="sd">    :param str description: Change description of asset.  =&gt; [\s\w\{\}\$\-\(\)\.\[\]&quot;\&#39;_/\\,\*\+\#:@!?;]*</span>
<span class="sd">    :param dict addProperties: Add custom properties (updates a property if key already exists).  =&gt; [\s\w\{\}\$\-\(\)\.\[\]&quot;\&#39;_/\\,\*\+\#:@!?;]*</span>
<span class="sd">    :param list deleteProperties: Delete custom properties by key. </span>
<span class="sd">    :param str type: Change type of host (client or server). </span>
<span class="sd">    :param str operatingSystemCPE: Change CPE of host. </span>
<span class="sd">    :param list addIpAddresses: Add IP address(es) to host. </span>
<span class="sd">    :param list deleteIpAddresses: Delete IP address(es) from host. </span>
<span class="sd">    :param list addAliases: Add alias(es) (domain names) to host. </span>
<span class="sd">    :param list deleteAliases: Delete alias(es) from host. </span>
<span class="sd">    :param str source: Source of the request. (default USER)</span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :raises ObjectNotFoundException: on 404</span>
<span class="sd">    :returns: {&quot;offset&quot;: 606, &quot;limit&quot;: 791, &quot;responseCode&quot;: 200, &quot;count&quot;: 193, &quot;metaData&quot;: {&quot;additionalProperties&quot;: {}}, &quot;messages&quot;: [{&quot;message&quot;: &quot;Whether discussion detail without.&quot;, &quot;messageTemplate&quot;: &quot;Field off system certainly anyone political public.&quot;, &quot;field&quot;: &quot;Single drive charge performance soon section why.&quot;, &quot;parameter&quot;: {}, &quot;timestamp&quot;: 310775876}], &quot;currentPage&quot;: 761, &quot;size&quot;: 82} </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">put</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/1.0&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">if</span> <span class="n">source</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">ownerID</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;ownerID&quot;</span><span class="p">:</span> <span class="n">ownerID</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">addProperties</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;addProperties&quot;</span><span class="p">:</span> <span class="n">addProperties</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">deleteProperties</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;deleteProperties&quot;</span><span class="p">:</span> <span class="n">deleteProperties</span><span class="p">})</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">operatingSystemCPE</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;operatingSystemCPE&quot;</span><span class="p">:</span> <span class="n">operatingSystemCPE</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">addIpAddresses</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;addIpAddresses&quot;</span><span class="p">:</span> <span class="n">addIpAddresses</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">deleteIpAddresses</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;deleteIpAddresses&quot;</span><span class="p">:</span> <span class="n">deleteIpAddresses</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">addAliases</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;addAliases&quot;</span><span class="p">:</span> <span class="n">addAliases</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">deleteAliases</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;deleteAliases&quot;</span><span class="p">:</span> <span class="n">deleteAliases</span><span class="p">})</span>


    <span class="n">response</span> <span class="o">=</span> <span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>

<div class="viewcode-block" id="delete_host_asset"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.delete_host_asset">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span><span class="s1">&#39;host&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">delete_host_asset</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;USER&#39;</span><span class="p">,</span><span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Marks a HostAsset as deleted. (PUBLIC)</span>

<span class="sd">    </span>

<span class="sd">    :param str id: HostAsset ID</span>
<span class="sd">    :param str source: Request source (default USER)</span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :raises ObjectNotFoundException: on 404</span>
<span class="sd">    :returns: {&quot;offset&quot;: 584, &quot;limit&quot;: 930, &quot;responseCode&quot;: 200, &quot;count&quot;: 529, &quot;metaData&quot;: {&quot;additionalProperties&quot;: {}}, &quot;messages&quot;: [{&quot;message&quot;: &quot;Special building later cold discover various ahead.&quot;, &quot;messageTemplate&quot;: &quot;Many travel source finally must yet affect century.&quot;, &quot;field&quot;: &quot;Woman spring newspaper direction.&quot;, &quot;parameter&quot;: {}, &quot;timestamp&quot;: 322446910}], &quot;currentPage&quot;: 516, &quot;size&quot;: 417} </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">delete</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/1.0&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">if</span> <span class="n">source</span><span class="p">:</span>
        <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">})</span>


    <span class="n">response</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, mnemonic.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>